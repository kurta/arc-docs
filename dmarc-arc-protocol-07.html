<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Authenticated Received Chain (ARC) Protocol</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.2" rel="Chapter" title="2 Overview"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Terminology"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Instance (&#x2018;i=&#x2019;) Tags"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Valid Range for Instance Tags"/>
<link href="#rfc.section.5" rel="Chapter" title="5 The ARC Header Fields"/>
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 ARC-Authentication-Results (AAR)"/>
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 ARC-Message-Signature (AMS)"/>
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 ARC-Seal (AS)"/>
<link href="#rfc.section.5.3.1" rel="Chapter" title="5.3.1 The &#x2018;cv&#x2019; Tag"/>
<link href="#rfc.section.5.3.2" rel="Chapter" title="5.3.2 Selected Header Fields"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Verifier Actions"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Signer Actions"/>
<link href="#rfc.section.8" rel="Chapter" title="8 Key Management"/>
<link href="#rfc.section.9" rel="Chapter" title="9 Usage of Chain Validity"/>
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Assessing Chain Validity Violations"/>
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 Marking and Sealing Invalid Chains"/>
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 Handling DNS Problems While Validating ARC"/>
<link href="#rfc.section.9.4" rel="Chapter" title="9.4 Responding to ARC Validity Violations"/>
<link href="#rfc.section.9.5" rel="Chapter" title="9.5 Recording the Results of ARC Evaluation"/>
<link href="#rfc.section.9.5.1" rel="Chapter" title="9.5.1 Output Information from an ARC Evaluation"/>
<link href="#rfc.section.9.5.2" rel="Chapter" title="9.5.2 Reporting ARC Effects for DMARC Local Policy - Interim"/>
<link href="#rfc.section.10" rel="Chapter" title="10 Supporting Alternate Signing Algorithms"/>
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Introductory Period"/>
<link href="#rfc.section.10.2" rel="Chapter" title="10.2 Co-Existence Period"/>
<link href="#rfc.section.10.3" rel="Chapter" title="10.3 Deprecation Period"/>
<link href="#rfc.section.11" rel="Chapter" title="11 Privacy Considerations"/>
<link href="#rfc.section.12" rel="Chapter" title="12 IANA Considerations"/>
<link href="#rfc.section.12.1" rel="Chapter" title="12.1 Authentication-Results Method Registry Update"/>
<link href="#rfc.section.12.2" rel="Chapter" title="12.2 Definitions of the ARC header fields"/>
<link href="#rfc.section.13" rel="Chapter" title="13 Implementation Status"/>
<link href="#rfc.section.13.1" rel="Chapter" title="13.1 GMail test reflector and incoming validation"/>
<link href="#rfc.section.13.2" rel="Chapter" title="13.2 AOL test reflector and internal tagging"/>
<link href="#rfc.section.13.3" rel="Chapter" title="13.3 dkimpy"/>
<link href="#rfc.section.13.4" rel="Chapter" title="13.4 OpenARC"/>
<link href="#rfc.section.13.5" rel="Chapter" title="13.5 Mailman addition"/>
<link href="#rfc.section.13.6" rel="Chapter" title="13.6 Copernica/MailerQ web-based validation"/>
<link href="#rfc.section.13.7" rel="Chapter" title="13.7 Rspamd"/>
<link href="#rfc.section.13.8" rel="Chapter" title="13.8 PERL Mail::Milter::Authentication module"/>
<link href="#rfc.section.14" rel="Chapter" title="14 Security Considerations"/>
<link href="#rfc.section.14.1" rel="Chapter" title="14.1 Message Content Suspicion"/>
<link href="#rfc.references" rel="Chapter" title="15 References"/>
<link href="#rfc.references.1" rel="Chapter" title="15.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="15.2 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Appendix A - Example Usage (Obsolete but retained for illustrative purposes)"/>
<link href="#rfc.appendix.A.1" rel="Chapter" title="A.1 Example 1: Simple mailing list"/>
<link href="#rfc.appendix.A.1.1" rel="Chapter" title="A.1.1 Here&#x2019;s the message as it exits the Origin:"/>
<link href="#rfc.appendix.A.1.2" rel="Chapter" title="A.1.2 Message is then received at example.org"/>
<link href="#rfc.appendix.A.1.3" rel="Chapter" title="A.1.3 Example 1: Message received by Recipient"/>
<link href="#rfc.appendix.A.2" rel="Chapter" title="A.2 Example 2: Mailing list to forwarded mailbox"/>
<link href="#rfc.appendix.A.2.1" rel="Chapter" title="A.2.1 Here&#x2019;s the message as it exits the Origin:"/>
<link href="#rfc.appendix.A.2.2" rel="Chapter" title="A.2.2 Message is then received at example.org"/>
<link href="#rfc.appendix.A.2.3" rel="Chapter" title="A.2.3 Example 2: Message received by Recipient"/>
<link href="#rfc.appendix.A.3" rel="Chapter" title="A.3 Example 3: Mailing list to forwarded mailbox with source"/>
<link href="#rfc.appendix.A.3.1" rel="Chapter" title="A.3.1 Here&#x2019;s the message as it exits the Origin:"/>
<link href="#rfc.appendix.A.3.2" rel="Chapter" title="A.3.2 Message is then received at example.org"/>
<link href="#rfc.appendix.A.3.3" rel="Chapter" title="A.3.3 Example 3: Message received by Recipient"/>
<link href="#rfc.appendix.B" rel="Chapter" title="B Acknowledgements"/>
<link href="#rfc.appendix.C" rel="Chapter" title="C Comments and Feedback"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.0 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Andersen, K., Long, B., Ed., Jones, S., Ed., and M. Kucherawy, Ed." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-dmarc-arc-protocol-07" />
  <meta name="dct.issued" scheme="ISO8601" content="2017-7-21" />
  <meta name="dct.abstract" content="The Authenticated Received Chain (ARC) protocol creates a mechanism whereby a series of handlers of a message can conduct authentication of a message as it passes among them on the way to its destination, and record the status of that authentication at each step along the handling path, for use by the final recipient in making choices about the disposition of the message." />
  <meta name="description" content="The Authenticated Received Chain (ARC) protocol creates a mechanism whereby a series of handlers of a message can conduct authentication of a message as it passes among them on the way to its destination, and record the status of that authentication at each step along the handling path, for use by the final recipient in making choices about the disposition of the message." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">DMARC Working Group</td>
  <td class="right">K. Andersen</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">LinkedIn</td>
</tr>
<tr>
  <td class="left">Intended status: Standards Track</td>
  <td class="right">B. Long, Ed.</td>
</tr>
<tr>
  <td class="left">Expires: January 22, 2018</td>
  <td class="right">Google</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">S. Jones, Ed.</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">M. Kucherawy, Ed.</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">TDP</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">July 21, 2017</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Authenticated Received Chain (ARC) Protocol<br />
  <span class="filename">draft-ietf-dmarc-arc-protocol-07</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>The Authenticated Received Chain (ARC) protocol creates a mechanism whereby a series of handlers of a message can conduct authentication of a message as it passes among them on the way to its destination, and record the status of that authentication at each step along the handling path, for use by the final recipient in making choices about the disposition of the message.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 22, 2018.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2017 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>2.   <a href="#rfc.section.2">Overview</a></li>
<li>3.   <a href="#rfc.section.3">Terminology</a></li>
<li>4.   <a href="#rfc.section.4">Instance (&#8216;i=&#8217;) Tags</a></li>
<ul><li>4.1.   <a href="#rfc.section.4.1">Valid Range for Instance Tags</a></li>
</ul><li>5.   <a href="#rfc.section.5">The ARC Header Fields</a></li>
<ul><li>5.1.   <a href="#rfc.section.5.1">ARC-Authentication-Results (AAR)</a></li>
<li>5.2.   <a href="#rfc.section.5.2">ARC-Message-Signature (AMS)</a></li>
<li>5.3.   <a href="#rfc.section.5.3">ARC-Seal (AS)</a></li>
<ul><li>5.3.1.   <a href="#rfc.section.5.3.1">The &#8216;cv&#8217; Tag</a></li>
<li>5.3.2.   <a href="#rfc.section.5.3.2">Selected Header Fields</a></li>
</ul></ul><li>6.   <a href="#rfc.section.6">Verifier Actions</a></li>
<li>7.   <a href="#rfc.section.7">Signer Actions</a></li>
<li>8.   <a href="#rfc.section.8">Key Management</a></li>
<li>9.   <a href="#rfc.section.9">Usage of Chain Validity</a></li>
<ul><li>9.1.   <a href="#rfc.section.9.1">Assessing Chain Validity Violations</a></li>
<li>9.2.   <a href="#rfc.section.9.2">Marking and Sealing Invalid Chains</a></li>
<li>9.3.   <a href="#rfc.section.9.3">Handling DNS Problems While Validating ARC</a></li>
<li>9.4.   <a href="#rfc.section.9.4">Responding to ARC Validity Violations</a></li>
<li>9.5.   <a href="#rfc.section.9.5">Recording the Results of ARC Evaluation</a></li>
<ul><li>9.5.1.   <a href="#rfc.section.9.5.1">Output Information from an ARC Evaluation</a></li>
<li>9.5.2.   <a href="#rfc.section.9.5.2">Reporting ARC Effects for DMARC Local Policy - Interim</a></li>
</ul></ul><li>10.   <a href="#rfc.section.10">Supporting Alternate Signing Algorithms</a></li>
<ul><li>10.1.   <a href="#rfc.section.10.1">Introductory Period</a></li>
<li>10.2.   <a href="#rfc.section.10.2">Co-Existence Period</a></li>
<li>10.3.   <a href="#rfc.section.10.3">Deprecation Period</a></li>
</ul><li>11.   <a href="#rfc.section.11">Privacy Considerations</a></li>
<li>12.   <a href="#rfc.section.12">IANA Considerations</a></li>
<ul><li>12.1.   <a href="#rfc.section.12.1">Authentication-Results Method Registry Update</a></li>
<li>12.2.   <a href="#rfc.section.12.2">Definitions of the ARC header fields</a></li>
</ul><li>13.   <a href="#rfc.section.13">Implementation Status</a></li>
<ul><li>13.1.   <a href="#rfc.section.13.1">GMail test reflector and incoming validation</a></li>
<li>13.2.   <a href="#rfc.section.13.2">AOL test reflector and internal tagging</a></li>
<li>13.3.   <a href="#rfc.section.13.3">dkimpy</a></li>
<li>13.4.   <a href="#rfc.section.13.4">OpenARC</a></li>
<li>13.5.   <a href="#rfc.section.13.5">Mailman addition</a></li>
<li>13.6.   <a href="#rfc.section.13.6">Copernica/MailerQ web-based validation</a></li>
<li>13.7.   <a href="#rfc.section.13.7">Rspamd</a></li>
<li>13.8.   <a href="#rfc.section.13.8">PERL Mail::Milter::Authentication module</a></li>
</ul><li>14.   <a href="#rfc.section.14">Security Considerations</a></li>
<ul><li>14.1.   <a href="#rfc.section.14.1">Message Content Suspicion</a></li>
</ul><li>15.   <a href="#rfc.references">References</a></li>
<ul><li>15.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>15.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Appendix A - Example Usage (Obsolete but retained for illustrative purposes)</a></li>
<ul><li>A.1.   <a href="#rfc.appendix.A.1">Example 1: Simple mailing list</a></li>
<ul><li>A.1.1.   <a href="#rfc.appendix.A.1.1">Here&#8217;s the message as it exits the Origin:</a></li>
<li>A.1.2.   <a href="#rfc.appendix.A.1.2">Message is then received at example.org</a></li>
<li>A.1.3.   <a href="#rfc.appendix.A.1.3">Example 1: Message received by Recipient</a></li>
</ul><li>A.2.   <a href="#rfc.appendix.A.2">Example 2: Mailing list to forwarded mailbox</a></li>
<ul><li>A.2.1.   <a href="#rfc.appendix.A.2.1">Here&#8217;s the message as it exits the Origin:</a></li>
<li>A.2.2.   <a href="#rfc.appendix.A.2.2">Message is then received at example.org</a></li>
<li>A.2.3.   <a href="#rfc.appendix.A.2.3">Example 2: Message received by Recipient</a></li>
</ul><li>A.3.   <a href="#rfc.appendix.A.3">Example 3: Mailing list to forwarded mailbox with source</a></li>
<ul><li>A.3.1.   <a href="#rfc.appendix.A.3.1">Here&#8217;s the message as it exits the Origin:</a></li>
<li>A.3.2.   <a href="#rfc.appendix.A.3.2">Message is then received at example.org</a></li>
<li>A.3.3.   <a href="#rfc.appendix.A.3.3">Example 3: Message received by Recipient</a></li>
</ul></ul><li>Appendix B.   <a href="#rfc.appendix.B">Acknowledgements</a></li>
<li>Appendix C.   <a href="#rfc.appendix.C">Comments and Feedback</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a></h1>
<p id="rfc.section.1.p.1">Modern email authentication techniques such as the Sender Policy Framework (SPF) <a href="#RFC7208">[RFC7208]</a> and DomainKeys Identified Mail (DKIM) <a href="#RFC6376">[RFC6376]</a> have become ubiquitious.  However, they are stymied by a small number of common applications, most notably mailing list managers, as these applications have handling properties that prevent these authentication schemes from universal effectiveness.  These issues are described in substantial detail in those protocols&#8217; defining documents as well as in <a href="#RFC6377">[RFC6377]</a>.</p>
<p id="rfc.section.1.p.2">In an effort to reduce the success of fraudulent email campaigns, there has been an effort to develop and deploy technologies that use SPF and DKIM to assure legitimate use of the identity of the apparent message author, i.e., the visible &#8220;From:&#8221; field in a message.  To this end, Domain-based Mail Authentication, Reporting and Compliance (DMARC) <a href="#RFC7489">[RFC7489]</a> has been developed and deployed.  However, its deployment in environments where mailing lists are used has had the negative impacts predicted in the documents listed above.</p>
<p id="rfc.section.1.p.3">What is needed is a mechanism by which legitimate alteration of a message, invalidating SPF and DKIM, does not ultimately result in a rejection of an email message on delivery.  An Authenticated Received Chain (ARC), described here, provides a superset of the functionality of DKIM in order to provide to the final message recipient a more complete view into the handling chain of a message and the points in that chain where alterations of the content may have occurred.  Equipped with this more compelte information, the final recipient can make a more informed handling choice, reducing or eliminating the false postives inherent in use of DKIM and/or SPF themselves.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#overview" id="overview">Overview</a></h1>
<p id="rfc.section.2.p.1">In DKIM, every participating signing agent attaches a signature that is based on the content of the message, local policy, and the domain name of the participating Administrative Management Domain (ADMD).  Any verifier can process such a signature; a verified signature means the message content that was &#8220;covered&#8221; by the signature has not been altered since the signature was applied.  The signatures themselves are generally independent of one another.</p>
<p id="rfc.section.2.p.2">By contrast, this protocol seeks to have each signature be able to convey the following pieces of information:</p>
<p/>

<ol>
  <li>As with DKIM, an assertion that, for a passing signature, the domain name in the signature takes some responsibility for handling of the message and that the message is unchanged since that signature was applied;</li>
  <li>A further assertion that, at the time that same ADMD processed the message, the various assertions already attached to the message by other ADMDs were or were not valid;</li>
  <li>A further assertion that combines and protects the above against alteration by later handlers.</li>
</ol>
<p id="rfc.section.2.p.4">This protocol accomplishes each of these by adding a new header field to the message for each of them, as follows:</p>
<p/>

<ul>
  <li>ARC-Authentication-Results:  (referred to below as &#8220;AAR&#8221;) virtually identical in syntax to an Authentication-Results field <a href="#RFC7601">[RFC7601]</a>, this field records the results of all message authentication checks done by the recording ADMD at the time the message arrived;</li>
  <li>ARC-Message-Signature:  (referred to below as &#8220;AMS&#8221;) virtually identical in syntax to DKIM-Signature, this field contains the assertions about the message header and body as they existed at the time of handling by the ADMD adding it; and</li>
  <li>ARC-Seal:  (referred to below as &#8220;AS&#8221;) highly similar in structure and format to a DKIM-Signature, this field applies a digital signature that protects the integrity of all three of these new fields when they are added by an ADMD, plus all instances of these fields added by prior ADMDs.</li>
</ul>
<p id="rfc.section.2.p.6">A distinguishing feature of all of these is that an ARC participant always adds all of them before relaying a message to the next handling agent en route to its destination.  Moreover, as described in <a href="#i-defn">Section 4</a>, they each have an &#8220;instance&#8221; number that increases with each ADMD in the handling chain so that their original order can be preserved and the three of them can be processed as a group.</p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#terminology" id="terminology">Terminology</a></h1>
<p id="rfc.section.3.p.1">This section defines terms used in the rest of the document.</p>
<p id="rfc.section.3.p.2">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.3.p.3">Readers are encouraged to be familiar with the contents of <a href="#RFC5598">[RFC5598]</a>, and in particular, the potential roles of intermediaries in the delivery of email.</p>
<p id="rfc.section.3.p.4">Syntax descriptions use Augmented BNF (ABNF) <a href="#RFC5234">[RFC5234]</a>.</p>
<p id="rfc.section.3.p.5">A single group of the header fields introduced in <a href="#overview">Section 2</a> is called an &#8220;ARC Set&#8221;, and the complete sequence of these groups is called an &#8220;Authenticated Received Chain&#8221; or merely an &#8220;ARC chain&#8221;.  Although the &#8220;Received&#8221; header field is typically not included in the signed content, the name is based on the notion that this is in essence a cryptographically signed series of header fields that attest to the handling chain of a message much as Received fields always have.</p>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#i-defn" id="i-defn">Instance (&#8216;i=&#8217;) Tags</a></h1>
<p id="rfc.section.4.p.1">The header fields comprising a single ARC set are identified by the presence of a string in the value portion of the header field that complies with the &#8220;tag-spec&#8221; ABNF found in Section 3.2 of <a href="#RFC6376">[RFC6376]</a>.  The tag-name is always the single character &#8220;i&#8221; and the value is the text representation of a positive integer, indicating the position in the ARC sequence this set occupies, where the first ARC set is numbered 1.  In ABNF terms:</p>
<pre>
   instance = [FWS] %x69 [FWS] "=" [FWS] 1*DIGIT [FWS] ";"
</pre>
<p id="rfc.section.4.p.2">At any delivery stage, it is an error if any ARC set is invalid (i.e., does not contain exactly one of the three header fields defined by this protocol).</p>
<p id="rfc.section.4.p.3">Note that because the AMS and AS header field values are made up of tag-spec constructs, the i= tag may be found anywhere within the header field value, but is represented throughout this spec in the initial position for convenience. Implementers SHOULD seek to start with the i= tag to facilitate human inspection of the headers.</p>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#i-hdr" id="i-hdr">Valid Range for Instance Tags</a></h1>
<p id="rfc.section.4.1.p.1">The &#8216;i&#8217; tag value can range from 1-1024 (inclusive).</p>
<p id="rfc.section.4.1.p.2">ARC implementations MUST support at least ten (10) intermediary steps.</p>
<p id="rfc.section.4.1.p.3">More than fifty (50) intermediaries is considered extremely unlikely so ARC chains with more than fifty intermediaries may be marked with &#8220;cv=fail&#8221;.</p>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#the-arc-header-fields" id="the-arc-header-fields">The ARC Header Fields</a></h1>
<p id="rfc.section.5.p.1">The three header fields that are part of this specification borrow heavily from existing specifications.  Rather than repeating all of the formal definitions that are being recycled in ARC, this document instead only describes and specifies changes in syntax and semantics.</p>
<h1 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a> <a href="#aar-defn" id="aar-defn">ARC-Authentication-Results (AAR)</a></h1>
<p id="rfc.section.5.1.p.1">The ARC-Authentication-Results header field is defined.  It is syntactically and semantically identical to an Authentication-Results header field <a href="#RFC7601">[RFC7601]</a> (A-R), as is the mechanism by which it is constructed, with the following exception:</p>
<p/>

<ul>
  <li>There is an &#8220;i&#8221; tag, as described in <a href="#i-defn">Section 4</a>.</li>
</ul>
<p id="rfc.section.5.1.p.3">The instance identifier MUST be separated from the rest of the Authentication-Results value contents with a semi-colon (&#8216;;&#8217;, 0x3b).</p>
<p id="rfc.section.5.1.p.4">An ARC signer generates this field in the same way that a conventional A-R field would be generated. Because the AAR is designed for machine-based consumption over the course of a message&#8217;s transit through a series of mediators and to facilitate troubleshooting of problematic sources by sending organizations, two additional fields of data SHOULD be added to the normal A-R content, if available to the A-R generating system:</p>
<p/>

<ul>
  <li>source.ip - The connecting client IP address from which the message is received; and</li>
  <li>header.s - The selector value associated with each dkim signature (added to the dkim or arc data sections of the A-R/AAR record</li>
</ul>
<p id="rfc.section.5.1.p.6">The purpose of this header field is to incorporate into the record the success or failure of any authentication done on the message upstream of the participating ADMD, to validate and continue the authentication chain.</p>
<p id="rfc.section.5.1.p.7">In processing, some architectures will generate multiple A-R records for the same authserv-id. In such cases, the resinfo value from each of the A-R records should be concatenated into a single record just as they would have been if they were generated in a single A-R record.</p>
<h1 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a> <a href="#ams-defn" id="ams-defn">ARC-Message-Signature (AMS)</a></h1>
<p id="rfc.section.5.2.p.1">The ARC-Message-Signature header field is defined.  It is syntactically and semantically identical to a DKIM-Signature header field <a href="#RFC6376">[RFC6376]</a>, as is the mechanism by which it is constructed, with the following exceptions:</p>
<p/>

<ul>
  <li>There is an &#8220;i&#8221; tag, as described in <a href="#i-defn">Section 4</a>.</li>
  <li>There is no &#8220;v&#8221; tag.</li>
  <li>ARC-Seal header fields MUST never be included in the content covered by the signature in this header field.</li>
</ul>
<p id="rfc.section.5.2.p.3">The AMS SHOULD include any DKIM-Signature header fields already present on the message in the header fields covered by this signature.</p>
<p id="rfc.section.5.2.p.4">Authentication-Results header fields SHOULD NOT be included since they are likely to be deleted by downstream ADMDs, thereby breaking the AMS signature.</p>
<p id="rfc.section.5.2.p.5">As with a DKIM-Signature, the purpose of this header field is to allow the ADMD generating it to take some responsibility for handling this message as it progresses toward delivery.</p>
<h1 id="rfc.section.5.3"><a href="#rfc.section.5.3">5.3.</a> <a href="#as-defn" id="as-defn">ARC-Seal (AS)</a></h1>
<p id="rfc.section.5.3.p.1">The ARC-Seal header field is defined.  It is syntactically and semantically similar to a DKIM-Signature field, with the following exceptions:</p>
<p/>

<ul>
  <li>There is an &#8220;i&#8221; tag, as described in <a href="#i-defn">Section 4</a>.</li>
  <li>The ARC-Seal covers none of the body content of the message.  It only covers specific header fields.  (See below: <a href="#implicit-as-h">Section 5.3.2</a>.)  As a result, no body canonicalization is done.  Further, only &#8220;relaxed&#8221; header canonicalization (Section 3.4.2 of <a href="#RFC6376">[RFC6376]</a>) is used.</li>
  <li>The only supported tags are &#8220;i&#8221; (<a href="#i-defn">Section 4</a> supercedes the <a href="#RFC6376">[RFC6376]</a> definition), and &#8220;a&#8221;, &#8220;b&#8221;, &#8220;d, &#8220;s&#8221;, &#8220;t&#8221;. The latter 5 tag definitions are copied from Section 3.5 of <a href="#RFC6376">[RFC6376]</a>.</li>
  <li>An additional tag, &#8220;cv&#8221; is defined.  (See below: <a href="#cv-defn">Section 5.3.1</a>)</li>
</ul>
<p id="rfc.section.5.3.p.3">The purpose of this field is to assure the integrity of the ARC set being added by the ADMD generating this header field, and moreover to ensure no tampering with the ARC overall.</p>
<h1 id="rfc.section.5.3.1"><a href="#rfc.section.5.3.1">5.3.1.</a> <a href="#cv-defn" id="cv-defn">The &#8216;cv&#8217; Tag</a></h1>
<p id="rfc.section.5.3.1.p.1">A new tag &#8220;cv&#8221; (chain validation) is defined, which indicates the state of the ARC chain as evaluated when it arrived at the ADMD adding this header field.  It includes one of three possible values:</p>
<p/>

<ul>
  <li>none:  There was no chain on the message when it arrived for validation; typically occurs when the message arrives at a Message Transfer Agent (MTA) from a Message Submission Agent (MSA) or when any upstream MTAs may not be participating in ARC handling;</li>
  <li>fail:  The message has a chain whose validation failed;</li>
  <li>pass:  The message has a chain whose validation succeeded.</li>
</ul>
<p id="rfc.section.5.3.1.p.3">In ABNF terms:</p>
<pre>
 seal-cv-tag = %x63.76 [FWS] "=" [FWS]
               ("none" / "fail" / "pass")
</pre>
<h1 id="rfc.section.5.3.2"><a href="#rfc.section.5.3.2">5.3.2.</a> <a href="#implicit-as-h" id="implicit-as-h">Selected Header Fields</a></h1>
<p id="rfc.section.5.3.2.p.1">The ARC-Seal signature is an encryption of the hash of the concatenation of the canonicalized form of the ARC sets present on the message at the time of sealing, in increasing instance order, starting at 1, including the one being added at the time of sealing the message.</p>
<p id="rfc.section.5.3.2.p.2">Within a set, the header fields are presented in the following order:</p>
<p/>

<ol>
  <li>ARC-Authentication-Results</li>
  <li>ARC-Message-Signature</li>
  <li>ARC-Seal</li>
</ol>
<p id="rfc.section.5.3.2.p.4">Where the ARC-Seal is the one being generated, it is presented to the hash function in its final form except with an empty &#8220;b=&#8221; value, in the same manner by which a DKIM-Signature signs itself.</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#cv-calc" id="cv-calc">Verifier Actions</a></h1>
<p id="rfc.section.6.p.1">The verifier takes the following steps to determine the current state of the ARC on the message:</p>
<p/>

<ol>
  <li>Collect all ARC sets currently on the message.  If there were none, the ARC state is &#8220;none&#8221; and the algorithm stops here.</li>
  <li>If any ARC set is invalid (e.g., does not contain exactly one of each of the three ARC-specific header fields), then the chain state is &#8220;fail&#8221; and the algorithm stops here.</li>
  <li>Conduct verification of the ARC-Message-Signature header field bearing the highest instance number.  If this verification fails, then the chain state is &#8220;fail&#8221; and the algorithm stops here.</li>
  <li>For each ARC-Seal from the &#8220;N&#8221;th instance to the first, apply the following logic: <ol><li>If the value of the &#8220;cv&#8221; tag on that seal is &#8220;fail&#8221;, the chain state is &#8220;fail&#8221; and the algorithm stops here.</li><li>If the instance number being processed is greater than 1 and the value of the &#8220;cv&#8221; tag is &#8220;none&#8221;, the chain state is &#8220;fail&#8221; and the algorithm stops here.</li><li>If the instance number being processed is 1 and the value of the &#8220;cv&#8221; tag is not &#8220;none&#8221;, the chain state is &#8220;fail&#8221; and the algorithm stops here.</li><li>Prepare a hash function corresponding to the &#8220;a&#8221; tag of the ARC-Seal.</li><li>Compute the canonicalized form of the ARC header fields, in the order described in <a href="#implicit-as-h">Section 5.3.2</a>, using the &#8220;relaxed&#8221; header canonicalization defined in (Section 3.4.2 of <a href="#RFC6376">[RFC6376]</a>.  Pass them to the hash function.</li><li>Retrieve the final digest from the hash function.</li><li>Retrieve the public key identified by the &#8220;s&#8221; and &#8220;d&#8221; tags in the ARC-Seal, as described in <a href="#key-mgmt">Section 8</a>.</li><li>Determine whether the signature portion (&#8220;b&#8221; tag) of the ARC-Seal and the digest computed above are valid according to the public key.</li><li>If the signature is not valid, the chain state is &#8220;fail&#8221; and the algorithm stops here.</li></ol></li>
  <li>If all seals pass validation, then the chain state is &#8220;pass&#8221;, and the algorithm is complete.</li>
</ol>
<p id="rfc.section.6.p.3">The verifier should record the cv state for subsequent use by any sealing which may be done later (potentially after message modification) within the same trust boundary. The cv state may be recorded by sealing at the time of verification in an additional ARC set or may be recorded out of band depending on the architecture of the ADMD.</p>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#signer-actions" id="signer-actions">Signer Actions</a></h1>
<p id="rfc.section.7.p.1">This section includes a walk-through of the actions an ARC signing implementation takes when presented with a message.</p>
<p id="rfc.section.7.p.2">The signing agent should undertake the following steps:</p>
<p/>

<ol>
  <li>Do any authentication steps that the ADMD normally does: <ol><li>If a message is traveling within the same trust boundary, this would include any transitive trust conveyance with the message;</li><li>If a message is coming from outside the same trust boundary, this would include any SPF / DKIM / DMARC / other authentication evaluation steps.</li></ol></li>
  <li>Do any DKIM signing or authentication assertion steps that the ADMD normally does.</li>
  <li>Generate and optionally attach to the message an Authentication-Results header field using the ADMD&#8217;s authserv-id (see Section 2.5 of <a href="#RFC7601">[RFC7601]</a>) indicating whatever authentication might have been done by the MTA, or possibly indicate that none was done.  <ol><li>If an ARC chain exists on the message, then set &#8220;N&#8221; equal to the highest instance number found on the chain (i=); otherwise set &#8220;N&#8221; equal to zero for the following steps.</li></ol></li>
  <li>Generate and attach to the message an ARC-Authentication-Results header field using instance number N+1 and the same content from the previous step.</li>
  <li>Generate and attach to the message an ARC-Message-Signature header field using the general algorithm described in Section 5 of <a href="#RFC6376">[RFC6376]</a> and as modified in <a href="#aar-defn">Section 5.1</a> above, using instance number N+1.</li>
  <li>Generate and attach to the message an ARC-Seal header field using the general algorithm described in <a href="#as-defn">Section 5.3</a> above, using a chain validation status as determined in <a href="#cv-calc">Section 6</a> and instance number N+1.</li>
</ol>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#key-mgmt" id="key-mgmt">Key Management</a></h1>
<p id="rfc.section.8.p.1">The public keys for ARC header fields follow the same requirements, syntax and semantics as those for DKIM signatures, described in Section 3.6 of <a href="#RFC6376">[RFC6376]</a>.  Operators may use distinct selectors and/or domains for the ARC header fields at their own discretion.</p>
<h1 id="rfc.section.9"><a href="#rfc.section.9">9.</a> <a href="#usage-of-chain-validity" id="usage-of-chain-validity">Usage of Chain Validity</a></h1>
<h1 id="rfc.section.9.1"><a href="#rfc.section.9.1">9.1.</a> <a href="#assessing-chain-validity-violations" id="assessing-chain-validity-violations">Assessing Chain Validity Violations</a></h1>
<p id="rfc.section.9.1.p.1">There are a wide variety of ways in which the ARC set of header fields can be broken.  Receivers need to be wary of ascribing motive to such breakage although patterns of common behaviour may provide some basis for adjusting local policy decisions.</p>
<p id="rfc.section.9.1.p.2">This specification is exclusively focused on well-behaved, participating intermediaries that result in a valid chain of ARC-related header fields. The value of such a well-formed, valid chain needs to be interpreted with care since malicious content can be easily introduced by otherwise well-intended senders through machine or account compromises. All normal content-based analysis still needs to be performed on any messages bearing a valid chain of ARC header sets.</p>
<h1 id="rfc.section.9.2"><a href="#rfc.section.9.2">9.2.</a> <a href="#seal-failed" id="seal-failed">Marking and Sealing Invalid Chains</a></h1>
<p id="rfc.section.9.2.p.1">The header fields signed by the AS header field b= value in the case of a major violation MUST be only the matching &#8216;i=&#8217; instance headers created by the MTA which detected the malformed chain, as if this newest ARC set was the only set present. (This is the same procedure required for handling major/structural validity problems.)</p>
<h1 id="rfc.section.9.3"><a href="#rfc.section.9.3">9.3.</a> <a href="#dns-arc" id="dns-arc">Handling DNS Problems While Validating ARC</a></h1>
<p id="rfc.section.9.3.p.1">DNS failures to resolve or return data which is needed for ARC validation SHOULD result in a 421 tempfail during the SMTP conversation with the sending system.  Temporary or intermittent DNS problems will generally not be sufficiently transitory to allow a mediator to obtain a different result during the ordinary transit duration so it is better to have the source system queue the problematic message(s) than to generate (potential) backscatter.</p>
<p id="rfc.section.9.3.p.2">DNS-based failures to verify a chain are treated no differently than any other ARC violation. They result in a cv=fail verdict.</p>
<h1 id="rfc.section.9.4"><a href="#rfc.section.9.4">9.4.</a> <a href="#responding-to-arc-validity-violations" id="responding-to-arc-validity-violations">Responding to ARC Validity Violations</a></h1>
<p id="rfc.section.9.4.p.1">If a receiver determines that the ARC chain has failed, the receiver MAY signal the breakage through the extended SMTP response code 5.7.7 <a href="#RFC3463">[RFC3463]</a> &#8220;message integrity failure&#8221; <a href="#ENHANCED-STATUS">[ENHANCED-STATUS]</a> and corresponding SMTP response code.</p>
<h1 id="rfc.section.9.5"><a href="#rfc.section.9.5">9.5.</a> <a href="#recording-the-results-of-arc-evaluation" id="recording-the-results-of-arc-evaluation">Recording the Results of ARC Evaluation</a></h1>
<p id="rfc.section.9.5.p.1">Receivers MAY add an &#8220;arc=[pass|fail|policy]&#8221; method annotation into a locally-affixed Authentication-Results <a href="#RFC7601">[RFC7601]</a> header field along with any salient comment(s).</p>
<h1 id="rfc.section.9.5.1"><a href="#rfc.section.9.5.1">9.5.1.</a> <a href="#arc-data" id="arc-data">Output Information from an ARC Evaluation</a></h1>
<p id="rfc.section.9.5.1.p.1">The evaluation of a series of ARC sets results in the following data which MAY be used to inform local-policy decisions:</p>
<p/>

<ul>
  <li>A list of the &#8220;d=&#8221; domains found in the validated (== all) ARC-Seal header fields;</li>
  <li>The &#8220;d=&#8221; domain found in the most recent (highest instance number) AMS header field (since that is the only one necessarily validated)</li>
</ul>
<p id="rfc.section.9.5.1.p.3">In the case of a failed chain, only the terminal ARC set is covered by the ARC-Seal so the reporting is limited to the findings in that terminal ARC set.</p>
<h1 id="rfc.section.9.5.2"><a href="#rfc.section.9.5.2">9.5.2.</a> <a href="#reporting-arc-effects-for-dmarc-local-policy-interim" id="reporting-arc-effects-for-dmarc-local-policy-interim">Reporting ARC Effects for DMARC Local Policy - Interim</a></h1>
<p id="rfc.section.9.5.2.p.1">[[ Note: Discussion on the IETF DMARC-WG list has indicated some interest in more substantial reporting for analytic purposes. To support that effort, the following guidance is provided only as an interim, minimal data set. A more complete reporting construct will be specified in a related spec - TBD. (see also the note at <a href="#aar-defn">Section 5.1</a>) ]]</p>
<p id="rfc.section.9.5.2.p.2">Receivers SHOULD indicate situations in which ARC evaluation influenced the results of their local policy determination. DMARC reporting of ARC-informed decisions is augmented by adding a local_policy comment explanation containing the list of data discovered in the ARC evaluation (<a href="#arc-data">Section 9.5.1</a>):</p>
<pre>
&lt;policy_evaluated&gt;
  &lt;disposition&gt;delivered&lt;/disposition&gt;
  &lt;dkim&gt;fail&lt;/dkim&gt;
  &lt;spf&gt;fail&lt;/spf&gt;
  &lt;reason&gt;
   &lt;type&gt;local_policy&lt;/type&gt;
   &lt;comment&gt;arc=pass ams=d2.example d=d2.example,d1.example&lt;/comment&gt;
  &lt;/reason&gt;
&lt;/policy_evaluated&gt;
</pre>
<p id="rfc.section.9.5.2.p.3">In the suggested sample, d2.example is the sealing domain for ARC[2] and d1.example is the sealing domain for ARC[1].</p>
<p id="rfc.section.9.5.2.p.4">Mediators SHOULD generate DMARC reports on messages which transit their system just like any other message which they receive. This will result in multiple reports for each mediated message as they transit the series of handlers.  DMARC report consumers should be aware of this behaviour and make the necessary accommodations.</p>
<h1 id="rfc.section.10"><a href="#rfc.section.10">10.</a> <a href="#supporting-alternate-signing-algorithms" id="supporting-alternate-signing-algorithms">Supporting Alternate Signing Algorithms</a></h1>
<p id="rfc.section.10.p.1">[[ Note: Some additional development of this section is needed. ]]</p>
<p id="rfc.section.10.p.2">In the following branch diagrams, each algorithm is represented by an &#8216;A&#8217; or &#8216;B&#8217; at each hop to depict the ARC chain that develops over a five hop scenario.  &#8216;x&#8217; represents a hop that does not support that algorithm.</p>
<p id="rfc.section.10.p.3">Note that during a transitional period where multiple algorithms are allowed, all of the statements in this spec which refer to &#8220;exactly one set of ARC headers per instance&#8221; need to be understood as &#8220;at least one set per instance and no more than one instance-set per algorithm&#8221;.</p>
<h1 id="rfc.section.10.1"><a href="#rfc.section.10.1">10.1.</a> <a href="#introductory-period" id="introductory-period">Introductory Period</a></h1>
<p id="rfc.section.10.1.p.1">Intermediaries MUST be able to validate ARC chains build with either algorithm but MAY create ARC sets with either (or both) algorithm.</p>
<p id="rfc.section.10.1.p.2">The introductory period should be at least six (6) months.</p>
<h1 id="rfc.section.10.2"><a href="#rfc.section.10.2">10.2.</a> <a href="#co-existence-period" id="co-existence-period">Co-Existence Period</a></h1>
<p id="rfc.section.10.2.p.1">Intermediaries MUST be able to validate ARC chains build with either algorithm and MUST create ARC sets with both algorithms.  Chains ending with either algorithm may be used for the result.</p>
<h1 id="rfc.section.10.3"><a href="#rfc.section.10.3">10.3.</a> <a href="#deprecation-period" id="deprecation-period">Deprecation Period</a></h1>
<p id="rfc.section.10.3.p.1">ARC sets built with algorithms that are being deprecated MAY be considered valid within an ARC chain, however, intermediaries MUST not create additional sets with the deprecated algorithm.</p>
<p id="rfc.section.10.3.p.2">The deprecation period should be at least two (2) years.</p>
<h1 id="rfc.section.11"><a href="#rfc.section.11">11.</a> <a href="#privacy-considerations" id="privacy-considerations">Privacy Considerations</a></h1>
<p id="rfc.section.11.p.1">The ARC chain provides a verifiable record of the handlers for a message.  Anonymous remailers will probably not find this to match their operating goals.</p>
<h1 id="rfc.section.12"><a href="#rfc.section.12">12.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a></h1>
<p id="rfc.section.12.p.1">This specification adds three new header fields as defined below.</p>
<h1 id="rfc.section.12.1"><a href="#rfc.section.12.1">12.1.</a> <a href="#authentication-results-method-registry-update" id="authentication-results-method-registry-update">Authentication-Results Method Registry Update</a></h1>
<p id="rfc.section.12.1.p.1">This draft adds one item to the IANA &#8220;Email Authentication Methods&#8221; registry:</p>
<p/>

<ul>
  <li>Method : arc  <br/><br/> Defined: [I-D.ARC]  <br/><br/> ptype: header  <br/><br/> Property: chain evaluation result  <br/><br/> Value: chain evaluation result status (see <a href="#as-defn">Section 5.3</a>)  <br/><br/> Status: active  <br/><br/> Version: 1</li>
</ul>
<h1 id="rfc.section.12.2"><a href="#rfc.section.12.2">12.2.</a> <a href="#definitions-of-the-arc-header-fields" id="definitions-of-the-arc-header-fields">Definitions of the ARC header fields</a></h1>
<p id="rfc.section.12.2.p.1">This specification adds three new header fields to the &#8220;Permanent Message Header Field Registry&#8221;, as follows:</p>
<p/>

<ul>
  <li>Header field name: ARC-Seal  <br/><br/> Applicable protocol:  mail  <br/><br/> Status:  draft  <br/><br/> Author/Change controller:  IETF  <br/><br/> Specification document(s):  [I-D.ARC]  <br/><br/> Related information:  <a href="#RFC6376">[RFC6376]</a></li>
  <li>Header field name:  ARC-Message-Signature  <br/><br/> Applicable protocol:  mail  <br/><br/> Status:  draft  <br/><br/> Author/Change controller:  IETF  <br/><br/> Specification document(s):  [I-D.ARC]  <br/><br/> Related information: <a href="#RFC6376">[RFC6376]</a></li>
  <li>Header field name:  ARC-Authentication-Results  <br/><br/> Applicable protocol:  mail  <br/><br/> Status:  standard  <br/><br/> Author/Change controller:  IETF  <br/><br/> Specification document(s):  [I-D.ARC]  <br/><br/> Related information:  <a href="#RFC7601">[RFC7601]</a></li>
</ul>
<h1 id="rfc.section.13"><a href="#rfc.section.13">13.</a> <a href="#implstat" id="implstat">Implementation Status</a></h1>
<p id="rfc.section.13.p.1">[[ Note to the RFC Editor: Please remove this section before publication along with the reference to <a href="#RFC6982">[RFC6982]</a>. ]]</p>
<p id="rfc.section.13.p.2">This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in <a href="#RFC6982">[RFC6982]</a>.  The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs.  Please note that the listing of any individual implementation here does not imply endorsement by the IETF.  Furthermore, no effort has been spent to verify the information presented here that was supplied by IETF contributors.  This is not intended as, and must not be construed to be, a catalog of available implementations or their features.  Readers are advised to note that other implementations may exist.</p>
<p id="rfc.section.13.p.3">This information is known to be correct as of the seventh interoperability test event which was held on 2017-07-15 &amp; 16 at IETF99.</p>
<h1 id="rfc.section.13.1"><a href="#rfc.section.13.1">13.1.</a> <a href="#gmail-test-reflector-and-incoming-validation" id="gmail-test-reflector-and-incoming-validation">GMail test reflector and incoming validation</a></h1>
<p id="rfc.section.13.1.p.1">Organization: Google</p>
<p id="rfc.section.13.1.p.2">Description: Internal prototype implementation with both debug analysis and validating + sealing pass-through function</p>
<p id="rfc.section.13.1.p.3">Status of Operation: Production - Incoming Validation</p>
<p id="rfc.section.13.1.p.4">Coverage: Full spec implemented as of <a href="#ARC-DRAFT-03">[ARC-DRAFT-03]</a></p>
<p id="rfc.section.13.1.p.5">Licensing: Proprietary - Internal only</p>
<p id="rfc.section.13.1.p.6">Implementation Notes: Full functionality was demonstrated during the interop testing on 2016-06-17</p>
<p id="rfc.section.13.1.p.7">In place for reporting usage only as of 2016-11-21 on all GMail flows.</p>
<p id="rfc.section.13.1.p.8">Rechecked general incoming validation as of 2017-02-24 interop event.</p>
<p id="rfc.section.13.1.p.9">Contact Info: <a href="mailto:arc-discuss@dmarc.org">arc-discuss@dmarc.org</a></p>
<h1 id="rfc.section.13.2"><a href="#rfc.section.13.2">13.2.</a> <a href="#aol-test-reflector-and-internal-tagging" id="aol-test-reflector-and-internal-tagging">AOL test reflector and internal tagging</a></h1>
<p id="rfc.section.13.2.p.1">Organization: AOL</p>
<p id="rfc.section.13.2.p.2">Description: Internal prototype implementation with both debug analysis and validating + sealing pass-through function</p>
<p id="rfc.section.13.2.p.3">Status of Operation: Beta</p>
<p id="rfc.section.13.2.p.4">Coverage: ARC chain validity status checking is not operational, but otherwise this system conforms to <a href="#ARC-DRAFT-03">[ARC-DRAFT-03]</a></p>
<p id="rfc.section.13.2.p.5">Licensing: Proprietary - Internal only</p>
<p id="rfc.section.13.2.p.6">Implementation Notes: Full functionality with the exception of chain validity checking was demonstrated during the interop testing on 2016-06-17</p>
<p id="rfc.section.13.2.p.7">Available for production mail via selected account whitelisting for test validation only.</p>
<p id="rfc.section.13.2.p.8">Intermittent stability problems discovered at the interop event on 2017-02-24. Remediation underway as of the publication of this draft.</p>
<p id="rfc.section.13.2.p.9">Contact Info: <a href="mailto:arc-discuss@dmarc.org">arc-discuss@dmarc.org</a></p>
<h1 id="rfc.section.13.3"><a href="#rfc.section.13.3">13.3.</a> <a href="#dkimpy" id="dkimpy">dkimpy</a></h1>
<p id="rfc.section.13.3.p.1">Organization: dkimpy developers</p>
<p id="rfc.section.13.3.p.2">Description: Python DKIM package</p>
<p id="rfc.section.13.3.p.3">Status of Operation: Production</p>
<p id="rfc.section.13.3.p.4">Coverage: The internal test suite is incomplete, but the command line developmental version of validator was demonstrated to interoperate with the Google and AOL implementations during the interop on 2016-06-17 and the released version passes the tests in <a href="#ARC-TEST">[ARC-TEST]</a> https://github.com/ValiMail/arc_test_suite with both python and python3.</p>
<p id="rfc.section.13.3.p.5">Licensing: Open/Other (same as dkimpy package)</p>
<p id="rfc.section.13.3.p.6">Contact Info: https://launchpad.net/dkimpy</p>
<h1 id="rfc.section.13.4"><a href="#rfc.section.13.4">13.4.</a> <a href="#openarc" id="openarc">OpenARC</a></h1>
<p id="rfc.section.13.4.p.1">Organization: TDP/Murray Kucherawy</p>
<p id="rfc.section.13.4.p.2">Description: Implemention of milter functionality related to the OpenDKIM and OpenDMARC packages</p>
<p id="rfc.section.13.4.p.3">Status of Operation: Beta</p>
<p id="rfc.section.13.4.p.4">Coverage: Built to support <a href="#ARC-DRAFT-03">[ARC-DRAFT-03]</a></p>
<p id="rfc.section.13.4.p.5">Licensing: Open/Other (same as OpenDKIM and OpenDMARC packages)</p>
<p id="rfc.section.13.4.p.6">Implementation Notes: The build is FreeBSD oriented and takes some tweaks to build on RedHat-based Linux platforms.</p>
<pre>
Initial testing during the
interop event on 2016-06-17 showed that it can be operational, but the
documentation regarding configuration settings is unclear and the 
generated signature values do not validate when compared to the Google,
AOL or dkimpy implementations.

Testing during the 2017-02-24 interop event showed that some of the 
problems have been fixed, but there are still interoperability problems
when trying to use OpenARC in a "sandwich" configuration around a MLM.
</pre>
<p id="rfc.section.13.4.p.7">Contact Info: <a href="mailto:arc-discuss@dmarc.org">arc-discuss@dmarc.org</a></p>
<h1 id="rfc.section.13.5"><a href="#rfc.section.13.5">13.5.</a> <a href="#mailman-addition" id="mailman-addition">Mailman addition</a></h1>
<p id="rfc.section.13.5.p.1">Organization: Mailman development team</p>
<p id="rfc.section.13.5.p.2">Description: Integrated ARC capabilities within the Mailman package</p>
<p id="rfc.section.13.5.p.3">Status of Operation: Patch submitted</p>
<p id="rfc.section.13.5.p.4">Coverage: Unknown</p>
<p id="rfc.section.13.5.p.5">Licensing: Same as mailman package - GPL</p>
<p id="rfc.section.13.5.p.6">Implementation Notes: Incomplete at this time</p>
<p id="rfc.section.13.5.p.7">Contact Info: https://www.gnu.org/software/mailman/contact.html</p>
<h1 id="rfc.section.13.6"><a href="#rfc.section.13.6">13.6.</a> <a href="#copernicamailerq-web-based-validation" id="copernicamailerq-web-based-validation">Copernica/MailerQ web-based validation</a></h1>
<p id="rfc.section.13.6.p.1">Organization: Copernica</p>
<p id="rfc.section.13.6.p.2">Description: Web-based validation of ARC-signed messages</p>
<p id="rfc.section.13.6.p.3">Status of Operation: Beta</p>
<p id="rfc.section.13.6.p.4">Coverage: Built to support <a href="#ARC-DRAFT-03">[ARC-DRAFT-03]</a></p>
<p id="rfc.section.13.6.p.5">Licensing: On-line usage only</p>
<p id="rfc.section.13.6.p.6">Implementation Notes: Released 2016-10-24</p>
<p id="rfc.section.13.6.p.7">Requires full message content to be pasted into a web form found at http://arc.mailerq.com/ (warning - https is not supported).</p>
<p id="rfc.section.13.6.p.8">An additional instance of an ARC signature can be added if one is willing to paste a private key into an unsecured web form.</p>
<p id="rfc.section.13.6.p.9">Initial testing shows that results match the other implementations listed in this section.</p>
<p id="rfc.section.13.6.p.10">Contact Info: [https://www.copernica.com/]</p>
<h1 id="rfc.section.13.7"><a href="#rfc.section.13.7">13.7.</a> <a href="#rspamd" id="rspamd">Rspamd</a></h1>
<p id="rfc.section.13.7.p.1">Organization: Rspamd community</p>
<p id="rfc.section.13.7.p.2">Description: ARC signing and verification module</p>
<p id="rfc.section.13.7.p.3">Status of Operation: Production, though deployment usage is unknown</p>
<p id="rfc.section.13.7.p.4">Coverage: Built to support <a href="#ARC-DRAFT-03">[ARC-DRAFT-03]</a></p>
<p id="rfc.section.13.7.p.5">Licensing: Open source</p>
<p id="rfc.section.13.7.p.6">Implementation Notes: Released with version 1.6.0 on 2017-06-12</p>
<p id="rfc.section.13.7.p.7">Contact Info: [https://rspamd.com/doc/modules/arc.html] and [https://github.com/vstakhov/rspamd]</p>
<h1 id="rfc.section.13.8"><a href="#rfc.section.13.8">13.8.</a> <a href="#perl-mailmilterauthentication-module" id="perl-mailmilterauthentication-module">PERL Mail::Milter::Authentication module</a></h1>
<p id="rfc.section.13.8.p.1">Organization: FastMail</p>
<p id="rfc.section.13.8.p.2">Description: Email domain authentication milter, previously included SPF / DKIM / DMARC, now has ARC added</p>
<p id="rfc.section.13.8.p.3">Status of Operation: Intial validation completed during IETF99 hackathon with some follow-on work during the week</p>
<p id="rfc.section.13.8.p.4">Coverage: Built to support [I-D.ARC]</p>
<p id="rfc.section.13.8.p.5">Licensing: Open Source</p>
<p id="rfc.section.13.8.p.6">Implementation Notes:</p>
<p id="rfc.section.13.8.p.7">Contact Info: https://github.com/fastmail/authentication_milter</p>
<h1 id="rfc.section.14"><a href="#rfc.section.14">14.</a> <a href="#sec-con" id="sec-con">Security Considerations</a></h1>
<p id="rfc.section.14.p.1">The Security Considerations of <a href="#RFC6376">[RFC6376]</a> and <a href="#RFC7601">[RFC7601]</a> apply directly to this specification.</p>
<p id="rfc.section.14.p.2">Inclusion of ARC sets in the header of emails may cause problems for some older or more constrained MTAs if they are unable to accept the greater size of the header.</p>
<p id="rfc.section.14.p.3">Operators who receive a message bearing N ARC sets has to complete N+1 DNS queries to evaluate the chain (barring DNS redirection mechanisms which can increase the lookups for a given target value).  This has at least two effects:</p>
<p/>

<ol>
  <li>An attacker can send a message to an ARC partipant with a concocted sequence of ARC sets bearing the domains of intended victims, and all of them will be queried by the participant until a failure is discovered.</li>
  <li>DKIM only does one DNS check per signature, while this one can do many.  Absent caching, slow DNS responses can cause SMTP timeouts; this could be exploited as a DoS attack.</li>
</ol>
<h1 id="rfc.section.14.1"><a href="#rfc.section.14.1">14.1.</a> <a href="#message-content-suspicion" id="message-content-suspicion">Message Content Suspicion</a></h1>
<p id="rfc.section.14.1.p.1">Recipients are cautioned to treat messages bearing ARC sets with the same suspicion that they apply to all other email messages. This includes appropriate content scanning and other checks for potentially malicious content. The handlers which are identified within the ARC-Seal chain may be used to provide input to local policy engines in cases where the sending system&#8217;s DKIM-Signature does not validate.</p>
<h1 id="rfc.references"><a href="#rfc.references">15.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">15.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="RFC1345">[RFC1345]</b>
      </td>
      <td class="top"><a>Simonsen, K.</a>, "<a href="http://tools.ietf.org/html/rfc1345">Character Mnemonics and Character Sets</a>", RFC 1345, DOI 10.17487/RFC1345, June 1992.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2142">[RFC2142]</b>
      </td>
      <td class="top"><a>Crocker, D.</a>, "<a href="http://tools.ietf.org/html/rfc2142">Mailbox Names for Common Services, Roles and Functions</a>", RFC 2142, DOI 10.17487/RFC2142, May 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2606">[RFC2606]</b>
      </td>
      <td class="top"><a>Eastlake 3rd, D.</a> and <a>A. Panitz</a>, "<a href="http://tools.ietf.org/html/rfc2606">Reserved Top Level DNS Names</a>", BCP 32, RFC 2606, DOI 10.17487/RFC2606, June 1999.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC3463">[RFC3463]</b>
      </td>
      <td class="top"><a>Vaudreuil, G.</a>, "<a href="http://tools.ietf.org/html/rfc3463">Enhanced Mail System Status Codes</a>", RFC 3463, DOI 10.17487/RFC3463, January 2003.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC4686">[RFC4686]</b>
      </td>
      <td class="top"><a>Fenton, J.</a>, "<a href="http://tools.ietf.org/html/rfc4686">Analysis of Threats Motivating DomainKeys Identified Mail (DKIM)</a>", RFC 4686, DOI 10.17487/RFC4686, September 2006.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5226">[RFC5226]</b>
      </td>
      <td class="top"><a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", RFC 5226, DOI 10.17487/RFC5226, May 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5234">[RFC5234]</b>
      </td>
      <td class="top"><a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, DOI 10.17487/RFC5234, January 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5321">[RFC5321]</b>
      </td>
      <td class="top"><a>Klensin, J.</a>, "<a href="http://tools.ietf.org/html/rfc5321">Simple Mail Transfer Protocol</a>", RFC 5321, DOI 10.17487/RFC5321, October 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5322">[RFC5322]</b>
      </td>
      <td class="top"><a>Resnick, P.</a>, "<a href="http://tools.ietf.org/html/rfc5322">Internet Message Format</a>", RFC 5322, DOI 10.17487/RFC5322, October 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5585">[RFC5585]</b>
      </td>
      <td class="top"><a>Hansen, T.</a>, <a>Crocker, D.</a> and <a>P. Hallam-Baker</a>, "<a href="http://tools.ietf.org/html/rfc5585">DomainKeys Identified Mail (DKIM) Service Overview</a>", RFC 5585, DOI 10.17487/RFC5585, July 2009.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5598">[RFC5598]</b>
      </td>
      <td class="top"><a>Crocker, D.</a>, "<a href="http://tools.ietf.org/html/rfc5598">Internet Mail Architecture</a>", RFC 5598, DOI 10.17487/RFC5598, July 2009.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5863">[RFC5863]</b>
      </td>
      <td class="top"><a>Hansen, T.</a>, <a>Siegel, E.</a>, <a>Hallam-Baker, P.</a> and <a>D. Crocker</a>, "<a href="http://tools.ietf.org/html/rfc5863">DomainKeys Identified Mail (DKIM) Development, Deployment, and Operations</a>", RFC 5863, DOI 10.17487/RFC5863, May 2010.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6376">[RFC6376]</b>
      </td>
      <td class="top"><a>Crocker, D.</a>, <a>Hansen, T.</a> and <a>M. Kucherawy</a>, "<a href="http://tools.ietf.org/html/rfc6376">DomainKeys Identified Mail (DKIM) Signatures</a>", STD 76, RFC 6376, DOI 10.17487/RFC6376, September 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6377">[RFC6377]</b>
      </td>
      <td class="top"><a>Kucherawy, M.</a>, "<a href="http://tools.ietf.org/html/rfc6377">DomainKeys Identified Mail (DKIM) and Mailing Lists</a>", BCP 167, RFC 6377, DOI 10.17487/RFC6377, September 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6651">[RFC6651]</b>
      </td>
      <td class="top"><a>Kucherawy, M.</a>, "<a href="http://tools.ietf.org/html/rfc6651">Extensions to DomainKeys Identified Mail (DKIM) for Failure Reporting</a>", RFC 6651, DOI 10.17487/RFC6651, June 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7208">[RFC7208]</b>
      </td>
      <td class="top"><a>Kitterman, S.</a>, "<a href="http://tools.ietf.org/html/rfc7208">Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, Version 1</a>", RFC 7208, DOI 10.17487/RFC7208, April 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7601">[RFC7601]</b>
      </td>
      <td class="top"><a>Kucherawy, M.</a>, "<a href="http://tools.ietf.org/html/rfc7601">Message Header Field for Indicating Message Authentication Status</a>", RFC 7601, DOI 10.17487/RFC7601, August 2015.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">15.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="ARC-DRAFT-03">[ARC-DRAFT-03]</b>
      </td>
      <td class="top"><a>Andersen, K.</a>, <a>Rae-Grant, J.</a>, <a>Long, B.</a>, <a>Adams, T.</a> and <a>S. Jones</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dmarc-arc-protocol-03">Authenticated Received Chain (ARC) Protocol (I-D-03)</a>", April 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="ARC-TEST">[ARC-TEST]</b>
      </td>
      <td class="top"><a>Blank, S.</a>, "<a href="https://github.com/ValiMail/arc_test_suite">ARC Test Suite</a>", January 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="ARC-USAGE">[ARC-USAGE]</b>
      </td>
      <td class="top"><a>Jones, S.</a>, <a>Adams, T.</a>, <a>Rae-Grant, J.</a> and <a>K. Andersen</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dmarc-arc-usage-01">Recommended Usage of the ARC Headers</a>", December 2017.</td>
    </tr>
    <tr><td class="reference"><b id="ENHANCED-STATUS">[ENHANCED-STATUS]</b></td><td class="top"><a href="http://www.iana.org/assignments/smtp-enhanced-status-codes/smtp-enhanced-status-codes.xhtml">IANA SMTP Enhanced Status Codes</a>", n.d..</td>, "</tr>
    <tr>
      <td class="reference">
        <b id="RFC6982">[RFC6982]</b>
      </td>
      <td class="top"><a>Sheffer, Y.</a> and <a>A. Farrel</a>, "<a href="http://tools.ietf.org/html/rfc6982">Improving Awareness of Running Code: The Implementation Status Section</a>", RFC 6982, DOI 10.17487/RFC6982, July 2013.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7489">[RFC7489]</b>
      </td>
      <td class="top"><a>Kucherawy, M.</a> and <a>E. Zwicky</a>, "<a href="http://tools.ietf.org/html/rfc7489">Domain-based Message Authentication, Reporting, and Conformance (DMARC)</a>", RFC 7489, DOI 10.17487/RFC7489, March 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7960">[RFC7960]</b>
      </td>
      <td class="top"><a>Martin, F.</a>, <a>Lear, E.</a>, <a>Draegen. Ed., T.</a>, <a>Zwicky, E.</a> and <a>K. Andersen</a>, <a href="http://tools.ietf.org/html/rfc7960">Interoperability Issues between Domain-based Message Authentication, Reporting, and Conformance (DMARC) and Indirect Email Flows</a>", RFC 7960, DOI 10.17487/RFC7960, September 2016.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#appendix-a-example-usage-obsolete-but-retained-for-illustrative-purposes" id="appendix-a-example-usage-obsolete-but-retained-for-illustrative-purposes">Appendix A - Example Usage (Obsolete but retained for illustrative purposes)</a></h1>
<p id="rfc.section.A.p.1">[[ Note: The following examples were mocked up early in the definition process for the spec. They no longer reflect the current definition and need various updates which will be included in draft -08. ]]</p>
<h1 id="rfc.appendix.A.1"><a href="#rfc.appendix.A.1">A.1.</a> <a href="#example-1-simple-mailing-list" id="example-1-simple-mailing-list">Example 1: Simple mailing list</a></h1>
<h1 id="rfc.appendix.A.1.1"><a href="#rfc.appendix.A.1.1">A.1.1.</a> <a href="#heres-the-message-as-it-exits-the-origin" id="heres-the-message-as-it-exits-the-origin">Here&#8217;s the message as it exits the Origin:</a></h1>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijrvQw
     bv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4Gd3TRJl
     gotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@dmarc.org
Subject: Example 1
 
Hey gang,
This is a test message.
--J.
</pre>
<h1 id="rfc.appendix.A.1.2"><a href="#rfc.appendix.A.1.2">A.1.2.</a> <a href="#message-is-then-received-at-exampleorg" id="message-is-then-received-at-exampleorg">Message is then received at example.org</a></h1>
<h1 id="rfc.appendix.A.1.2.1"><a href="#rfc.appendix.A.1.2.1">A.1.2.1.</a> <a href="#example-1-step-a-message-forwarded-to-list-members" id="example-1-step-a-message-forwarded-to-list-members">Example 1, Step A: Message forwarded to list members</a></h1>
<p id="rfc.section.A.1.2.1.p.1">Processing at example.org:</p>
<p/>

<ul>
  <li>example.org performs authentication checks</li>
  <li>No previous Auth-Results or ARC-Seal headers are present</li>
  <li>example.org adds ARC-Auth-Results header</li>
  <li>example.org adds Received: header</li>
  <li>example.org adds a ARC-Seal header</li>
</ul>
<p id="rfc.section.A.1.2.1.p.3">Here&#8217;s the message as it exits example.org:</p>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF1F5
     vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3A+m4bw
     a6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for &lt;arc@example.org&gt;; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=1; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
</pre>
<h1 id="rfc.appendix.A.1.3"><a href="#rfc.appendix.A.1.3">A.1.3.</a> <a href="#example-1-message-received-by-recipient" id="example-1-message-received-by-recipient">Example 1: Message received by Recipient</a></h1>
<p id="rfc.section.A.1.3.p.1">Let&#8217;s say that the Recipient is example.com</p>
<p id="rfc.section.A.1.3.p.2">Processing at example.com:</p>
<p/>

<ul>
  <li>example.com performs usual authentication checks</li>
  <li>example.com adds Auth-Results: header, Received header</li>
  <li>Determines that message fails DMARC</li>
  <li>Checks for ARC-Seal: header; finds one</li>
  <li>Validates the signature in the ARC-Seal: header, which covers the ARC-Authentication-Results: header</li>
  <li>example.com can use the ARC-Authentication-Results values or verify the DKIM-Signature from lists.example.org</li>
</ul>
<p id="rfc.section.A.1.3.p.4">Here&#8217;s what the message looks like at this point:</p>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
Received: from example.org (example.org [208.69.40.157])
    by clothilde.example.com with ESMTP id 
    d200mr22663000ykb.93.1421363207
    for &lt;fmartin@example.com&gt;; Thu, 14 Jan 2015 15:02:40 -0800 (PST)
Authentication-Results: clothilde.example.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@example.org; dmarc=fail; arc=pass
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF
     1F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3
     A+m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for &lt;arc@example.org&gt;; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=1; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijrvQw
     bv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4Gd3TRJl
     gotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
</pre>
<h1 id="rfc.appendix.A.2"><a href="#rfc.appendix.A.2">A.2.</a> <a href="#example-2-mailing-list-to-forwarded-mailbox" id="example-2-mailing-list-to-forwarded-mailbox">Example 2: Mailing list to forwarded mailbox</a></h1>
<h1 id="rfc.appendix.A.2.1"><a href="#rfc.appendix.A.2.1">A.2.1.</a> <a href="#heres-the-message-as-it-exits-the-origin-1" id="heres-the-message-as-it-exits-the-origin-1">Here&#8217;s the message as it exits the Origin:</a></h1>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijrvQw
     bv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4Gd3TRJl
     gotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@example.org
Subject: Example 1
 
Hey gang,
This is a test message.
--J.
</pre>
<h1 id="rfc.appendix.A.2.2"><a href="#rfc.appendix.A.2.2">A.2.2.</a> <a href="#message-is-then-received-at-exampleorg-1" id="message-is-then-received-at-exampleorg-1">Message is then received at example.org</a></h1>
<h1 id="rfc.appendix.A.2.2.1"><a href="#rfc.appendix.A.2.2.1">A.2.2.1.</a> <a href="#example-2-step-a-message-forwarded-to-list-members" id="example-2-step-a-message-forwarded-to-list-members">Example 2, Step A: Message forwarded to list members</a></h1>
<p id="rfc.section.A.2.2.1.p.1">Processing at example.org:</p>
<p/>

<ul>
  <li>example.org performs authentication checks</li>
  <li>example.org applies standard DKIM signature</li>
  <li>No previous Auth-Results or ARC-Seal headers are present</li>
  <li>example.org adds ARC-Auth-Results header</li>
  <li>example.org adds usual Received: header</li>
  <li>example.org adds a ARC-Seal header</li>
</ul>
<p id="rfc.section.A.2.2.1.p.3">Here&#8217;s the message as it exits Step A:</p>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz6
     1TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L
     69EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF
     1F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3
     A+m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for &lt;arc@example.org&gt;; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=1; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
</pre>
<h1 id="rfc.appendix.A.2.2.2"><a href="#rfc.appendix.A.2.2.2">A.2.2.2.</a> <a href="#example-2-step-b-message-from-list-forwarded" id="example-2-step-b-message-from-list-forwarded">Example 2, Step B: Message from list forwarded</a></h1>
<p id="rfc.section.A.2.2.2.p.1">The message is delivered to a mailbox at gmail.com<br/> Processing at gmail.com:</p>
<p/>

<ul>
  <li>gmail.com performs usual authentication checks</li>
  <li>gmail.com adds Auth-Results: and Received: header</li>
  <li>Determines that message fails DMARC</li>
  <li>Checks for ARC-Seal: header; finds one</li>
  <li>Validates the signature in the ARC-Seal: header, which covers the ARC-Authentication-Results: header</li>
  <li>Uses the ARC-Auth-Results: values, but:</li>
  <li>Instead of delivering message, prepares to forward message per user settings</li>
  <li>Applies usual DKIM signature</li>
  <li>gmail.com adds it&#8217;s own ARC-Seal: header, contents of which are <ul><li>version</li><li>sequence number (&#8220;i=2&#8221;)</li><li>hash algorithm (SHA256 as example)</li><li>timestamp (&#8220;t=&#8221;)</li><li>selector for key (&#8220;s=notary01&#8221;)</li><li>domain for key (&#8220;d=gmail.com&#8221;)</li><li>headers included  in hash (&#8220;h=ARC-Authentication-Results:ARC-Seal&#8221;)</li><li>Note: algorithm requires only ARC-Seals with lower sequence # be included, in ascending order</li><li>signature of the header hash</li></ul></li>
</ul>
<p id="rfc.section.A.2.2.2.p.3">Here&#8217;s what the message looks like at this point:</p>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
ARC-Seal: i=2; a=rsa-sha256; t=1421363253;
    s=notary01; d=gmail.com; cv=pass; 
    b=sjHDMriRZ0Mui5eVEOGscRHWbQHcy97lvrduHQ8h+f2CfIrxUiKOE44x3LQwDWR
     YbDjf5fcM9MdcIahC+cP59BQ9Y9DHwMDzwRTnM7NVb4kY+tSaVnLoIOaP9lF/sut
     txO+RRNr0fCFw==
ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed;
    d=gmail.com; s=20120806;
    h=mime-version:content-type:x-original-sender:
     x-original-authentication-results:precedence:mailing-list:
     list-id:list-post:list-help:list-archive:sender:reply-to:
     list-unsubscribe:DKIM-Signature;
    bh=2+gZwZhUK2V7JbpoO2MTrU19WvhcA4JnjiohFm9ZZ/g=;
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0Ab8Oi1ebYV/hIBmfhS
     LF1E80hMPcMijONfTQB6g5Hoh/kE6N2fgp6aSngL/WA3+g3Id8ElhXHvIGcJRFeM
     KdJqiW5cxdqPTRW+BnR5ee6Tzg06kr265NTDIAU8p8fQNuLfZj49MMA+QwDBJtXw
     bQoZyRtb6X6q0mYaszUB8kw==
Received: by mail-yk0-f179.google.com with SMTP id 19so2728865ykq.10
    for &lt;mailbox@gmail.com&gt;; Thu, 14 Jan 2015 15:02:45 -0800 (PST)
Authentication-Results: i=2; gmail.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@example.org; dmarc=fail; arc=pass
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=none:
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF
     1F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3
     A+m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for &lt;arc@example.org&gt;; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=1; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
</pre>
<p/>
<h1 id="rfc.appendix.A.2.3"><a href="#rfc.appendix.A.2.3">A.2.3.</a> <a href="#example-2-message-received-by-recipient" id="example-2-message-received-by-recipient">Example 2: Message received by Recipient</a></h1>
<p id="rfc.section.A.2.3.p.1">Let&#8217;s say that the Recipient is example.com<br/> Processing at example.com:</p>
<p/>

<ul>
  <li>example.com performs usual authentication checks</li>
  <li>example.com adds Auth-Results: header, Received header</li>
  <li>Determines that message fails DMARC</li>
  <li>Checks for ARC-Seal: header; finds two</li>
  <li>Validates the signature in the highest numbered (&#8220;i=2&#8221;) ARC-Seal: header, which covers all previous ARC-Seal: and ARC-Authentication-Results: headers</li>
  <li>Validates the other ARC-Seal header (&#8220;i=1&#8221;), which covers the ARC-Authentication-Results: header</li>
  <li>example.com uses the ARC-Authentication-Results: values</li>
</ul>
<p id="rfc.section.A.2.3.p.3">Here&#8217;s what the message looks like at this point:</p>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
Received: from mail-ob0-f188.google.com (mail-ob0-f188.google.com
    [208.69.40.157]) by clothilde.example.com with ESMTP id
    d200mr22663000ykb.93.1421363268
    for &lt;fmartin@example.com&gt;; Thu, 14 Jan 2015 15:03:15 -0800 (PST)
Authentication-Results: clothilde.example.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@gmail.com; dmarc=fail; arc=pass
ARC-Seal: i=2; a=rsa-sha256; t=1421363253;
    s=notary01; d=gmail.com; cv=pass; 
    b=sjHDMriRZ0Mui5eVEOGscRHWbQHcy97lvrduHQ8h+f2CfIrxUiKOE44x3LQwDWR
     YbDjf5fcM9MdcIahC+cP59BQ9Y9DHwMDzwRTnM7NVb4kY+tSaVnLoIOaP9lF/sut
     txO+RRNr0fCFw==
ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed;
    d=gmail.com; s=20120806;
    h=mime-version:content-type:x-original-sender:
     x-original-authentication-results:precedence:mailing-list:
     list-id:list-post:list-help:list-archive:sender:reply-to:
     :list-unsubscribe:DKIM-Signature;
    bh=2+gZwZhUK2V7JbpoO2MTrU19WvhcA4JnjiohFm9ZZ/g=;
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0Ab8Oi1ebYV/hIBmfhS
     LF1E80hMPcMijONfTQB6g5Hoh/kE6N2fgp6aSngL/WA3+g3Id8ElhXHvIGcJRFeM
     KdJqiW5cxdqPTRW+BnR5ee6Tzg06kr265NTDIAU8p8fQNuLfZj49MMA+QwDBJtXw
     bQoZyRtb6X6q0mYaszUB8kw==
Received: by mail-yk0-f179.google.com with SMTP id 19so2728865ykq.10
    for &lt;mailbox@gmail.com&gt;; Thu, 14 Jan 2015 15:02:45 -0800 (PST)
Authentication-Results: i=2; gmail.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@example.org; dmarc=fail; arc=pass
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF
     1F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3
     A+m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for &lt;arc@example.org&gt;; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=1; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
</pre>
<h1 id="rfc.appendix.A.3"><a href="#rfc.appendix.A.3">A.3.</a> <a href="#example-3-mailing-list-to-forwarded-mailbox-with-source" id="example-3-mailing-list-to-forwarded-mailbox-with-source">Example 3: Mailing list to forwarded mailbox with source</a></h1>
<h1 id="rfc.appendix.A.3.1"><a href="#rfc.appendix.A.3.1">A.3.1.</a> <a href="#heres-the-message-as-it-exits-the-origin-2" id="heres-the-message-as-it-exits-the-origin-2">Here&#8217;s the message as it exits the Origin:</a></h1>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=origin2015; d=d1.example; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61T
     X6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69EU
     8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=d1.example; s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=MIME-Version:CC:Content-Type:Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijrv
     Qwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4Gd3
     TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@example.org
Subject: Example 1
 
Hey gang,
This is a test message.
--J.
</pre>
<h1 id="rfc.appendix.A.3.2"><a href="#rfc.appendix.A.3.2">A.3.2.</a> <a href="#message-is-then-received-at-exampleorg-2" id="message-is-then-received-at-exampleorg-2">Message is then received at example.org</a></h1>
<p/>
<h1 id="rfc.appendix.A.3.2.1"><a href="#rfc.appendix.A.3.2.1">A.3.2.1.</a> <a href="#example-3-step-a-message-forwarded-to-list-members-with-source" id="example-3-step-a-message-forwarded-to-list-members-with-source">Example 3, Step A: Message forwarded to list members with source</a></h1>
<p id="rfc.section.A.3.2.1.p.1">Processing at example.org:</p>
<p/>

<ul>
  <li>example.org performs authentication checks</li>
  <li>example.org applies standard DKIM signature</li>
  <li>Checks for ARC-Seal: header; finds one (i=1)</li>
  <li>Validates the signature in the ARC-Seal (i=1): header, which covers the d1.example ARC-Message-Signature: header</li>
  <li>example.org adds ARC-Auth-Results header</li>
  <li>example.org adds usual Received: header</li>
  <li>example.org adds a DKIM-Signature</li>
  <li>example.org adds a ARC-Seal header, contents of which are <ul><li>sequence number (&#8220;i=2&#8221;)</li><li>hash algorithm (SHA256 as example)</li><li>timestamp (&#8220;t=&#8221;)</li><li>chain validity (&#8220;cv=&#8221;)</li><li>selector for key (&#8220;s=seal2015&#8221;)</li><li>domain for key (&#8220;d=example.org&#8221;)</li><li>signature (&#8220;b=&#8221;)</li></ul></li>
</ul>
<p id="rfc.section.A.3.2.1.p.3">Here&#8217;s the message as it exits Step A:</p>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
ARC-Seal: i=2; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=pass; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz6
     1TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L
     69EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:From:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF
     1F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3
     A+m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for &lt;arc@example.org&gt;; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=2; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=origin2015; d=d1.example; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=d1.example; s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=MIME-Version:CC:Content-Type:Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
</pre>
<h1 id="rfc.appendix.A.3.2.2"><a href="#rfc.appendix.A.3.2.2">A.3.2.2.</a> <a href="#example-3-step-b-message-from-list-forwarded-with-source" id="example-3-step-b-message-from-list-forwarded-with-source">Example 3, Step B: Message from list forwarded with source</a></h1>
<p id="rfc.section.A.3.2.2.p.1">The message is delivered to a mailbox at gmail.com<br/> Processing at gmail.com:</p>
<p/>

<ul>
  <li>gmail.com performs usual authentication checks</li>
  <li>gmail.com adds Auth-Results: and Received: header</li>
  <li>Determines that message fails DMARC</li>
  <li>Checks for ARC-Seal: header; finds two</li>
  <li>Validates the signature in the ARC-Seal (i=2): header, which covers the ARC-Authentication-Results: header</li>
  <li>Validates the signature in the ARC-Seal (i=1): header, which covers the d1.example ARC-Message-Signature: header</li>
  <li>Uses the ARC-Auth-Results: values, but:</li>
  <li>Instead of delivering message, prepares to forward message per user settings</li>
  <li>Applies usual DKIM signature</li>
  <li>gmail.com adds it&#8217;s own ARC-Seal: header, contents of which are <ul><li>version</li><li>sequence number (&#8220;i=2&#8221;)</li><li>hash algorithm (SHA256 as example)</li><li>timestamp (&#8220;t=&#8221;)</li><li>selector for key (&#8220;s=notary01&#8221;)</li><li>domain for key (&#8220;d=gmail.com&#8221;)</li><li>Note: algorithm requires only ARC-Seals with lower sequence # be included, in ascending order</li><li>signature of the chain</li></ul></li>
</ul>
<p id="rfc.section.A.3.2.2.p.3">Here&#8217;s what the message looks like at this point:</p>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
ARC-Seal: i=3; a=rsa-sha256; t=1421363253;
    s=notary01; d=gmail.com; cv=pass; 
    b=sjHDMriRZ0Mui5eVEOGscRHWbQHcy97lvrduHQ8h+f2CfIrxUiKOE44x3LQwD
     WRYbDjf5fcM9MdcIahC+cP59BQ9Y9DHwMDzwRTnM7NVb4kY+tSaVnLoIOaP9lF
     /suttxO+RRNr0fCFw==
ARC-Message-Signature: i=3; a=rsa-sha256; c=relaxed/relaxed;
    d=gmail.com; s=20120806;
    h=mime-version:content-type:x-original-sender
     :x-original-authentication-results:precedence:mailing-list
     :list-id:list-post:list-help:list-archive:sender
     :list-unsubscribe:reply-to;
    bh=2+gZwZhUK2V7JbpoO2MTrU19WvhcA4JnjiohFm9ZZ/g=;
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz6
     1TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L
     69EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0Ab8Oi1ebYV/hIBm
     fhSLF1E80hMPcMijONfTQB6g5Hoh/kE6N2fgp6aSngL/WA3+g3Id8ElhXHvIGcJ
     RFeMKdJqiW5cxdqPTRW+BnR5ee6Tzg06kr265NTDIAU8p8fQNuLfZj49MMA+QwD
     BJtXwbQoZyRtb6X6q0mYaszUB8kw==
Received: by mail-yk0-f179.google.com with SMTP id 19so2728865ykq.10
    for &lt;mailbox@gmail.com&gt;; Thu, 14 Jan 2015 15:02:45 -0800 (PST)
Authentication-Results: i=3; gmail.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@example.org; dmarc=fail; arc=pass
ARC-Seal: i=2; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=pass; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF1
     F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3A+
     m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for &lt;arc@example.org&gt;; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=2; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=origin2015; d=d1.example; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=d1.example; s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=MIME-Version:CC:Content-Type:Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYij
     rvQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD
     4Gd3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
</pre>
<h1 id="rfc.appendix.A.3.3"><a href="#rfc.appendix.A.3.3">A.3.3.</a> <a href="#example-3-message-received-by-recipient" id="example-3-message-received-by-recipient">Example 3: Message received by Recipient</a></h1>
<p id="rfc.section.A.3.3.p.1">Let&#8217;s say that the Recipient is example.com<br/> Processing at example.com:</p>
<p/>

<ul>
  <li>example.com performs usual authentication checks</li>
  <li>example.com adds Auth-Results: header, Received header</li>
  <li>Determines that message fails DMARC</li>
  <li>Checks for ARC-Seal: header; finds three</li>
  <li>Validates the signature in the highest numbered (&#8220;i=2&#8221;) ARC-Seal: header, which covers all previous ARC-Seal: and ARC-Authentication-Results: headers</li>
  <li>Validates the other ARC-Seal header (&#8220;i=2&#8221;), which covers the ARC-Authentication-Results: header</li>
  <li>Validates the other ARC-Seal header (&#8220;i=1&#8221;), which covers the d1.example ARC-Message-Signature: header</li>
  <li>example.com uses the ARC-Authentication-Results: values</li>
</ul>
<p id="rfc.section.A.3.3.p.3">Here&#8217;s what the message looks like at this point:</p>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
Received: from mail-ob0-f188.google.com (mail-ob0-f188.google.com
    [208.69.40.157]) by clothilde.example.com with ESMTP id
    d200mr22663000ykb.93.1421363268
    for &lt;fmartin@example.com&gt;; Thu, 14 Jan 2015 15:03:15 -0800 (PST)
Authentication-Results: clothilde.example.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@gmail.com; dmarc=fail; arc=pass
ARC-Seal: i=3; a=rsa-sha256; t=1421363253;
    s=notary01; d=gmail.com; cv=pass; 
    b=sjHDMriRZ0Mui5eVEOGscRHWbQHcy97lvrduHQ8h+f2CfIrxUiKOE44x3LQwDW
     RYbDjf5fcM9MdcIahC+cP59BQ9Y9DHwMDzwRTnM7NVb4kY+tSaVnLoIOaP9lF/s
     uttxO+RRNr0fCFw==
ARC-Message-Signature: i=3; a=rsa-sha256; c=relaxed/relaxed;
    d=gmail.com; s=20120806;
    h=mime-version:content-type:x-original-sender
     :x-original-authentication-results:precedence
     :mailing-list:list-id:list-post:list-help:list-archive:sender
     :list-unsubscribe:reply-to;
    bh=2+gZwZhUK2V7JbpoO2MTrU19WvhcA4JnjiohFm9ZZ/g=;
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz6
     1TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L
     69EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0Ab8Oi1ebYV/hIBm
     fhSLF1E80hMPcMijONfTQB6g5Hoh/kE6N2fgp6aSngL/WA3+g3Id8ElhXHvIGcJ
     RFeMKdJqiW5cxdqPTRW+BnR5ee6Tzg06kr265NTDIAU8p8fQNuLfZj49MMA+QwD
     BJtXwbQoZyRtb6X6q0mYaszUB8kw==
Received: by mail-yk0-f179.google.com with SMTP id 19so2728865ykq.10
    for &lt;mailbox@gmail.com&gt;; Thu, 14 Jan 2015 15:02:45 -0800 (PST)
Authentication-Results: i=3; gmail.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@example.org; dmarc=fail; arc=pass
ARC-Seal: i=2; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=pass; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz6
     1TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L
     69EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF1
     F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3A+
     m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for &lt;arc@example.org&gt;; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=2; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=origin2015; d=d1.example; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=d1.example; s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=MIME-Version:To:CC:Subject:Content-Type:Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
</pre>
<h1 id="rfc.appendix.B"><a href="#rfc.appendix.B">Appendix B.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a></h1>
<p id="rfc.section.B.p.1">This draft is the work of OAR-Dev Group.</p>
<p id="rfc.section.B.p.2">The authors thank all of the OAR-Dev group for the ongoing help and though-provoking discussions from all the participants, especially: Alex Brotman, Brandon Long, Dave Crocker, Elizabeth Zwicky, Franck Martin, Greg Colburn, J. Trent Adams, John Rae-Grant, Mike Hammer, Mike Jones, Steve Jones, Terry Zink, Tim Draegen.</p>
<p id="rfc.section.B.p.3">Grateful appreciation is extended to the people who provided feedback through the discuss mailing list.</p>
<h1 id="rfc.appendix.C"><a href="#rfc.appendix.C">Appendix C.</a> <a href="#comments-and-feedback" id="comments-and-feedback">Comments and Feedback</a></h1>
<p id="rfc.section.C.p.1">Please address all comments, discussions, and questions to <a href="mailto:dmarc@ietf.org">dmarc@ietf.org</a>.  Earlier discussions can be found at <a href="mailto:arc-discuss@dmarc.org">arc-discuss@dmarc.org</a>.</p>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Kurt Andersen</span> 
	  <span class="n hidden">
		<span class="family-name">Andersen</span>
	  </span>
	</span>
	<span class="org vcardline">LinkedIn</span>
	<span class="adr">
	  <span class="vcardline">1000 West Maude Ave</span>

	  <span class="vcardline">
		<span class="locality">Sunnyvale</span>,  
		<span class="region">California</span> 
		<span class="code">94085</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:kurta@linkedin.com">kurta@linkedin.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Brandon Long</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Long</span>
	  </span>
	</span>
	<span class="org vcardline">Google</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:blong@google.com">blong@google.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Steven Jones</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Jones</span>
	  </span>
	</span>
	<span class="org vcardline">TDP</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:smj@crash.com">smj@crash.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Murray Kucherawy</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Kucherawy</span>
	  </span>
	</span>
	<span class="org vcardline">TDP</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:superuser@gmail.com">superuser@gmail.com</a></span>

  </address>
</div>

</body>
</html>
