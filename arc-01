---
title: Authenticated Received Chain (ARC) Protocol
abbrev: ARC-Protocol
docname: draft-ietf-dmarc-arc-protocol-06a
date: 2017-07-18

# stand_alone: true

ipr: trust200902
area: art
wg: DMARC Working Group
kw: Internet-Draft
submission: IETF
cat: std

coding: utf-8
pi:    # can use array (if all yes) or hash here
#  - toc
#  - sortrefs
#  - symrefs
  toc: yes
  sortrefs:   # defaults to yes
  symrefs: yes

author:
      -
        ins: K. Andersen
        name: Kurt Andersen
        org: LinkedIn
        street: 1000 West Maude Ave
        city: Sunnyvale
        region: California
        code: 94043
        country: USA
        email: kurta@linkedin.com
      -
        ins: B. Long
        name: Brandon Long
        org: Google
        role: editor
        email: blong@google.com
      -
        ins: S. Jones
        name: Steven Jones
        org: TDP
        role: editor
        email: smj@crash.com

normative:
  RFC1345:
  RFC5234:
  RFC5321:
  RFC5322:
  RFC3463:
  RFC7601:
  RFC7208:
  RFC6651:
  RFC5863:
  RFC6377:
  RFC5585:
  RFC6376:
  RFC4686:
  RFC5598:
  RFC5226:
  RFC2142:
  RFC2606:
  RFC3463:
  RFC2119:

informative:
  RFC6982:
  RFC7489:
  RFC7960:
  ENHANCED-STATUS: 
    title: IANA SMTP Enhanced Status Codes
    target: http://www.iana.org/assignments/smtp-enhanced-status-codes/smtp-enhanced-status-codes.xhtml
  ARC-DRAFT:
    title: Authenticated Received Chain (ARC) Protocol (I-D-03)
    target: https://tools.ietf.org/html/draft-ietf-dmarc-arc-protocol-03
    date: 2017-04-28
    author:
      -
        ins: K. Andersen
        name: Kurt Andersen
      -
        ins: J. Rae-Grant
        name: John Rae-Grant
      -
        ins: B. Long
        name: Brandon Long
      -
        ins: T. Adams
        name: J. Trent Adams
      -
        ins: S. Jones
        name: Steven Jones
  ARC-USAGE:
    title: Recommended Usage of the ARC Headers
    target: https://tools.ietf.org/html/draft-ietf-dmarc-arc-usage-01
    date: 2017-12
    author:
      -
        ins: S. Jones
        name: Steven Jones
      -
        ins: T. Adams
        name: Trent Adams
      -
        ins: J. Rae-Grant
        name: John Rae-Grant
      -
        ins: K. Andersen
        name: Kurt Andersen
  ARC-TEST:
    title: ARC Test Suite
    target: https://github.com/ValiMail/arc_test_suite
    date: 2017-01
    author:
      -
        ins: S. Blank
        name: Seth Blank

entity:
      SELF: "[I-D.ARC]"

# --- note_IESG_Note
#
# bla bla bla

--- abstract

The Authenticated Received Chain (ARC) protocol creates a mechanism whereby a series
of handlers of a message can conduct authentication of a message as it passes
among them on the way to its destination, and record the status of that
authentication at each step along the handling path, for use by the final
recipient in making choices about the disposition of the message.

--- middle
# Introduction

Modern email authentication techniques such as the Sender Policy Framework
(SPF) {{RFC7208}} and DomainKeys Identified Mail (DKIM) [RFC6376] have become
ubiquitious.  However, they are stymied by a small number of common
applications, most notably mailing list managers, as these applications have
handling properties that prevent these authentication schemes from universal
effectiveness.  These issues are described in substantial detail in those
protocols' defining documents as well as in {{RFC6377}}.

In an effort to reduce the success of fraudulent email campaigns, there has
been an effort to develop and deploy technologies that use SPF and DKIM to
assure legitimate use of the identity of the apparent message author, i.e., the
visible "From:" field in a message.  To this end, Domain-based Mail
Authentication, Reporting and Compliance (DMARC) {{RFC7489}} has been developed
and deployed.  However, its deployment in environments where mailing lists are
used has had the negative impacts predicted in the documents listed above.

What is needed is a mechanism by which legitimate alteration of a message,
invalidating SPF and DKIM, does not ultimately result in a rejection of an
email message on delivery.  An Authenticated Received Chain (ARC), described
here, provides a superset of the functionality of DKIM in order to provide to
the final message recipient a more complete view into the handling chain of a
message and the points in that chain where alterations of the content may have
occurred.  Equipped with this more compelte information, the final recipient
can make a more informed handling choice, reducing or eliminating the
false postives inherent in use of DKIM and/or SPF themselves.

# Overview

In DKIM, every participating signing agent attaches a signature that is based
on the content of the message, local policy, and the domain name of the
participating Administrative Management Domain (ADMD).  Any verifier can
process such a signature; a verified signature means the message content that
was "covered" by the signature has not been altered since the signature was
applied.  The signatures themselves are generally independent of one another.

By contrast, this protocol seeks to have each signature be able to convey the
following pieces of information:

1.  As with DKIM, an assertion that, for a passing signature, the domain name
in the signature takes some responsibility for handling of the message and that
the message is unchanged since that signature was applied;

2.  A further assertion that, at the time that same ADMD processed the message,
the various assertions already attached to the message by other ADMDs were or
were not valid;

3.  A further assertion that combines and protects the above against alteration
by later handlers.

This protocol accomplishes each of these by adding a new header field to the
message for each of them, as follows:

* ARC-Authentication-Results:  (referred to below as "AAR") virtually identical
in syntax to an Authentication-Results field {{RFC7601}}, this field records
the results of all message authentication checks done by the recording ADMD at
the time the message arrived;
* ARC-Message-Signature:  (referred to below as "AMS") virtually identical in
syntax to DKIM-Signature, this field contains the assertions about the message
header and body as they existed at the time of handling by the ADMD adding it;
and 
* ARC-Seal:  (referred to below as "AS") highly similar in structure and format
to a DKIM-Signature, this field applies a digital signature that protects the
integrity of all three of these new fields when they are added by an ADMD, plus
all instances of these fields added by prior ADMDs.

A distinguishing feature of all of these is that an ARC participant always adds
all of them before relaying a message to the next handling agent en route to
its destination.  Moreover, as described in Section {{i-defn}}, they each have an
"instance" number that increases with each ADMD in the handling chain so that
their original order can be preserved and the three of them can be processed as
a group.


# Terminology

This section defines terms used in the rest of the document. 

The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
interpreted as described in {{RFC2119}}. 

Readers are encouraged to be familiar with the contents of {{RFC5598}}, and in
particular, the potential roles of intermediaries in the delivery of email.

Syntax descriptions use Augmented BNF (ABNF) {{RFC5234}}. 

A single group of the header fields introduced in Section 2 is called an "ARC
Set", and the complete sequence of these groups is called an "Authenticated
Received Chain" or merely an "ARC chain".  Although the "Received" header field is
typically not included in the signed content, the name is based on the notion
that this is in essence a cryptographically signed series of header fields that
attest to the handling chain of a message much as Received fields always have.

# Instance ('i=') Tags {#i-defn}

The header fields comprising a single ARC Set are identified by the presence of
a string in the value portion of the header field that complies with
the "tag-spec" ABNF found in Section 3.2 of {{RFC6376}}.  The tag-name is always
the single character "i" and the value is the text representation of a positive
integer, indicating the position in the ARC sequence this set occupies, where
the first ARC Set is numbered 1.  In ABNF terms:

       instance = [FWS] %x69 [FWS] "=" [FWS] 1*DIGIT [FWS] ";"

At any delivery stage, it is an error if any ARC Set is invalid (i.e., does not
contain exactly one of the three header fields defined by this protocol).

Note that because the AMS and AS header field values are made up of tag-spec
constructs, the i= tag may be found anywhere within the header field value, but is
represented throughout this spec in the initial position for convenience. Implementers
SHOULD seek to start with the i= tag to facilitate human inspection of the headers.

# The ARC Header Fields

The three header fields that are part of this specification borrow heavily from
existing specifications.  Rather than repeating all of the formal definitions
that are being recycled in ARC, this document instead only describes and
specifies changes in syntax and semantics.

## ARC-Authentication-Results (AAR) {#aar-defn}

\[\[ Note: The intent of the AAR header is to provide the necessary information
for meaningful DMARC reporting back to the originating ADMD. As such, it needs
to include additional information than the user-focused Authentication-Results
header {{RFC7601}} but the details of that incremental information have not yet
been fully determined. ]]

The ARC-Authentication-Results header field is defined.  It is syntactically
and semantically identical to an Authentication-Results header field {{RFC7601}} (A-R),
as is the mechanism by which it is constructed, with the following exception:

* There is an "i" tag, as described in Section {{i-defn}}.

The instance identifier MUST be separated from the rest of the Authentication-Results
value contents with a semi-colon (';', 0x3b).

An ARC signer generates this field in the same way that a conventional
A-R field would be generated.

The purpose of this header field is to incorporate into the record the success
or failure of any authentication done on the message upstream of the
participating ADMD, to validate and continue the authentication chain.

In processing, some architectures will generate multiple A-R records for the 
same authserv-id. In such cases, the resinfo value from each of the A-R records should 
be concatenated into a single record just as they would have been if they were
generated in a single A-R record.

## ARC-Message-Signature (AMS) {#ams-defn}

The ARC-Message-Signature header field is defined.  It is syntactically and
semantically identical to a DKIM-Signature header field {{RFC6376}}, as is the
mechanism by which it is constructed, with the following exceptions:

* There is an "i" tag, as described in Section {{i-defn}}.
* There is no "v" tag.
* ARC-Seal header fields MUST never be included in the content covered
by the signature in this header field.

It is generally advisable to include in the header fields covered by this
signature any DKIM-Signature header fields already present on the message.

Including Authentication-Results header fields is not encouraged since they are
likely to be deleted by downstream ADMDs, thereby breaking the AMS signature.

As with a DKIM-Signature, the purpose of this header field is to allow the ADMD
generating it to take some responsibility for handling this message as it
progresses toward delivery.

## ARC-Seal {#as-defn}

ARC-Seal is a Structured Header Field as defined in Internet Message Format
({{RFC5322}}). All of the related definitions in that document apply. 

The ARC-Seal makes use of Tag=Value Lists as defined in {{RFC6376}}, Section 3.2.

The value of the header field consists of an authentication sequence
identifier, and a series of statements and supporting data. The statements
indicate relevant data about the signing of the ARC set.  The header field can
appear more than once in a single message, but each instance MUST have a unique
"i=" value.

The ARC-Seal header field includes a digital signature of all preceding ARC
message header fields on the message. 

#### Tags in the ARC-Seal Header Field Value {#seal-hdr}

The following tags are the only supported tags for an ARC-Seal field. All
of them MUST be present. Unknown tags MUST be ignored and do not affect
the validity of the header. 

* a = hash algorithm; syntax is the same as the "a=" tag defined in 
Section 3.5 of {{RFC6376}};
* b = digital signature; syntax is the same as the "b=" tag defined in
Section 3.5 of {{RFC6376}};
* cv = chain validation status: valid values: 

  * 'none' = no pre-existing chain; 
  * 'fail' = the chain as received does not or can not validate; or
  * 'pass' = valid chain received. 

* d = domain for key; syntax is the same as the "d=" tag defined
in Section 3.5 of {{RFC6376}};
* i = "instance" or sequence number; monotonically increasing at 
each "sealing" entity, beginning with '1', see {{i-hdr}} regarding the 
valid range
* s = selector for key; syntax is the same as the "s=" tag defined
in Section 3.5 of {{RFC6376}};
* t = timestamp; syntax is the same as the "t=" tag defined
in Section 3.5 of {{RFC6376}}.

##### Valid Range for "Instance" 'i' Tag Value {#i-hdr}

###### Minimum 'i' Tag Value

The minimum valid 'i' tag value is one (1).

###### Maximum 'i' Tag Value

ARC implementations MUST support at least ten (10) intermediary steps.

More than fifty (50) intermediaries is considered extremely unlikely so
ARC chains with more than fifty intermediaries may be marked with "cv=fail".

The maximum valid 'i' tag value is 1024, but values more that the supported number
of intermediaries are meaningless.

#### Differences between DKIM-Signature and ARC-Seal

No 'bh' value is defined for ARC-Seal, since only message header fields
are ever signed by the ARC-Seal.

ARC-Seal does not use the 'h' tag (the list of signed header fields) that is
defined for DKIM-Signatures because the list of applicable header fields is
fully determined by the construction rules (see {{implicit-as-h}}).

ARC-Seal does not use the 'c' (canonicalization) tag because only 'relaxed'
canonicalization {{RFC6376}} is allowed for ARC-Seal header field canonicalization.

#### Deterministic (Implicit) 'h' Tag Value for ARC-Seal {#implicit-as-h}

In this section, the term "scope" is used to indicate those header fields
signed by an ARC-Seal header field.  A number in parentheses indicates the
instance of that field, starting at 1.  The suffix "-no-b" is used with an
ARC-Seal field to indicate that its "b" field is empty at the time the
signature is computed, as described in Section 3.5 of {{RFC6376}}.  "AAR"
refers to ARC-Authentication-Results, "AMS" to ARC-Message-Signature, "AS" to
ARC-Seal, and "ASB" to an ARC-Seal with an empty "b" tag.

Generally, the scope of an ARC set for a message containing "n" ARC sets is the
concatenation of the following, for x (instance number) from 1 to n:

* AAR(x);
* AMS(x);
* ASB(x) if x = n, else AS(x)

Thus for a message with no seals (i.e., upon injection), the scope of the first
ARC set is AAR(1):AMS(1):ASB(1).  The ARC set thus generated would produce a
first ARC-Seal with a "b" value.  The next ARC set would include in its signed
content the prior scope, so it would have a scope of
AAR(1):AMS(1):AS(1):AAR(2):AMS(2):ASB(2).

Note: Typically header field sets appear within the header in descending instance
order.

#### Computing the 'b' Tag Value for ARC-Seal

The ARC-Seal generation process mirrors the procedure used for DKIM-Signature
fields described in Section 5 of {{RFC6376}} in that it is at first generated
with empty "b" field for the purpose of signature generation, and then the "b"
value is added just prior to adding the ARC-Seal field to the message.

In particular, signing calculation MUST be done in bottom-up order as specified
in Section 5.4.2 of {{RFC6376}} and as illustrated above {{implicit-as-h}}.

#### Determining the 'cv' Tag Value for ARC-Seal  {#cv-calc}

In order for a series of ARC sets to be considered valid, the following statements
MUST be satisfied:

0. The chain of ARC sets must have structural integrity (no sets or set component
  header fields missing, no duplicates, excessive hops (cf. {{i-hdr}}), etc.);
1. All ARC-Seal header fields MUST validate;
2. All ARC-Seal header fields MUST have a chain value (cv=) status of "pass" 
  (except the first which MUST be "none"); and
3. The newest (highest instance number (i=)) AMS header field MUST validate.

##### Pseudocode to Determine Chain Value Status:

In the algorith below, a "hop" is represented by the ARC set bearing a 
particular instance number. The number of hops is the same as the highest
instance number found in the ARC sets, or 0 (zero) if there are no ARC
sets found within the header.

"Success" means that the signature found in the referenced header validates
when checked against the specified content.

~~~~~~~~~~

if (lastest_hop.AS.cv == "fail") {
  terminate analysis - no further ARC processing
}

if (chain not structurally valid) {
  return "fail"
} else if (num_hops == 0) {
  return "none"
} else {
  if (validate(latest_hop.AMS) != success) {
    return "fail"
  } else {
    // note that instance is always >= 1 by definition
    for each hop (from highest instance to lowest) {  
      if ((hop_num > 1 and hop.ARC-Seal.cv == "pass") or
          (hop_num == 1 and hop.ARC-Seal.cv == "none")) {
        if (validate(hop.ARC-Seal) != success) {
          return "fail" 
        } 
      } else {
        return "fail"
      }
    }
  }

  return "pass"
}

~~~~~~~~~~

# -- moved --


The ARC sets SHOULD be added at the top of a message header as it transits MTAs that
do authentication checks, so some idea of how far away the checks were done can
be inferred. They are therefore considered to be a trace field as defined in
{{RFC5321}}, and all of the related definitions in that document apply. 

Relative ordering of different trace header fields (the ARC sets, DKIM,
Received, etc.) is unimportant for this specification. In general, trace header
fields, such as ARC, SHOULD be added at the top of the email header fields, but
receivers MUST be able to process the header fields from wherever they are
found in the message header.  Ordering amongst the individual ARC header fields
and sets is specified below and MUST be followed for proper canonicalized
signing and evaluation.

## Description of the New Header Fields

## Constructing the ARC-Seal Set {#build-hdrs}

The ARC-Seal is built in the same fashion as the analogous DKIM-Signature
{{RFC6376}}, using the relaxed header canonicalization rules specified in
that document but with a strict ordering component for the header fields 
covered by the cryptographic signature: 

1. The ARC sets MUST be ordered in descending instance (i=) order. 
2. The referenced ARC-Message-Signatures (matching i= value)
MUST immediately follow the ARC-Seal instance which included the reference.
3. The associated ARC-Authentication-Results header field (matching i= value) MUST be the 
last item in the list for each set of ARC header fields.

Thus, when prefixing ARC header fields to the existing header,

1. the AAR header would be prefixed first; then 
2. the AMS would be calculated and prefixed (above the AAR); 
3. lastly the AS would be calculated and prefixed (above the AMS).

The ARC-Message-Signature field(s) MUST not include any of the ARC-Seal
header field(s) (from prior ARC sets) in their signing scope in order 
maintain a separation of responsibilities.  When adding an 
ARC-Authentication-Results header field, it
MUST be added before computing the ARC-Message-Signature. When "sealing" the
message, an operator MUST create and attach the ARC-Message-Signature before
the ARC-Seal in order to reference it and embed the ARC-Message-Signature
within the ARC-Seal signature scope.  

Each ARC-Seal is connected to its respective ARC-Message-Signature and
ARC-Authentication-Results through the common value of the "i=" tag. 

### Handling Minor Violations in the ARC Sets

When ordering the ARC header field sets, misordering of header fields MUST be 
resolved as follows: 

* Within each set, header fields are sorted as specified in {{build-hdrs}}; then

* Any remaining order dependencies between sets (e.g., such as different 
hash algorithms) MUST be ordered as follows:

1. (First) By descending order of i=; then
2. (Second) By descending order of t= (from the ARC-Seal header field within the set); then
3. (Finally) By ascending US-ASCII {{RFC1345}} sort order for the entire canonicalized 
  header field set

The intent of specifying this ordering is to allow downstream message handlers to
add their own ARC sets in a deterministic manner and to provide some
resiliance against downstream MTAs which may reorder header fields. 

### Handling Major Violations in the ARC Sets

Gross violations of the ARC protocol definition (e.g., such as duplicated instance numbers 
or missing header fields or header field sets) MUST be terminated by the detecting
system setting 'cv=fail' in the ARC-Seal header. The status of the ARC evaluation 
reported in the corresponding AAR header field MUST be 'unknown'.

Because the violations can not be readily enumerated, the header fields signed by the AS header
field in the case of a major violation MUST be only the matching 'i=' instance headers 
created by the MTA which detected the malformed chain, as if this newest ARC set was the only
set present.

Downstream MTAs SHOULD NOT attempt any analysis on an ARC chain that has been marked 'fail'.

## Key Management and Binding

The public keys for ARC header fields follow the same requirements and semantics as those for
DKIM-Signatures, described in Section 3.6 of {{RFC6376}}. Operators may use
distinct selectors for the ARC header fields at their own discretion.

### Namespace

All ARC-related keys are stored in the same namespace as DKIM keys {{RFC6376}}: 
"_domainkey" specifically by adding the "._domainkey" suffix to the name of the
key (the "selector").  For example, given an ARC-Seal (or ARC-Message-Signature)
field of a "d=" tag value of "example.com" and an "s=" value of "foo.bar", the
DNS query seeking the public key will a query at the name
"foo.bar._domainkey.example.com". 

## Supporting Alternate Signing Algorithms

In the following branch diagrams, each algorithm is represented by an 'A' or 'B'
at each hop to depict the ARC chain that develops over a five hop scenario. 'x' 
represents a hop that does not support that algorithm.

### Introductory Period

Intermediaries MUST be able to validate ARC chains build with either algorithm
but MAY create ARC sets with either (or both) algorithm.

The introductory period should be at least six (6) months.

### Co-Existence Period

Intermediaries MUST be able to validate ARC chains build with either algorithm
and MUST create ARC sets with both algorithms.
Chains ending with either algorithm may be used for the result.

### Deprecation Period

ARC sets built with algorithms that are being deprecated MAY be considered valid
within an ARC chain, however, intermediaries MUST not create additional sets 
with the deprecated algorithm.

The deprecation period should be at least two (2) years.

### Obsolescence Period

ARC sets which are created with obsolete algorithms must be ignored.

# Usage

For a more thorough treatment of the recommended usage of the ARC header fields for 
both intermediaries and end receivers, please consult {{ARC-USAGE}}.

## Participation

Participating in the ARC chain requires both the evaluation of DMARC (and possibly
ARC) authentication information as well as affixing (one or more) ARC sets for a
given ADMD.

Each participating ADMD MUST validate the preceding ARC set as a
part of asserting their own seal. Until the chain is determined to be failed,
and marked with an ARC set bearing the "cv=fail" indication,
each participating ADMD SHOULD apply their own seal.

### ADMDs vs. Trust Boundaries

The inclusion of additional ARC sets is to be done whenever a trust
boundary is crossed, and especially when prior DKIM-Signatures might not survive
the handling being performed such as some mailing lists that modify
the content of messages or some gateway transformations.

Note that trust boundaries might or might not exactly correspond with ADMD
boundaries. Some organizations may have internal trust boundaries within a
single ADMD or have trust boundaries which span more than one ADMD. Because
such boundaries can not be defined in a protocol agnostic fashion, nor can
the varieties of internal architectures be anticipated effectively, the ARC
protocol does not dictate how trust is to be conveyed within the confines of
a particular organization.

For ARC to work, message authentication is checked upon ingress and then
appropriately reflected in the ARC set (and cv verdict) which is affixed upon
egress. Organizations may choose to use ARC sets in order to communicate across
internal boundaries or whatever other methods are appropriate to their
architectures. The essential aspect is that trusted / expected / allowed
modifications to messages within a trust boundary MUST maintain "cv=pass"
in the ARC chain.

## Relationship between DKIM Signatures and ARC Headers

ARC-aware DKIM signers do not DKIM-sign any ARC header fields.

## Validating the ARC Set of Header Fields {#arc-validation}

Determining the validity of a chain of ARC sets is defined above in {{cv-calc}}.
Validation failures MUST be indicated with a "cv=" tag value of 'fail'
when attaching a subsequent ARC-Seal header field.

## ARC Set Validity

### Assessing Chain Validity Violations

There are a wide variety of ways in which the ARC set of header fields can be broken.
Receivers need to be wary of ascribing motive to such breakage although patterns
of common behaviour may provide some basis for adjusting local policy decisions.

This specification is exclusively focused on well-behaved, participating intermediaries
that result in a valid chain of ARC-related header fields. The value of such a well-formed,
valid chain needs to be interpreted with care since malicious content can be
easily introduced by otherwise well-intended senders through machine or account
compromises. All normal content-based analysis still needs to be performed on any
messages bearing a valid chain of ARC header sets.

### Marking and Sealing Invalid Chains

The header fields signed by the AS header field b= value in the case of a major
violation MUST be only the matching 'i=' instance headers created by the MTA
which detected the malformed chain, as if this newest ARC set was the only set
present. (This is the same procedure required for handling major/structural
validity problems.)

### Responding to ARC Validity Violations

If a receiver determines that the ARC chain has failed, the
receiver MAY signal the breakage through the extended SMTP response code 5.7.7 {{RFC3463}} 
"message integrity failure" {{ENHANCED-STATUS}} and corresponding SMTP response code.

### Recording the Results of ARC Evaluation

Receivers MAY add an "arc=[pass|fail|policy]" method annotation into a locally-affixed
Authentication-Results {{RFC7601}} header field along with any salient comment(s).

### Output Data Points from ARC Evaluation

The evaluation of a series of ARC sets results in the following data which MAY be
used to inform local-policy decisions:

* A list of the "d=" domains found in the validated (all) ARC-Seal header fields;
* The "d=" domain found in the most recent (highest instance number) AMS header field
  (since that is the only one necessarily validated)

### Reporting ARC Effects for DMARC Local Policy - Interim

\[\[ Note: Discussion on the IETF DMARC-WG list has indicated some interest in more substantial
reporting for analytic purposes. To support that effort, the following guidance is 
provided only as an interim, minimal data set. A more complete reporting construct
will be specified in a related spec - TBD. (see also the note at {{aar-defn}}) ]]

Receivers SHOULD indicate situations in which ARC evaluation influenced the
results of their local policy determination. DMARC reporting of ARC-informed decisions
is augmented by adding a local_policy comment explanation as follows: 

~~~~~~~~~~
&lt;policy_evaluated>
  &lt;disposition>delivered&lt;/disposition>
  &lt;dkim>fail&lt;/dkim>
  &lt;spf>fail&lt;/spf>
  &lt;reason>
   &lt;type>local_policy&lt;/type>
   &lt;comment>arc=pass ams=d1.example d=d1.example,d2.example&lt;/comment>
  &lt;/reason>
&lt;/policy_evaluated>
~~~~~~~~~~

# Privacy Considerations

The ARC-Seal chain provides a verifiable record of the handlers for a message.
Anonymous remailers will probably not find this to match their operating goals.

# IANA Considerations

This specification adds three new header fields as defined below.

## Authentication-Results Method Registry Update 

This draft adds one item to the IANA "Email Authentication Methods" registry:

* Method : arc

  Defined: {{&SELF}}

  ptype: header

  Property: chain evaluation result

  Value: chain evaluation result status (see {{seal-hdr}})

  Status: active

  Version: 1

## Definitions of the ARC header fields

This specification adds three new header fields to the "Permanent Message Header
Field Registry", as follows:

*  Header field name: ARC-Seal

   Applicable protocol:  mail

   Status:  draft

   Author/Change controller:  IETF

   Specification document(s):  {{&SELF}}

   Related information:  {{RFC6376}}

*  Header field name:  ARC-Message-Signature

   Applicable protocol:  mail

   Status:  draft

   Author/Change controller:  IETF

   Specification document(s):  {{&SELF}}

   Related information: {{RFC6376}}

*  Header field name:  ARC-Authentication-Results

   Applicable protocol:  mail

   Status:  standard

   Author/Change controller:  IETF

   Specification document(s):  {{&SELF}}

   Related information:  {{RFC7601}} 

# Implementation Status {#implstat}

\[\[ Note to the RFC Editor: Please remove this section before 
publication along with the reference to {{RFC6982}}. ]]

This section records the status of known implementations of the protocol
defined by this specification at the time of posting of this Internet-Draft,
and is based on a proposal described in {{RFC6982}}.  The description of
implementations in this section is intended to assist the IETF in its decision
processes in progressing drafts to RFCs.  Please note that the listing of any
individual implementation here does not imply endorsement by the IETF.
Furthermore, no effort has been spent to verify the information presented here
that was supplied by IETF contributors.  This is not intended as, and must not
be construed to be, a catalog of available implementations or their features.
Readers are advised to note that other implementations may exist.

According to {{RFC6982}}, "this will allow reviewers and working groups to
assign due consideration to documents that have the benefit of running code,
which may serve as evidence of valuable experimentation and feedback that have
made the implemented protocols more mature.  It is up to the individual working
groups to use this information as they see fit".

This information is known to be correct as of the third interoperability 
test event which was held on 2016-06-17.

## GMail test reflector and incoming validation

  Organization: Google

  Description: Internal prototype implementation with both debug
    analysis and validating + sealing pass-through function

  Status of Operation: Production - Incoming Validation

  Coverage: Full spec implemented as of {{ARC-DRAFT}}

  Licensing: Proprietary - Internal only

  Implementation Notes: Full functionality was demonstrated during
   the interop testing on 2016-06-17

  In place for reporting usage only as of 2016-11-21 on all GMail flows.

  Rechecked general incoming validation as of 2017-02-24 interop event.

  Contact Info: <arc-discuss@dmarc.org>

## AOL test reflector and internal tagging

  Organization: AOL

  Description: Internal prototype implementation with both debug
    analysis and validating + sealing pass-through function

  Status of Operation: Beta

  Coverage: ARC chain validity status checking is not operational, but
    otherwise this system conforms to {{ARC-DRAFT}}

  Licensing: Proprietary - Internal only

  Implementation Notes: Full functionality with the exception of chain
   validity checking was demonstrated during the interop testing on 2016-06-17

  Available for production mail via selected account whitelisting for test
   validation only.

  Intermittent stability problems discovered at the interop event on 
   2017-02-24. Remediation underway as of the publication of this draft.

  Contact Info: <arc-discuss@dmarc.org>

## dkimpy 

   Organization: dkimpy developers

   Description: Python DKIM package

   Status of Operation: Production

   Coverage: The internal test suite is incomplete, but the command line
   developmental version of validator was demonstrated to interoperate with
   the Google and AOL implementations during the interop on 2016-06-17 and the
   released version passes the tests in {{ARC-TEST}}
   https://github.com/ValiMail/arc_test_suite with both python and python3.

   Licensing: Open/Other (same as dkimpy package)

   Contact Info: https://launchpad.net/dkimpy

## OpenARC

  Organization: TDP/Murray Kucherawy

  Description: Implemention of milter functionality related to the OpenDKIM
    and OpenDMARC packages

  Status of Operation: Beta

  Coverage: Built to support {{ARC-DRAFT}}

  Licensing: Open/Other (same as OpenDKIM and OpenDMARC packages)

  Implementation Notes: The build is FreeBSD oriented and takes some tweaks
    to build on RedHat-based Linux platforms. 

    Initial testing during the
    interop event on 2016-06-17 showed that it can be operational, but the
    documentation regarding configuration settings is unclear and the 
    generated signature values do not validate when compared to the Google,
    AOL or dkimpy implementations.

    Testing during the 2017-02-24 interop event showed that some of the 
    problems have been fixed, but there are still interoperability problems
    when trying to use OpenARC in a "sandwich" configuration around a MLM.

  Contact Info: <arc-discuss@dmarc.org>

## Mailman addition

  Organization: Mailman development team

  Description: Integrated ARC capabilities within the Mailman package

  Status of Operation: Patch submitted 

  Coverage: Unknown

  Licensing: Same as mailman package - GPL

  Implementation Notes: Incomplete at this time

  Contact Info: [https://www.gnu.org/software/mailman/contact.html]

## Copernica/MailerQ web-based validation

  Organization: Copernica

  Description: Web-based validation of ARC-signed messages

  Status of Operation: Beta

  Coverage: Built to support {{ARC-DRAFT}}

  Licensing: On-line usage only 

  Implementation Notes: Released 2016-10-24
  
   Requires full message content to be pasted into a web form found at
   [http://arc.mailerq.com/] (warning - https is not supported).

   An additional instance of an ARC signature can be added if one is 
    willing to paste a private key into an unsecured web form.

   Initial testing shows that results match the other implementations
    listed in this section.

  Contact Info: [https://www.copernica.com/]

## Rspamd 

  Organization: Rspamd community

  Description: ARC signing and verification module

  Status of Operation: Production, though deployment usage is unknown

  Coverage: Built to support {{ARC-DRAFT}}

  Licensing: Open source

  Implementation Notes: Released with version 1.6.0 on 2017-06-12

  Contact Info: [https://rspamd.com/doc/modules/arc.html] and [https://github.com/vstakhov/rspamd]

# Security Considerations {#sec-con}

The Security Considerations of {{RFC6376}} and {{RFC7601}} apply directly to
this specification.

Inclusion of ARC sets in the header of emails may cause problems for some
older or more constrained MTAs if they are unable to accept the greater 
size of the header.

Operators who receive a message bearing N ARC sets has to complete N+1 
DNS queries to evaluate the chain (barring DNS redirection mechanisms which 
can increase the lookups for a given target value).  This has at least two effects:

  1. An attacker can send a message to an ARC partipant with a concocted
sequence of ARC sets bearing the domains of intended victims, and all of them
will be queried by the participant until a failure is discovered.

  2.  DKIM only does one DNS check per signature, while this one can do many.
Absent caching, slow DNS responses can cause SMTP timeouts; this could be
exploited as a DoS attack.

## Message Content Suspicion

Recipients are cautioned to treat messages bearing ARC sets with the
same suspicion that they apply to all other email messages. This includes
appropriate content scanning and other checks for potentially malicious
content. The handlers which are identified within the ARC-Seal chain may be
used to provide input to local policy engines in cases where the sending
system's DKIM-Signature does not validate. 


--- back

# Appendix A - Example Usage (Obsolete but retained for illustrative purposes)

\[\[ Note: The following examples were mocked up early in the definition
process for the spec. They no longer reflect the current definition and
need various updates. ]]

## Example 1: Simple mailing list

### Here’s the message as it exits the Origin:

~~~~~~~~~~
Return-Path: &lt;jqd@d1.example>
Received: from \[10.10.10.131] (w-x-y-z.dsl.static.isp.com \[w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijrvQw
     bv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4Gd3TRJl
     gotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example>
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example>
To: arc@dmarc.org
Subject: Example 1
 
Hey gang,
This is a test message.
--J.
~~~~~~~~~~

### Message is then received at example.org

#### Example 1, Step A: Message forwarded to list members

Processing at example.org:

*       example.org performs authentication checks
*       No previous Auth-Results or ARC-Seal headers are present
*       example.org adds ARC-Auth-Results header
*       example.org adds Received: header
*       example.org adds a ARC-Seal header

Here’s the message as it exits example.org:

~~~~~~~~~~
Return-Path: &lt;jqd@d1.example>
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF1F5
     vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3A+m4bw
     a6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for <arc@example.org>; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=1; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from \[10.10.10.131] (w-x-y-z.dsl.static.isp.com \[w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example>
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example>
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
~~~~~~~~~~

### Example 1: Message received by Recipient

Let’s say that the Recipient is example.com

Processing at example.com:

*       example.com performs usual authentication checks
*       example.com adds Auth-Results: header, Received header
*       Determines that message fails DMARC
*       Checks for ARC-Seal: header; finds one
*       Validates the signature in the ARC-Seal: header, which covers the ARC-Authentication-Results: header
*       example.com can use the ARC-Authentication-Results values or verify the DKIM-Signature from lists.example.org

Here’s what the message looks like at this point:

~~~~~~~~~~
Return-Path: &lt;jqd@d1.example>
Received: from example.org (example.org [208.69.40.157])
    by clothilde.example.com with ESMTP id 
    d200mr22663000ykb.93.1421363207
    for <fmartin@example.com>; Thu, 14 Jan 2015 15:02:40 -0800 (PST)
Authentication-Results: clothilde.example.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@example.org; dmarc=fail; arc=pass
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF
     1F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3
     A+m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for <arc@example.org>; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=1; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from \[10.10.10.131] (w-x-y-z.dsl.static.isp.com \[w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijrvQw
     bv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4Gd3TRJl
     gotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example>
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example>
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
~~~~~~~~~~

## Example 2: Mailing list to forwarded mailbox

### Here’s the message as it exits the Origin:

~~~~~~~~~~
Return-Path: &lt;jqd@d1.example>
Received: from \[10.10.10.131] (w-x-y-z.dsl.static.isp.com \[w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijrvQw
     bv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4Gd3TRJl
     gotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example>
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example>
To: arc@example.org
Subject: Example 1
 
Hey gang,
This is a test message.
--J.
~~~~~~~~~~

### Message is then received at example.org

#### Example 2, Step A: Message forwarded to list members

Processing at example.org:

*       example.org performs authentication checks
*       example.org applies standard DKIM signature
*       No previous Auth-Results or ARC-Seal headers are present
*       example.org adds ARC-Auth-Results header
*       example.org adds usual Received: header
*       example.org adds a ARC-Seal header

Here’s the message as it exits Step A:

~~~~~~~~~~
Return-Path: &lt;jqd@d1.example>
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz6
     1TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L
     69EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF
     1F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3
     A+m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for <arc@example.org>; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=1; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from \[10.10.10.131] (w-x-y-z.dsl.static.isp.com \[w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example>
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example>
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
~~~~~~~~~~

#### Example 2, Step B: Message from list forwarded

The message is delivered to a mailbox at gmail.com  
Processing at gmail.com:

-   gmail.com performs usual authentication checks
-   gmail.com adds Auth-Results: and Received: header
-   Determines that message fails DMARC
-   Checks for ARC-Seal: header; finds one
-   Validates the signature in the ARC-Seal: header, which covers the ARC-Authentication-Results: header
-   Uses the ARC-Auth-Results: values, but:
-   Instead of delivering message, prepares to forward message per user settings
-   Applies usual DKIM signature
-   gmail.com adds it’s own ARC-Seal: header, contents of which are
    -       version
    -       sequence number (“i=2”)
    -       hash algorithm (SHA256 as example)
    -       timestamp (“t=”)
    -       selector for key (“s=notary01”)
    -       domain for key (“d=gmail.com”)
    -       headers included  in hash (“h=ARC-Authentication-Results:ARC-Seal”)
    -       Note: algorithm requires only ARC-Seals with lower sequence # be included, in ascending order
    -       signature of the header hash

Here’s what the message looks like at this point:

~~~~~~~~~~
Return-Path: &lt;jqd@d1.example>
ARC-Seal: i=2; a=rsa-sha256; t=1421363253;
    s=notary01; d=gmail.com; cv=pass; 
    b=sjHDMriRZ0Mui5eVEOGscRHWbQHcy97lvrduHQ8h+f2CfIrxUiKOE44x3LQwDWR
     YbDjf5fcM9MdcIahC+cP59BQ9Y9DHwMDzwRTnM7NVb4kY+tSaVnLoIOaP9lF/sut
     txO+RRNr0fCFw==
ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed;
    d=gmail.com; s=20120806;
    h=mime-version:content-type:x-original-sender:
     x-original-authentication-results:precedence:mailing-list:
     list-id:list-post:list-help:list-archive:sender:reply-to:
     list-unsubscribe:DKIM-Signature;
    bh=2+gZwZhUK2V7JbpoO2MTrU19WvhcA4JnjiohFm9ZZ/g=;
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0Ab8Oi1ebYV/hIBmfhS
     LF1E80hMPcMijONfTQB6g5Hoh/kE6N2fgp6aSngL/WA3+g3Id8ElhXHvIGcJRFeM
     KdJqiW5cxdqPTRW+BnR5ee6Tzg06kr265NTDIAU8p8fQNuLfZj49MMA+QwDBJtXw
     bQoZyRtb6X6q0mYaszUB8kw==
Received: by mail-yk0-f179.google.com with SMTP id 19so2728865ykq.10
    for <mailbox@gmail.com>; Thu, 14 Jan 2015 15:02:45 -0800 (PST)
Authentication-Results: i=2; gmail.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@example.org; dmarc=fail; arc=pass
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=none:
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF
     1F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3
     A+m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for <arc@example.org>; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=1; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from \[10.10.10.131] (w-x-y-z.dsl.static.isp.com \[w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example>
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example>
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
~~~~~~~~~~


 

### Example 2: Message received by Recipient

Let’s say that the Recipient is example.com  
Processing at example.com:

-       example.com performs usual authentication checks
-       example.com adds Auth-Results: header, Received header
-       Determines that message fails DMARC
-       Checks for ARC-Seal: header; finds two
-       Validates the signature in the highest numbered (“i=2”) ARC-Seal: header, which covers all previous ARC-Seal: and ARC-Authentication-Results: headers
-       Validates the other ARC-Seal header (“i=1”), which covers the ARC-Authentication-Results: header
-       example.com uses the ARC-Authentication-Results: values

Here’s what the message looks like at this point:

~~~~~~~~~~
Return-Path: &lt;jqd@d1.example>
Received: from mail-ob0-f188.google.com (mail-ob0-f188.google.com
    [208.69.40.157]) by clothilde.example.com with ESMTP id
    d200mr22663000ykb.93.1421363268
    for <fmartin@example.com>; Thu, 14 Jan 2015 15:03:15 -0800 (PST)
Authentication-Results: clothilde.example.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@gmail.com; dmarc=fail; arc=pass
ARC-Seal: i=2; a=rsa-sha256; t=1421363253;
    s=notary01; d=gmail.com; cv=pass; 
    b=sjHDMriRZ0Mui5eVEOGscRHWbQHcy97lvrduHQ8h+f2CfIrxUiKOE44x3LQwDWR
     YbDjf5fcM9MdcIahC+cP59BQ9Y9DHwMDzwRTnM7NVb4kY+tSaVnLoIOaP9lF/sut
     txO+RRNr0fCFw==
ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed;
    d=gmail.com; s=20120806;
    h=mime-version:content-type:x-original-sender:
     x-original-authentication-results:precedence:mailing-list:
     list-id:list-post:list-help:list-archive:sender:reply-to:
     :list-unsubscribe:DKIM-Signature;
    bh=2+gZwZhUK2V7JbpoO2MTrU19WvhcA4JnjiohFm9ZZ/g=;
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0Ab8Oi1ebYV/hIBmfhS
     LF1E80hMPcMijONfTQB6g5Hoh/kE6N2fgp6aSngL/WA3+g3Id8ElhXHvIGcJRFeM
     KdJqiW5cxdqPTRW+BnR5ee6Tzg06kr265NTDIAU8p8fQNuLfZj49MMA+QwDBJtXw
     bQoZyRtb6X6q0mYaszUB8kw==
Received: by mail-yk0-f179.google.com with SMTP id 19so2728865ykq.10
    for <mailbox@gmail.com>; Thu, 14 Jan 2015 15:02:45 -0800 (PST)
Authentication-Results: i=2; gmail.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@example.org; dmarc=fail; arc=pass
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF
     1F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3
     A+m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for <arc@example.org>; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=1; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from \[10.10.10.131] (w-x-y-z.dsl.static.isp.com \[w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=d1.example;
    s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=Message-ID:Date:From:MIME-Version:To:CC:Subject:Content-Type:
     Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example>
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example>
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
~~~~~~~~~~

## Example 3: Mailing list to forwarded mailbox with source 

### Here’s the message as it exits the Origin:
~~~~~~~~~~
Return-Path: &lt;jqd@d1.example>
Received: from \[10.10.10.131] (w-x-y-z.dsl.static.isp.com \[w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=origin2015; d=d1.example; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61T
     X6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69EU
     8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=d1.example; s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=MIME-Version:CC:Content-Type:Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijrv
     Qwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4Gd3
     TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example>
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example>
To: arc@example.org
Subject: Example 1
 
Hey gang,
This is a test message.
--J.
~~~~~~~~~~

### Message is then received at example.org

 

#### Example 3, Step A: Message forwarded to list members with source

Processing at example.org:

-   example.org performs authentication checks
-   example.org applies standard DKIM signature
-   Checks for ARC-Seal: header; finds one (i=1)
-   Validates the signature in the ARC-Seal (i=1): header, which covers the d1.example ARC-Message-Signature: header
-   example.org adds ARC-Auth-Results header
-   example.org adds usual Received: header
-   example.org adds a DKIM-Signature
-   example.org adds a ARC-Seal header, contents of which are
    -       sequence number (“i=2”)
    -       hash algorithm (SHA256 as example)
    -       timestamp (“t=”)
    -       chain validity ("cv=")
    -       selector for key (“s=seal2015”)
    -       domain for key (“d=example.org”)
    -       signature ("b=")

Here’s the message as it exits Step A:

~~~~~~~~~~
Return-Path: &lt;jqd@d1.example>
ARC-Seal: i=2; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=pass; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz6
     1TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L
     69EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:From:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF
     1F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3
     A+m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for <arc@example.org>; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=2; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from \[10.10.10.131] (w-x-y-z.dsl.static.isp.com \[w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=origin2015; d=d1.example; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=d1.example; s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=MIME-Version:CC:Content-Type:Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example>
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example>
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
~~~~~~~~~~

#### Example 3, Step B: Message from list forwarded with source

The message is delivered to a mailbox at gmail.com  
Processing at gmail.com:

-   gmail.com performs usual authentication checks
-   gmail.com adds Auth-Results: and Received: header
-   Determines that message fails DMARC
-   Checks for ARC-Seal: header; finds two
-   Validates the signature in the ARC-Seal (i=2): header, which covers the ARC-Authentication-Results: header
-   Validates the signature in the ARC-Seal (i=1): header, which covers the d1.example ARC-Message-Signature: header
-   Uses the ARC-Auth-Results: values, but:
-   Instead of delivering message, prepares to forward message per user settings
-   Applies usual DKIM signature
-   gmail.com adds it’s own ARC-Seal: header, contents of which are
    -       version
    -       sequence number (“i=2”)
    -       hash algorithm (SHA256 as example)
    -       timestamp (“t=”)
    -       selector for key (“s=notary01”)
    -       domain for key (“d=gmail.com”)
    -       Note: algorithm requires only ARC-Seals with lower sequence # be included, in ascending order
    -       signature of the chain

Here’s what the message looks like at this point:

~~~~~~~~~~
Return-Path: &lt;jqd@d1.example>
ARC-Seal: i=3; a=rsa-sha256; t=1421363253;
    s=notary01; d=gmail.com; cv=pass; 
    b=sjHDMriRZ0Mui5eVEOGscRHWbQHcy97lvrduHQ8h+f2CfIrxUiKOE44x3LQwD
     WRYbDjf5fcM9MdcIahC+cP59BQ9Y9DHwMDzwRTnM7NVb4kY+tSaVnLoIOaP9lF
     /suttxO+RRNr0fCFw==
ARC-Message-Signature: i=3; a=rsa-sha256; c=relaxed/relaxed;
    d=gmail.com; s=20120806;
    h=mime-version:content-type:x-original-sender
     :x-original-authentication-results:precedence:mailing-list
     :list-id:list-post:list-help:list-archive:sender
     :list-unsubscribe:reply-to;
    bh=2+gZwZhUK2V7JbpoO2MTrU19WvhcA4JnjiohFm9ZZ/g=;
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz6
     1TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L
     69EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0Ab8Oi1ebYV/hIBm
     fhSLF1E80hMPcMijONfTQB6g5Hoh/kE6N2fgp6aSngL/WA3+g3Id8ElhXHvIGcJ
     RFeMKdJqiW5cxdqPTRW+BnR5ee6Tzg06kr265NTDIAU8p8fQNuLfZj49MMA+QwD
     BJtXwbQoZyRtb6X6q0mYaszUB8kw==
Received: by mail-yk0-f179.google.com with SMTP id 19so2728865ykq.10
    for <mailbox@gmail.com>; Thu, 14 Jan 2015 15:02:45 -0800 (PST)
Authentication-Results: i=3; gmail.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@example.org; dmarc=fail; arc=pass
ARC-Seal: i=2; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=pass; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF1
     F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3A+
     m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for <arc@example.org>; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=2; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from \[10.10.10.131] (w-x-y-z.dsl.static.isp.com \[w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=origin2015; d=d1.example; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=d1.example; s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=MIME-Version:CC:Content-Type:Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYij
     rvQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD
     4Gd3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example>
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example>
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
~~~~~~~~~~

### Example 3: Message received by Recipient

Let’s say that the Recipient is example.com  
Processing at example.com:

-       example.com performs usual authentication checks
-       example.com adds Auth-Results: header, Received header
-       Determines that message fails DMARC
-       Checks for ARC-Seal: header; finds three
-       Validates the signature in the highest numbered (“i=2”) ARC-Seal: header, which covers all previous ARC-Seal: and ARC-Authentication-Results: headers
-       Validates the other ARC-Seal header (“i=2”), which covers the ARC-Authentication-Results: header
-       Validates the other ARC-Seal header (“i=1”), which covers the d1.example ARC-Message-Signature: header
-       example.com uses the ARC-Authentication-Results: values

Here’s what the message looks like at this point:

~~~~~~~~~~
Return-Path: &lt;jqd@d1.example>
Received: from mail-ob0-f188.google.com (mail-ob0-f188.google.com
    [208.69.40.157]) by clothilde.example.com with ESMTP id
    d200mr22663000ykb.93.1421363268
    for <fmartin@example.com>; Thu, 14 Jan 2015 15:03:15 -0800 (PST)
Authentication-Results: clothilde.example.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@gmail.com; dmarc=fail; arc=pass
ARC-Seal: i=3; a=rsa-sha256; t=1421363253;
    s=notary01; d=gmail.com; cv=pass; 
    b=sjHDMriRZ0Mui5eVEOGscRHWbQHcy97lvrduHQ8h+f2CfIrxUiKOE44x3LQwDW
     RYbDjf5fcM9MdcIahC+cP59BQ9Y9DHwMDzwRTnM7NVb4kY+tSaVnLoIOaP9lF/s
     uttxO+RRNr0fCFw==
ARC-Message-Signature: i=3; a=rsa-sha256; c=relaxed/relaxed;
    d=gmail.com; s=20120806;
    h=mime-version:content-type:x-original-sender
     :x-original-authentication-results:precedence
     :mailing-list:list-id:list-post:list-help:list-archive:sender
     :list-unsubscribe:reply-to;
    bh=2+gZwZhUK2V7JbpoO2MTrU19WvhcA4JnjiohFm9ZZ/g=;
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz6
     1TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L
     69EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0Ab8Oi1ebYV/hIBm
     fhSLF1E80hMPcMijONfTQB6g5Hoh/kE6N2fgp6aSngL/WA3+g3Id8ElhXHvIGcJ
     RFeMKdJqiW5cxdqPTRW+BnR5ee6Tzg06kr265NTDIAU8p8fQNuLfZj49MMA+QwD
     BJtXwbQoZyRtb6X6q0mYaszUB8kw==
Received: by mail-yk0-f179.google.com with SMTP id 19so2728865ykq.10
    for <mailbox@gmail.com>; Thu, 14 Jan 2015 15:02:45 -0800 (PST)
Authentication-Results: i=3; gmail.com; spf=fail
    smtp.from=jqd@d1.example; dkim=pass (1024-bit key) 
    header.i=@example.org; dmarc=fail; arc=pass
ARC-Seal: i=2; a=rsa-sha256; t=1421363107;
    s=seal2015; d=example.org; cv=pass; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz6
     1TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L
     69EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed;
    d=example.org; s=clochette; t=1421363105;
    bh=FjQYm3HhXStuzauzV4Uc02o55EzATNfL4uBvEoy7k3s=;
    h=List-Id:List-Unsubscribe:List-Archive:List-Post:
     List-Help:List-Subscribe:Reply-To:DKIM-Signature;
    b=Wb4EiVANwAX8obWwrRWpmlhxmdIvj0dv0psIkiaGOOug32iTAcc74/iWvlPXpF1
     F5vYVF0mw5cmKOa824tKkUOOE3yinTAekqnly7GJuFCDeSA1fQHhStVV7BzAr3A+
     m4bwa6RIDgr3rOPJil678dZTHfztFWyjwIUxB5Ajxj/M=
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for <arc@example.org>; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Authentication-Results: i=2; lists.example.org;
    spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (1024-bit key) header.i=@d1.example; 
    dmarc=pass
Received: from \[10.10.10.131] (w-x-y-z.dsl.static.isp.com \[w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
ARC-Seal: i=1; a=rsa-sha256; t=1421363107;
    s=origin2015; d=d1.example; cv=none; 
    b=pCw3Qxgfs9E1qnyNZ+cTTF3KHgAjWwZz++Rju0BceSiuwIg0Pkk+3RZH/kaiz61
     TX6RVT6E4gs49Sstp41K7muj1OR5R6Q6llahLlQJZ/YfDZ3NImCU52gFWLUD7L69
     EU8TzypfkUhscqXjOJgDwjIceBNNOfh3Jy+V8hQZrVFCw0A=
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed;
    d=d1.example; s=20130426; t=1421363082;
    bh=EoJqaaRvhrngQxmQ3VnRIIMRBgecuKf1pdkxtfGyWaU=;
    h=MIME-Version:To:CC:Subject:Content-Type:Content-Transfer-Encoding;
    b=HxsvPubDE+R96v9dM9Y7V3dJUXvajd6rvF5ec5BPe/vpVBRJnD4I2weEIyYijr
     vQwbv9uUA1t94kMN0Q+haFo6hiQPnkuDxku5+oxyZWOqtNH7CTMgcBWWTp4QD4G
     d3TRJlgotsX4RkbNcUhlfnoQ0p+CywWjieI8aR6eof6WDQ=
Message-ID: &lt;54B84785.1060301@d1.example>
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example>
To: arc@example.org
Subject: [Lists] Example 1
 
Hey gang,
This is a test message.
--J.
~~~~~~~~~~

# Acknowledgements

This draft is the work of OAR-Dev Group. 

The authors thank all of the OAR-Dev group for the ongoing help and though-provoking
discussions from all the participants, especially: Alex Brotman, Brandon Long, Dave Crocker, 
Elizabeth Zwicky, Franck Martin, Greg Colburn, J. Trent Adams, John Rae-Grant, Mike Hammer,
Mike Jones, Steve Jones, Terry Zink, Tim Draegen.

Grateful appreciation is extended to the people who provided feedback through the discuss
mailing list.

# Comments and Feedback

Please address all comments, discussions, and questions to <dmarc@ietf.org>. 
Earlier discussions can be found at <arc-discuss@dmarc.org>.


--- fluff

<!--  LocalWords:  received header email DMARC authentication authenticated
-->
<!--  LocalWords:  signature DKIM OAR authentication-results
-->

