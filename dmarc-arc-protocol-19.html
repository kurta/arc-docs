<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Authenticated Received Chain (ARC) Protocol</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents"/>
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction"/>
<link href="#rfc.section.2" rel="Chapter" title="2 General Concepts"/>
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Evidence"/>
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Custody"/>
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Chain of Custody"/>
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Validation of Chain of Custody"/>
<link href="#rfc.section.3" rel="Chapter" title="3 Terminology and Definitions"/>
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 ARC Set"/>
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Authenticated Received Chain (ARC)"/>
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Internet Mail Handlers / Intermediaries"/>
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Authentication Assessment"/>
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Signing vs Sealing"/>
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 Sealer"/>
<link href="#rfc.section.3.7" rel="Chapter" title="3.7 Validator"/>
<link href="#rfc.section.3.8" rel="Chapter" title="3.8 Imported ABNF Tokens"/>
<link href="#rfc.section.3.9" rel="Chapter" title="3.9 Common ABNF Tokens"/>
<link href="#rfc.section.4" rel="Chapter" title="4 Protocol Elements"/>
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 ARC Header Fields"/>
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 ARC-Authentication-Results (AAR)"/>
<link href="#rfc.section.4.1.2" rel="Chapter" title="4.1.2 ARC-Message-Signature (AMS)"/>
<link href="#rfc.section.4.1.3" rel="Chapter" title="4.1.3 ARC-Seal (AS)"/>
<link href="#rfc.section.4.1.4" rel="Chapter" title="4.1.4 Internationalized Email (EAI)"/>
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 ARC Set"/>
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Instance Tags"/>
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Authenticated Received Chain"/>
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Chain Validation Status"/>
<link href="#rfc.section.5" rel="Chapter" title="5 Protocol Actions"/>
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Sealer Actions"/>
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 Header Fields To Include In ARC-Seal Signatures"/>
<link href="#rfc.section.5.1.2" rel="Chapter" title="5.1.2 Marking and Sealing &#x201C;cv=fail&#x201D; (Invalid) Chains"/>
<link href="#rfc.section.5.1.3" rel="Chapter" title="5.1.3 Only One Authenticated Received Chain Per Message"/>
<link href="#rfc.section.5.1.4" rel="Chapter" title="5.1.4 Broad Ability to Seal"/>
<link href="#rfc.section.5.1.5" rel="Chapter" title="5.1.5 Sealing is Always Safe"/>
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Validator Actions"/>
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 All Failures Are Permanent"/>
<link href="#rfc.section.5.2.2" rel="Chapter" title="5.2.2 Responding to ARC Validation Failures During the SMTP Transaction"/>
<link href="#rfc.section.6" rel="Chapter" title="6 Communication of Validation Results"/>
<link href="#rfc.section.7" rel="Chapter" title="7 Use Cases"/>
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Communicate Authentication Assessment Across Trust Boundaries"/>
<link href="#rfc.section.7.1.1" rel="Chapter" title="7.1.1 Message Scanning Services"/>
<link href="#rfc.section.7.1.2" rel="Chapter" title="7.1.2 Multi-tier MTA Processing"/>
<link href="#rfc.section.7.1.3" rel="Chapter" title="7.1.3 Mailing Lists"/>
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Inform Message Disposition Decisions"/>
<link href="#rfc.section.7.2.1" rel="Chapter" title="7.2.1 DMARC Local Policy Overrides"/>
<link href="#rfc.section.7.2.2" rel="Chapter" title="7.2.2 DMARC Reporting"/>
<link href="#rfc.section.8" rel="Chapter" title="8 Privacy Considerations"/>
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations"/>
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Increased Header Field Size"/>
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 DNS Operations"/>
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 Message Content Suspicion"/>
<link href="#rfc.section.9.4" rel="Chapter" title="9.4 Message Sealer Suspicion"/>
<link href="#rfc.section.9.5" rel="Chapter" title="9.5 Replay Attacks"/>
<link href="#rfc.section.10" rel="Chapter" title="10 IANA Considerations"/>
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Email Authentication Results Names Registry Update"/>
<link href="#rfc.section.10.2" rel="Chapter" title="10.2 Email Authentication Methods Registry Update"/>
<link href="#rfc.section.10.3" rel="Chapter" title="10.3 Definitions of the ARC header fields"/>
<link href="#rfc.section.10.4" rel="Chapter" title="10.4 New Enhanced Status Code - ARC Validation"/>
<link href="#rfc.section.11" rel="Chapter" title="11 Experimental Considerations"/>
<link href="#rfc.section.11.1" rel="Chapter" title="11.1 Success Consideration"/>
<link href="#rfc.section.11.2" rel="Chapter" title="11.2 Failure Considerations"/>
<link href="#rfc.section.11.3" rel="Chapter" title="11.3 Open Questions"/>
<link href="#rfc.section.11.3.1" rel="Chapter" title="11.3.1 Value of the ARC-Seal (AS) Header Field"/>
<link href="#rfc.section.11.3.2" rel="Chapter" title="11.3.2 Usage and/or signals from multiple selectors and/or domains in ARC sets"/>
<link href="#rfc.section.11.3.3" rel="Chapter" title="11.3.3 DNS Overhead"/>
<link href="#rfc.section.11.3.4" rel="Chapter" title="11.3.4 What Trace Information is Valuable"/>
<link href="#rfc.section.12" rel="Chapter" title="12 Implementation Status"/>
<link href="#rfc.section.12.1" rel="Chapter" title="12.1 GMail test reflector and incoming validation"/>
<link href="#rfc.section.12.2" rel="Chapter" title="12.2 AOL test reflector and internal tagging"/>
<link href="#rfc.section.12.3" rel="Chapter" title="12.3 dkimpy"/>
<link href="#rfc.section.12.4" rel="Chapter" title="12.4 OpenARC"/>
<link href="#rfc.section.12.5" rel="Chapter" title="12.5 Mailman 3.x patch"/>
<link href="#rfc.section.12.6" rel="Chapter" title="12.6 Copernica/MailerQ web-based validation"/>
<link href="#rfc.section.12.7" rel="Chapter" title="12.7 Rspamd"/>
<link href="#rfc.section.12.8" rel="Chapter" title="12.8 PERL MAIL::DKIM module"/>
<link href="#rfc.section.12.9" rel="Chapter" title="12.9 PERL Mail::Milter::Authentication module"/>
<link href="#rfc.section.12.10" rel="Chapter" title="12.10 Sympa List Manager"/>
<link href="#rfc.section.12.11" rel="Chapter" title="12.11 Oracle Messaging Server"/>
<link href="#rfc.section.12.12" rel="Chapter" title="12.12 MessageSystems Momentum and PowerMTA platforms"/>
<link href="#rfc.section.12.13" rel="Chapter" title="12.13 Exim"/>
<link href="#rfc.section.12.14" rel="Chapter" title="12.14 Halon MTA"/>
<link href="#rfc.section.12.15" rel="Chapter" title="12.15 IIJ"/>
<link href="#rfc.references" rel="Chapter" title="13 References"/>
<link href="#rfc.references.1" rel="Chapter" title="13.1 Normative References"/>
<link href="#rfc.references.2" rel="Chapter" title="13.2 Informative References"/>
<link href="#rfc.appendix.A" rel="Chapter" title="A Appendix A - Design Requirements"/>
<link href="#rfc.appendix.A.1" rel="Chapter" title="A.1 Primary Design Criteria"/>
<link href="#rfc.appendix.A.2" rel="Chapter" title="A.2 Out of Scope"/>
<link href="#rfc.appendix.B" rel="Chapter" title="B Appendix B - Example Usage"/>
<link href="#rfc.appendix.C" rel="Chapter" title="C Acknowledgements"/>
<link href="#rfc.appendix.D" rel="Chapter" title="D Comments and Feedback"/>
<link href="#rfc.authors" rel="Chapter"/>


  <meta name="generator" content="xml2rfc version 2.5.0 - http://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Andersen, K., Long, B., Ed., Blank, S., Ed., and M. Kucherawy, Ed." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-dmarc-arc-protocol-19" />
  <meta name="dct.issued" scheme="ISO8601" content="2018-11-6" />
  <meta name="dct.abstract" content="The Authenticated Received Chain (ARC) protocol provides an authenticated &#8220;chain of custody&#8221; for a message, allowing each entity that handles the message to see what entities handled it before, and to see what the message&#8217;s authentication assessment was at each step in the handling." />
  <meta name="description" content="The Authenticated Received Chain (ARC) protocol provides an authenticated &#8220;chain of custody&#8221; for a message, allowing each entity that handles the message to see what entities handled it before, and to see what the message&#8217;s authentication assessment was at each step in the handling." />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
  <td class="left">DMARC Working Group</td>
  <td class="right">K. Andersen</td>
</tr>
<tr>
  <td class="left">Internet-Draft</td>
  <td class="right">LinkedIn</td>
</tr>
<tr>
  <td class="left">Intended status: Experimental</td>
  <td class="right">B. Long, Ed.</td>
</tr>
<tr>
  <td class="left">Expires: May 10, 2019</td>
  <td class="right">Google</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">S. Blank, Ed.</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">Valimail</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">M. Kucherawy, Ed.</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">TDP</td>
</tr>
<tr>
  <td class="left"></td>
  <td class="right">November 6, 2018</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Authenticated Received Chain (ARC) Protocol<br />
  <span class="filename">draft-ietf-dmarc-arc-protocol-19</span></p>
  
  <h1 id="rfc.abstract">
  <a href="#rfc.abstract">Abstract</a>
</h1>
<p>The Authenticated Received Chain (ARC) protocol provides an authenticated &#8220;chain of custody&#8221; for a message, allowing each entity that handles the message to see what entities handled it before, and to see what the message&#8217;s authentication assessment was at each step in the handling.</p>
<p>ARC allows Internet Mail Handlers to attach assertions of message authentication assessment to individual messages. As messages traverse ARC-enabled Internet Mail Handlers, additional ARC assertions can be attached to messages to form ordered sets of ARC assertions that represent the authentication assessment at each step of message handling paths.</p>
<p>ARC-enabled Internet Mail Handlers can process sets of ARC assertions to inform message disposition decisions, to identify Internet Mail Handlers that might break existing authentication mechanisms, and to convey original authentication assessments across trust boundaries.</p>
<h1 id="rfc.status">
  <a href="#rfc.status">Status of This Memo</a>
</h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 10, 2019.</p>
<h1 id="rfc.copyrightnotice">
  <a href="#rfc.copyrightnotice">Copyright Notice</a>
</h1>
<p>Copyright (c) 2018 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a></li>
<li>2.   <a href="#rfc.section.2">General Concepts</a></li>
<ul><li>2.1.   <a href="#rfc.section.2.1">Evidence</a></li>
<li>2.2.   <a href="#rfc.section.2.2">Custody</a></li>
<li>2.3.   <a href="#rfc.section.2.3">Chain of Custody</a></li>
<li>2.4.   <a href="#rfc.section.2.4">Validation of Chain of Custody</a></li>
</ul><li>3.   <a href="#rfc.section.3">Terminology and Definitions</a></li>
<ul><li>3.1.   <a href="#rfc.section.3.1">ARC Set</a></li>
<li>3.2.   <a href="#rfc.section.3.2">Authenticated Received Chain (ARC)</a></li>
<li>3.3.   <a href="#rfc.section.3.3">Internet Mail Handlers / Intermediaries</a></li>
<li>3.4.   <a href="#rfc.section.3.4">Authentication Assessment</a></li>
<li>3.5.   <a href="#rfc.section.3.5">Signing vs Sealing</a></li>
<li>3.6.   <a href="#rfc.section.3.6">Sealer</a></li>
<li>3.7.   <a href="#rfc.section.3.7">Validator</a></li>
<li>3.8.   <a href="#rfc.section.3.8">Imported ABNF Tokens</a></li>
<li>3.9.   <a href="#rfc.section.3.9">Common ABNF Tokens</a></li>
</ul><li>4.   <a href="#rfc.section.4">Protocol Elements</a></li>
<ul><li>4.1.   <a href="#rfc.section.4.1">ARC Header Fields</a></li>
<ul><li>4.1.1.   <a href="#rfc.section.4.1.1">ARC-Authentication-Results (AAR)</a></li>
<li>4.1.2.   <a href="#rfc.section.4.1.2">ARC-Message-Signature (AMS)</a></li>
<li>4.1.3.   <a href="#rfc.section.4.1.3">ARC-Seal (AS)</a></li>
<li>4.1.4.   <a href="#rfc.section.4.1.4">Internationalized Email (EAI)</a></li>
</ul><li>4.2.   <a href="#rfc.section.4.2">ARC Set</a></li>
<ul><li>4.2.1.   <a href="#rfc.section.4.2.1">Instance Tags</a></li>
</ul><li>4.3.   <a href="#rfc.section.4.3">Authenticated Received Chain</a></li>
<li>4.4.   <a href="#rfc.section.4.4">Chain Validation Status</a></li>
</ul><li>5.   <a href="#rfc.section.5">Protocol Actions</a></li>
<ul><li>5.1.   <a href="#rfc.section.5.1">Sealer Actions</a></li>
<ul><li>5.1.1.   <a href="#rfc.section.5.1.1">Header Fields To Include In ARC-Seal Signatures</a></li>
<li>5.1.2.   <a href="#rfc.section.5.1.2">Marking and Sealing &#8220;cv=fail&#8221; (Invalid) Chains</a></li>
<li>5.1.3.   <a href="#rfc.section.5.1.3">Only One Authenticated Received Chain Per Message</a></li>
<li>5.1.4.   <a href="#rfc.section.5.1.4">Broad Ability to Seal</a></li>
<li>5.1.5.   <a href="#rfc.section.5.1.5">Sealing is Always Safe</a></li>
</ul><li>5.2.   <a href="#rfc.section.5.2">Validator Actions</a></li>
<ul><li>5.2.1.   <a href="#rfc.section.5.2.1">All Failures Are Permanent</a></li>
<li>5.2.2.   <a href="#rfc.section.5.2.2">Responding to ARC Validation Failures During the SMTP Transaction</a></li>
</ul></ul><li>6.   <a href="#rfc.section.6">Communication of Validation Results</a></li>
<li>7.   <a href="#rfc.section.7">Use Cases</a></li>
<ul><li>7.1.   <a href="#rfc.section.7.1">Communicate Authentication Assessment Across Trust Boundaries</a></li>
<ul><li>7.1.1.   <a href="#rfc.section.7.1.1">Message Scanning Services</a></li>
<li>7.1.2.   <a href="#rfc.section.7.1.2">Multi-tier MTA Processing</a></li>
<li>7.1.3.   <a href="#rfc.section.7.1.3">Mailing Lists</a></li>
</ul><li>7.2.   <a href="#rfc.section.7.2">Inform Message Disposition Decisions</a></li>
<ul><li>7.2.1.   <a href="#rfc.section.7.2.1">DMARC Local Policy Overrides</a></li>
<li>7.2.2.   <a href="#rfc.section.7.2.2">DMARC Reporting</a></li>
</ul></ul><li>8.   <a href="#rfc.section.8">Privacy Considerations</a></li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a></li>
<ul><li>9.1.   <a href="#rfc.section.9.1">Increased Header Field Size</a></li>
<li>9.2.   <a href="#rfc.section.9.2">DNS Operations</a></li>
<li>9.3.   <a href="#rfc.section.9.3">Message Content Suspicion</a></li>
<li>9.4.   <a href="#rfc.section.9.4">Message Sealer Suspicion</a></li>
<li>9.5.   <a href="#rfc.section.9.5">Replay Attacks</a></li>
</ul><li>10.   <a href="#rfc.section.10">IANA Considerations</a></li>
<ul><li>10.1.   <a href="#rfc.section.10.1">Email Authentication Results Names Registry Update</a></li>
<li>10.2.   <a href="#rfc.section.10.2">Email Authentication Methods Registry Update</a></li>
<li>10.3.   <a href="#rfc.section.10.3">Definitions of the ARC header fields</a></li>
<li>10.4.   <a href="#rfc.section.10.4">New Enhanced Status Code - ARC Validation</a></li>
</ul><li>11.   <a href="#rfc.section.11">Experimental Considerations</a></li>
<ul><li>11.1.   <a href="#rfc.section.11.1">Success Consideration</a></li>
<li>11.2.   <a href="#rfc.section.11.2">Failure Considerations</a></li>
<li>11.3.   <a href="#rfc.section.11.3">Open Questions</a></li>
<ul><li>11.3.1.   <a href="#rfc.section.11.3.1">Value of the ARC-Seal (AS) Header Field</a></li>
<li>11.3.2.   <a href="#rfc.section.11.3.2">Usage and/or signals from multiple selectors and/or domains in ARC sets</a></li>
<li>11.3.3.   <a href="#rfc.section.11.3.3">DNS Overhead</a></li>
<li>11.3.4.   <a href="#rfc.section.11.3.4">What Trace Information is Valuable</a></li>
</ul></ul><li>12.   <a href="#rfc.section.12">Implementation Status</a></li>
<ul><li>12.1.   <a href="#rfc.section.12.1">GMail test reflector and incoming validation</a></li>
<li>12.2.   <a href="#rfc.section.12.2">AOL test reflector and internal tagging</a></li>
<li>12.3.   <a href="#rfc.section.12.3">dkimpy</a></li>
<li>12.4.   <a href="#rfc.section.12.4">OpenARC</a></li>
<li>12.5.   <a href="#rfc.section.12.5">Mailman 3.x patch</a></li>
<li>12.6.   <a href="#rfc.section.12.6">Copernica/MailerQ web-based validation</a></li>
<li>12.7.   <a href="#rfc.section.12.7">Rspamd</a></li>
<li>12.8.   <a href="#rfc.section.12.8">PERL MAIL::DKIM module</a></li>
<li>12.9.   <a href="#rfc.section.12.9">PERL Mail::Milter::Authentication module</a></li>
<li>12.10.   <a href="#rfc.section.12.10">Sympa List Manager</a></li>
<li>12.11.   <a href="#rfc.section.12.11">Oracle Messaging Server</a></li>
<li>12.12.   <a href="#rfc.section.12.12">MessageSystems Momentum and PowerMTA platforms</a></li>
<li>12.13.   <a href="#rfc.section.12.13">Exim</a></li>
<li>12.14.   <a href="#rfc.section.12.14">Halon MTA</a></li>
<li>12.15.   <a href="#rfc.section.12.15">IIJ</a></li>
</ul><li>13.   <a href="#rfc.references">References</a></li>
<ul><li>13.1.   <a href="#rfc.references.1">Normative References</a></li>
<li>13.2.   <a href="#rfc.references.2">Informative References</a></li>
</ul><li>Appendix A.   <a href="#rfc.appendix.A">Appendix A - Design Requirements</a></li>
<ul><li>A.1.   <a href="#rfc.appendix.A.1">Primary Design Criteria</a></li>
<li>A.2.   <a href="#rfc.appendix.A.2">Out of Scope</a></li>
</ul><li>Appendix B.   <a href="#rfc.appendix.B">Appendix B - Example Usage</a></li>
<li>Appendix C.   <a href="#rfc.appendix.C">Acknowledgements</a></li>
<li>Appendix D.   <a href="#rfc.appendix.D">Comments and Feedback</a></li>
<li><a href="#rfc.authors">Authors' Addresses</a></li>


  </ul>

  <h1 id="rfc.section.1"><a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a></h1>
<p id="rfc.section.1.p.1">The utility of widely deployed email authentication technologies such as Sender Policy Framework (SPF) <a href="#RFC7208">[RFC7208]</a> and DomainKeys Identified Mail (DKIM) <a href="#RFC6376">[RFC6376]</a> is impacted by the processing of Internet Mail by intermediate handlers. This impact is thoroughly documented in the defining documents for SPF and DKIM and further discussed in <a href="#RFC6377">[RFC6377]</a> and <a href="#RFC7960">[RFC7960]</a>.</p>
<p id="rfc.section.1.p.2">DMARC <a href="#RFC7489">[RFC7489]</a> also relies upon SPF and DKIM authentication mechanisms.  Failures of authentication caused by the actions of intermediate handlers can cause legitimate mail to be incorrectly rejected or misdirected.</p>
<p id="rfc.section.1.p.3">Authenticated Received Chain (ARC) creates a mechanism for individual Internet Mail Handlers to add their authentication assessment to a message&#8217;s ordered set of handling results. ARC encapsulates the authentication assessment in a DKIM signature derivative to grant other handlers the ability to verify the authenticity of the individual assessment assertion as well as the aggregate set and sequence of results.</p>
<p id="rfc.section.1.p.4">Ordered sets of authentication assessments can be used by ARC-enabled Internet Mail Handlers to inform message handling disposition, to identify where alteration of message content might have occurred, and to provide additional trace information for use in understanding message handling paths.</p>
<h1 id="rfc.section.2"><a href="#rfc.section.2">2.</a> <a href="#general-concepts" id="general-concepts">General Concepts</a></h1>
<p id="rfc.section.2.p.1">ARC is loosely based on concepts from evidence collection. Evidence is usually collected, labeled, stored, and transported in specific ways to preserve the state of evidence and to document all processing steps.</p>
<h1 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1.</a> <a href="#evidence" id="evidence">Evidence</a></h1>
<p id="rfc.section.2.1.p.1">In ARC&#8217;s situation, the &#8220;evidence&#8221; is a message&#8217;s authentication assessment at any point along the delivery path between origination and final delivery.  Determination of message authentication can be affected when intermediate handlers modify message content (header fields and/or body content), route messages through unforeseen paths, or change envelope information.</p>
<p id="rfc.section.2.1.p.2">The authentication assessment for a message is determined upon receipt of a message and documented in the Authentication-Results header field(s). ARC extends this mechanism to survive transit through intermediary ADMDs.</p>
<p id="rfc.section.2.1.p.3">Because the first-hand determination of an authentication assessment can never be reproduced by other handlers, the assertion of the authentication assessment is more akin to testimony by a verifiable party than hard evidence which can be independently evaluated.</p>
<h1 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2.</a> <a href="#custody" id="custody">Custody</a></h1>
<p id="rfc.section.2.2.p.1">&#8220;Custody&#8221; refers to when an Internet Mail Handler processes a message. When a handler takes custody of a message, the handler becomes a custodian and attaches their own evidence (authentication assessment upon receipt) to the message if they are ARC-enabled. Evidence is added in such a way so that future handlers can verify the authenticity of both evidence and custody.</p>
<h1 id="rfc.section.2.3"><a href="#rfc.section.2.3">2.3.</a> <a href="#chain-of-custody" id="chain-of-custody">Chain of Custody</a></h1>
<p id="rfc.section.2.3.p.1">The &#8220;chain of custody&#8221; of ARC is the entire set of evidence and custody that travels with a message.</p>
<h1 id="rfc.section.2.4"><a href="#rfc.section.2.4">2.4.</a> <a href="#validation-of-chain-of-custody" id="validation-of-chain-of-custody">Validation of Chain of Custody</a></h1>
<p id="rfc.section.2.4.p.1">Any ARC-enabled Internet Mail Handler can validate the entire set of custody and the authentication assessments asserted by each party to yield a valid Chain of Custody. If the evidence-supplying custodians can be trusted, then the validated Chain of Custody describes the (possibly changing) authentication assessment as the message traveled through various custodians.</p>
<p id="rfc.section.2.4.p.2">Even though a message&#8217;s authentication assessment might have changed, the validated chain of custody can be used to determine if the changes (and the custodians responsible for the changes) can be tolerated.</p>
<h1 id="rfc.section.3"><a href="#rfc.section.3">3.</a> <a href="#terminology-and-definitions" id="terminology-and-definitions">Terminology and Definitions</a></h1>
<p id="rfc.section.3.p.1">This section defines terms used in the rest of the document.</p>
<p id="rfc.section.3.p.2">Readers should to be familiar with the contents, core concepts, and definitions found in <a href="#RFC5598">[RFC5598]</a>. The potential roles of transit services in the delivery of email are directly relevant.</p>
<p id="rfc.section.3.p.3">Language, syntax (including some ABNF constructs), and concepts are imported from DKIM <a href="#RFC6376">[RFC6376]</a>. Specific references to DKIM are made throughout this document.  The following terms are imported from <a href="#RFC5598">[RFC5598]</a>:</p>
<p/>

<ul>
  <li>ADministrative Management Domain (ADMD), Section 2.3</li>
  <li>Message Transfer Agents (MTA), Section 4.3.2</li>
  <li>Message Submission Agent (MSA), Section 4.3.1</li>
  <li>Message Delivery Agent (MDA), Section 4.3.3</li>
</ul>
<p id="rfc.section.3.p.5">Syntax descriptions use Augmented BNF (ABNF) <a href="#RFC5234">[RFC5234]</a> and <a href="#RFC7405">[RFC7405]</a>.</p>
<p id="rfc.section.3.p.6">The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;NOT RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in BCP&#160;14 <a href="#RFC2119">[RFC2119]</a> <a href="#RFC8174">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.  These words may also appear in this document in lower case as plain English words, absent their normative meanings.</p>
<h1 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1.</a> <a href="#arc-set-defn" id="arc-set-defn">ARC Set</a></h1>
<p><a href="#hdr-defn">Section 4.1</a> introduces three (3) ARC header fields which are added to a message by an ARC-enabled internet mail handler. Together, these three header fields compose a single &#8220;ARC Set&#8221;. An ARC Set provides the means for an Internet Mail Handler to attach an authentication assessment to a message in a manner that can be verified by future handlers. A single message can contain multiple ARC Sets.</p>
<p id="rfc.section.3.1.p.2">In general concept terms, an ARC Set represents Evidence and Custody.</p>
<h1 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2.</a> <a href="#arc-chain-defn" id="arc-chain-defn">Authenticated Received Chain (ARC)</a></h1>
<p id="rfc.section.3.2.p.1">The sequence of ARC Sets attached to a message at a given time is called the Authenticated Received Chain. An Authenticated Received Chain is the record of individual authentication assessments as a message traverses through ARC-participating ADMDs.</p>
<p id="rfc.section.3.2.p.2">The first attachment of an ARC Set to a message causes an Authenticated Received Chain to be created. Additional attachments of ARC Sets cause the Authenticated Received Chain to be extended.</p>
<p id="rfc.section.3.2.p.3">In General concept terms, an Authenticated Received Chain represents Chain of Custody.</p>
<h1 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3.</a> <a href="#internet-mail-handlers-intermediaries" id="internet-mail-handlers-intermediaries">Internet Mail Handlers / Intermediaries</a></h1>
<p id="rfc.section.3.3.p.1">Internet Mail Handlers process and deliver messages across the Internet and include MSAs, MTAs, MDAs, gateways, and mailing lists as defined in <a href="#RFC5598">[RFC5598]</a>.</p>
<p id="rfc.section.3.3.p.2">Throughout this document the term &#8220;intermediaries&#8221; refers to the both regular MTAs as well as delivery/reposting agents such as mailing lists covered within the scope of <a href="#RFC5598">[RFC5598]</a>&#8217;s transit services.</p>
<p id="rfc.section.3.3.p.3">&#8220;Intermediaries&#8221; and &#8220;Internet Mail Handlers&#8221; are used synonymously throughout this document.</p>
<h1 id="rfc.section.3.4"><a href="#rfc.section.3.4">3.4.</a> <a href="#authentication-assessment" id="authentication-assessment">Authentication Assessment</a></h1>
<p id="rfc.section.3.4.p.1">The Authentication Assessment which is affixed to a message as part of each ARC Set consists of the &#8220;authres-payload&#8221; <a href="#I-D-7601bis">[I-D-7601bis]</a>. For the integrity of an ARC Set, the Authentication Assessment only needs to be properly encapsulated within the ARC Set as defined below <a href="#hdr-defn">Section 4.1</a>. The accuracy or syntax of the authres-payload field does not affect the validity of the ARC chain itself.</p>
<h1 id="rfc.section.3.5"><a href="#rfc.section.3.5">3.5.</a> <a href="#sign_v_seal" id="sign_v_seal">Signing vs Sealing</a></h1>
<p id="rfc.section.3.5.p.1">Signing is the process of affixing a digital signature to a message as a header field, such as when a DKIM-Signature (as in <a href="#RFC6376">[RFC6376]</a> section 2.1), or an AMS or AS is added. Sealing is when an ADMD affixes a complete and valid ARC Set to a message creating or continuing an Authenticated Received Chain.</p>
<h1 id="rfc.section.3.6"><a href="#rfc.section.3.6">3.6.</a> <a href="#sealer" id="sealer">Sealer</a></h1>
<p id="rfc.section.3.6.p.1">A Sealer is an Internet Mail Handler that attaches a complete and valid ARC Set to a message.</p>
<p id="rfc.section.3.6.p.2">In general concept terms, a Sealer adds its testimony (assertion of authentication assessment) and proof of custody to the Chain of Custody.</p>
<h1 id="rfc.section.3.7"><a href="#rfc.section.3.7">3.7.</a> <a href="#validator" id="validator">Validator</a></h1>
<p id="rfc.section.3.7.p.1">A Validator is an ARC-enabled Internet Mail Handler that evaluates an Authenticated Received Chain for validity and content. The process of evaluation of the individual ARC Sets that compose an Authenticated Received Chain is described in <a href="#validate-actions">Section 5.2</a>.</p>
<p id="rfc.section.3.7.p.2">In general concept terms, a Validator inspects the Chain of Custody to determine the content and validity of individual Evidence supplied by custodians.</p>
<h1 id="rfc.section.3.8"><a href="#rfc.section.3.8">3.8.</a> <a href="#imported-abnf-tokens" id="imported-abnf-tokens">Imported ABNF Tokens</a></h1>
<p id="rfc.section.3.8.p.1">The following ABNF tokens are imported:</p>
<p/>

<ul>
  <li>tag-list (<a href="#RFC6376">[RFC6376]</a> section 3.2)</li>
  <li>authres-payload (<a href="#I-D-7601bis">[I-D-7601bis]</a> section 2.2)</li>
  <li>cfws (<a href="#RFC5322">[RFC5322]</a> section 3.2.2)</li>
</ul>
<h1 id="rfc.section.3.9"><a href="#rfc.section.3.9">3.9.</a> <a href="#common-abnf-tokens" id="common-abnf-tokens">Common ABNF Tokens</a></h1>
<p id="rfc.section.3.9.p.1">The following ABNF tokens are used elsewhere in this document:</p>
<pre>
position     = 1*2DIGIT                         ; 1 - 50
instance     = [CFWS] %s"i" [CFWS] "=" 
               [CFWS] position 
chain-status = ("none" / "fail" / "pass")
seal-cv-tag  = %s"cv" [CFWS] "=" 
               [CFWS] chain-status
</pre>
<h1 id="rfc.section.4"><a href="#rfc.section.4">4.</a> <a href="#protocol-elements" id="protocol-elements">Protocol Elements</a></h1>
<h1 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1.</a> <a href="#hdr-defn" id="hdr-defn">ARC Header Fields</a></h1>
<p id="rfc.section.4.1.p.1">ARC introduces three new header fields. Syntax for new header fields adapts existing specifications. This document only describes where ARC-specific changes in syntax and semantics differ from existing specifications.</p>
<h1 id="rfc.section.4.1.1"><a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#aar-defn" id="aar-defn">ARC-Authentication-Results (AAR)</a></h1>
<p id="rfc.section.4.1.1.p.1">The ARC-Authentication-Results (AAR) header field records the message authentication assessment as processed by an ARC-participating ADMD at message arrival time.</p>
<p id="rfc.section.4.1.1.p.2">In general concept terms, the AAR header field is where Evidence is recorded by a custodian.</p>
<p id="rfc.section.4.1.1.p.3">The AAR header field is similar in syntax and semantics to an Authentication-Results field <a href="#I-D-7601bis">[I-D-7601bis]</a>, with two (2) differences:</p>
<p/>

<ul>
  <li>the name of the header field itself;</li>
  <li>the presence of the &#8220;instance tag&#8221;. Additional information on the &#8220;instance tag&#8221; can be found in <a href="#i-defn">Section 4.2.1</a>.</li>
</ul>
<p id="rfc.section.4.1.1.p.5">The formal ABNF for the AAR header field is:</p>
<pre>
arc-info = instance [CFWS] ";" authres-payload
arc-authres-header = "ARC-Authentication-Results:" [CFWS] arc-info
</pre>
<p id="rfc.section.4.1.1.p.6">Because there is only one AAR allowed per ARC set, the AAR MUST contain the combined authres-payload with all of the authentication results from within the participating ADMD, regardless of how many Authentication-Results header fields are attached to the message.</p>
<h1 id="rfc.section.4.1.2"><a href="#rfc.section.4.1.2">4.1.2.</a> <a href="#ams-defn" id="ams-defn">ARC-Message-Signature (AMS)</a></h1>
<p id="rfc.section.4.1.2.p.1">The ARC-Message-Signature (AMS) header field allows an ARC-participating ADMD to convey some responsibility (custodianship) for a message and possible message modifications to future ARC-participating custodians.</p>
<p id="rfc.section.4.1.2.p.2">In general concept terms, the AMS header field identifies a custodian.</p>
<p id="rfc.section.4.1.2.p.3">The AMS header field has the same syntax and semantics as the DKIM-Signature field <a href="#RFC6376">[RFC6376]</a>, with three (3) differences:</p>
<p/>

<ul>
  <li>the name of the header field itself;</li>
  <li>no version tag (&#8220;v&#8221;) is defined for the AMS header field. As required for undefined tags (in <a href="#RFC6376">[RFC6376]</a>), if seen, a version tag MUST be ignored;</li>
  <li>the &#8220;i&#8221; (AUID) tag is not imported from DKIM; instead, this tag is replaced by the &#8220;instance tag&#8221; as defined in <a href="#i-defn">Section 4.2.1</a>;</li>
</ul>
<p id="rfc.section.4.1.2.p.5">ARC places no requirements on the selectors and/or domains used for the AMS header field signatures.</p>
<p id="rfc.section.4.1.2.p.6">The formal ABNF for the AMS header field is:</p>
<pre>
arc-ams-info = instance [CFWS] ";" tag-list
arc-message-signature = "ARC-Message-Signature:" [CFWS] arc-ams-info
</pre>
<p id="rfc.section.4.1.2.p.7">To reduce the chances of accidental invalidation of AMS signatures:</p>
<p/>

<ul>
  <li>AMS header fields are added by ARC-participating ADMDs as messages exit the ADMD. AMS header fields SHOULD be attached so that any modifications made by the ADMD are included in the signature of the AMS header field.</li>
  <li>Authentication-Results header fields MUST NOT be included in AMS signatures as they are likely to be deleted by downstream ADMDs (per <a href="#I-D-7601bis">[I-D-7601bis]</a> Section 5).</li>
  <li>ARC-related header fields (ARC-Authentication-Results, ARC-Message-Signature, ARC-Seal) MUST NOT be included in the list of header fields covered by the signature of the AMS header field.</li>
</ul>
<p id="rfc.section.4.1.2.p.9">To preserve the ability to verify the integrity of a message, the signature of the AMS header field SHOULD include any DKIM-Signature header fields already present in the message.</p>
<h1 id="rfc.section.4.1.3"><a href="#rfc.section.4.1.3">4.1.3.</a> <a href="#as-defn" id="as-defn">ARC-Seal (AS)</a></h1>
<p id="rfc.section.4.1.3.p.1">The ARC-Seal (AS) header field permits ARC-participating ADMDs to verify the integrity of AAR header fields and corresponding AMS header fields.</p>
<p id="rfc.section.4.1.3.p.2">In general concept terms, the AS header field is how custodians bind their authentication assessments (testimonial) into a Chain of Custody so that Validators can inspect individual evidence and custodians.</p>
<p id="rfc.section.4.1.3.p.3">The AS header field is similar in syntax and semantics to DKIM-Signatures <a href="#RFC6376">[RFC6376]</a>, with the following differences:</p>
<p/>

<ul>
  <li>the &#8220;i&#8221; (AUID) tag is not imported from DKIM; instead, this tag is replaced by the &#8220;instance tag&#8221; as defined in <a href="#i-defn">Section 4.2.1</a>;</li>
  <li>the signature of the AS header field does not cover the body of the message and therefore there is no &#8216;bh&#8217; tag. The signature of the AS header field only covers specific header fields as defined in <a href="#as-hdrs">Section 5.1.1</a>;</li>
  <li>no body canonicalization is performed as the AS signature does not cover the body of a message;</li>
  <li>only &#8220;relaxed&#8221; header field canonicalization (<a href="#RFC6376">[RFC6376]</a> section 3.4.2) is used;</li>
  <li>the only supported tags are &#8220;i&#8221; (from <a href="#i-defn">Section 4.2.1</a> of this document), and &#8220;a&#8221;, &#8220;b&#8221;, &#8220;d, &#8220;s&#8221;, &#8220;t&#8221; from <a href="#RFC6376">[RFC6376]</a> Section 3.5. Note especially that the DKIM &#8220;h&#8221; tag is NOT allowed and if found, MUST result in a cv status of &#8220;fail&#8221; (for more information see <a href="#as-hdrs">Section 5.1.1</a>);</li>
  <li>an additional tag, &#8220;cv&#8221; (&#8220;seal-cv-tag&#8221; in the ARC-Seal ABNF definition) is used to communicate Chain Validation Status to subsequent ADMDs.</li>
</ul>
<p id="rfc.section.4.1.3.p.5">ARC places no requirements on the selectors and/or domains used for the AS header field signatures.</p>
<p id="rfc.section.4.1.3.p.6">The formal ABNF for the AS header field is:</p>
<pre>
arc-as-info = instance [CFWS] ";" tag-list
arc-seal = "ARC-Seal:" [CFWS] arc-as-info
</pre>
<h1 id="rfc.section.4.1.4"><a href="#rfc.section.4.1.4">4.1.4.</a> <a href="#internationalized-email-eai" id="internationalized-email-eai">Internationalized Email (EAI)</a></h1>
<p id="rfc.section.4.1.4.p.1">In internationalized messages <a href="#RFC6532">[RFC6532]</a> many header fields can contain UTF-8 as well as ASCII text.  The changes for EAI are all inherited from DKIM as updated by <a href="#draft-levine-eaiauth">[draft-levine-eaiauth]</a> and Authentication-Results as updated in <a href="#I-D-7601bis">[I-D-7601bis]</a>, but are called out here for emphasis.</p>
<p id="rfc.section.4.1.4.p.2">In all ARC header fields, the d= s= tags can contain U-labels.  In all tags, non-ASCII characters need not be quoted in dkim-quoted-printable.</p>
<p id="rfc.section.4.1.4.p.3">The AAR header allows UTF-8 in the same places that A-R does, as described in <a href="#I-D-7601bis">[I-D-7601bis]</a>.</p>
<h1 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2.</a> <a href="#arc-set" id="arc-set">ARC Set</a></h1>
<p id="rfc.section.4.2.p.1">An &#8220;ARC Set&#8221; is a single collection of three ARC header fields (AAR, AMS, and AS).  ARC header fields of an ARC Set share the same &#8220;instance&#8221; value.</p>
<p id="rfc.section.4.2.p.2">By adding all ARC header fields to a message, an ARC Sealer adds an ARC Set to a message. A description of how Sealers add an ARC Set to a message is found in <a href="#sealer-actions">Section 5.1</a>.</p>
<h1 id="rfc.section.4.2.1"><a href="#rfc.section.4.2.1">4.2.1.</a> <a href="#i-defn" id="i-defn">Instance Tags</a></h1>
<p id="rfc.section.4.2.1.p.1">Instance tags describe which ARC header fields belong to an ARC Set. Each ARC header field of an ARC Set shares the same instance tag value.</p>
<p id="rfc.section.4.2.1.p.2">Instance tag values are integers that begin at 1 and are incremented by each addition of an ARC Set. Through the incremental values of instance tags, an ARC Validator can determine the order in which ARC Sets were added to a message.</p>
<p id="rfc.section.4.2.1.p.3">Instance tag values can range from 1-50 (inclusive).</p>
<p><em>INFORMATIONAL:</em> The upper limit of 50 was picked based on some initial observations reported by early working group members. The value was chosen so as to balance the risk of excessive header field growth <a href="#big-hf-risk">Section 9.1</a> against expert opinion regarding the probability of long-tail but non-looping multiple-intermediary mail flows.  Longer ARC chains will also impose load on validators and DNS to support additional verification steps.  Observed quantities of &#8220;Received&#8221; header fields was also considered in establishing this as an experimental initial value.</p>
<p id="rfc.section.4.2.1.p.5">Valid ARC Sets MUST have exactly one instance of each ARC header field (AAR, AMS, and AS) for a given instance value and signing algorithm.</p>
<p id="rfc.section.4.2.1.p.6">For handling multiple signing algorithms, see <a href="#ARC-MULTI">[ARC-MULTI]</a>.</p>
<h1 id="rfc.section.4.3"><a href="#rfc.section.4.3">4.3.</a> <a href="#authenticated-received-chain" id="authenticated-received-chain">Authenticated Received Chain</a></h1>
<p id="rfc.section.4.3.p.1">An Authenticated Received Chain is an ordered collection of ARC Sets. As ARC Sets are enumerated sets of ARC header fields, an Authenticated Received Chain represents the output of message authentication assessments along the handling path of ARC-enabled processors.</p>
<p id="rfc.section.4.3.p.2">Authentication Assessments determined at each step of the ARC-enabled handling path is present in an Authenticated Received Chain in the form of AAR header fields. The ability to verify the identity of message handlers and the integrity of message content is provided by AMS header fields. AS header fields allow messages handlers to validate the assertions, order and sequence of the Authenticated Received Chain itself.</p>
<p id="rfc.section.4.3.p.3">In general concept terms, an Authenticated Received Chain represents a message&#8217;s Chain of Custody. Validators can consult a message&#8217;s Chain of Custody to gain insight regarding each custodian of a message and the Evidence collected by each custodian.</p>
<h1 id="rfc.section.4.4"><a href="#rfc.section.4.4">4.4.</a> <a href="#cv-defn" id="cv-defn">Chain Validation Status</a></h1>
<p id="rfc.section.4.4.p.1">The state of the Authenticated Received Chain at a specific processing step is called the &#8220;Chain Validation Status&#8221;. Chain Validation Status information is communicated in several ways:</p>
<p/>

<ul>
  <li>the AS header field in the &#8220;cv&#8221; tag, and</li>
  <li>as part of Authentication-Results and AAR header field(s).</li>
</ul>
<p id="rfc.section.4.4.p.3">Chain Validation Status has one of three possible values:</p>
<p/>

<ul>
  <li>none: There was no Authenticated Received Chain on the message when it arrived for validation. Typically, this occurs when a message is received directly from a message&#8217;s original Message Transfer Agent (MTA) or Message Submission Agent (MSA), or from an upstream Internet Mail Handler that is not participating in ARC handling.</li>
  <li>fail: The message contains an Authenticated Received Chain whose validation failed.</li>
  <li>pass: The message contains an Authenticated Received Chain whose validation succeeded.</li>
</ul>
<h1 id="rfc.section.5"><a href="#rfc.section.5">5.</a> <a href="#protocol-actions" id="protocol-actions">Protocol Actions</a></h1>
<p id="rfc.section.5.p.1">ARC-enabled Internet Mail Handlers generally act as both ARC Validators (when receiving messages) and ARC Sealers (when sending messages onward, not originated locally).</p>
<p id="rfc.section.5.p.2">An Authenticated Received Chain with a Chain Validation Status of &#8220;pass&#8221; (or &#8220;none&#8221;) allows Internet Mail Handlers to ascertain:</p>
<p/>

<ul>
  <li>all ARC-participating ADMDs that claim responsibility for handling (and possibly modifying) the message in transit;</li>
  <li>the authentication assessments of the message as determined by each ADMD (from AAR header fields).</li>
</ul>
<p id="rfc.section.5.p.4">With this information, Internet Mail Handlers MAY inform local policy decisions regarding disposition of messages that experience authentication failure due to intermediate processing.</p>
<h1 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1.</a> <a href="#sealer-actions" id="sealer-actions">Sealer Actions</a></h1>
<p id="rfc.section.5.1.p.1">To &#8220;seal&#8221; a message, an ARC Sealer adds an ARC Set (the three ARC header fields AAR, AMS, and AS) to a message. All ARC header fields in an ARC Set share the same instance tag value.</p>
<p id="rfc.section.5.1.p.2">To perform Sealing (aka to build and attach a new ARC Set), the following actions must be taken by an ARC Sealer when presented with a message:</p>
<p/>

<ol>
  <li>All message modifications (including adding DKIM-Signature header field(s)) MUST be performed before Sealing.</li>
  <li>If the message already contains an Authenticated Received Chain with the most recent AS reporting &#8220;cv=fail&#8221;, then there is no need to proceed and the algorithm stops here.</li>
  <li>Calculate the instance value: if the message already contains an Authenticated Received Chain, the instance value is 1 more than the highest instance number found in the Authenticated Received Chain. If no Authenticated Received Chain exists, the instance value is 1.</li>
  <li>Using the calculated instance value, generate and attach a complete ARC set to the message as follows:  <ol><li>Generate and attach an ARC-Authentication-Results header field as defined in <a href="#aar-defn">Section 4.1.1</a>.</li><li>Generate and attach an ARC-Message-Signature header field as defined in <a href="#ams-defn">Section 4.1.2</a>.</li><li>Generate and attach an ARC-Seal header field using the AS definition found in <a href="#as-defn">Section 4.1.3</a>, the prescribed headers defined in <a href="#as-hdrs">Section 5.1.1</a>, and the Chain Validation Status as determined during ARC Validation.</li></ol></li>
</ol>
<h1 id="rfc.section.5.1.1"><a href="#rfc.section.5.1.1">5.1.1.</a> <a href="#as-hdrs" id="as-hdrs">Header Fields To Include In ARC-Seal Signatures</a></h1>
<p id="rfc.section.5.1.1.p.1">The ARC-Seal is generated in a manner similar to how DKIM-Signatures are added to messages (<a href="#RFC6376">[RFC6376]</a>, section 3.7), with explicit requirements on the header fields and ordering of those fields.</p>
<p id="rfc.section.5.1.1.p.2">The signature of an AS header field signs a canonicalized form of the ARC Set header field values. The ARC set header field values are supplied to the hash function in increasing instance order, starting at 1, and include the ARC Set being added at the time of Sealing the message.</p>
<p id="rfc.section.5.1.1.p.3">Within an ARC Set, header fields are supplied to the hash function in the following order:</p>
<p/>

<ol>
  <li>ARC-Authentication-Results</li>
  <li>ARC-Message-Signature</li>
  <li>ARC-Seal</li>
</ol>
<p id="rfc.section.5.1.1.p.5">Note that when an Authenticated Received Chain has failed validation, the signing scope for the ARC-Seal is modified as specified in <a href="#cv-fail-case">Section 5.1.2</a>.</p>
<h1 id="rfc.section.5.1.2"><a href="#rfc.section.5.1.2">5.1.2.</a> <a href="#cv-fail-case" id="cv-fail-case">Marking and Sealing &#8220;cv=fail&#8221; (Invalid) Chains</a></h1>
<p id="rfc.section.5.1.2.p.1">In the case of a failed Authenticated Received Chain, the header fields included in the signature scope of the AS header field b= value MUST only include the ARC Set header fields created by the MTA which detected the malformed chain, as if this newest ARC Set was the only set present.</p>
<p><em>INFORMATIONAL</em>: This approach is mandated to handle the case of a malformed or otherwise invalid Authenticated Received Chain. There is no way to generate a deterministic set of AS header fields (<a href="#as-hdrs">Section 5.1.1</a>) in most cases of invalid chains.</p>
<h1 id="rfc.section.5.1.3"><a href="#rfc.section.5.1.3">5.1.3.</a> <a href="#only-one-authenticated-received-chain-per-message" id="only-one-authenticated-received-chain-per-message">Only One Authenticated Received Chain Per Message</a></h1>
<p id="rfc.section.5.1.3.p.1">A message can have only one Authenticated Received Chain on it at a time. Once broken, the chain cannot be continued, as the chain of custody is no longer valid and responsibility for the message has been lost. For further discussion of this topic and the design restriction which prevents chain continuation or re-establishment, see <a href="#ARC-USAGE">[ARC-USAGE]</a>.</p>
<h1 id="rfc.section.5.1.4"><a href="#rfc.section.5.1.4">5.1.4.</a> <a href="#broad-ability-to-seal" id="broad-ability-to-seal">Broad Ability to Seal</a></h1>
<p id="rfc.section.5.1.4.p.1">ARC is not solely intended for perimeter MTAs. Any Internet Mail Handler MAY seal a message by adding a complete ARC set, whether or not they have modified or are aware of having modified the message. For additional information, see <a href="#trust-boundaries">Section 7.1</a>.</p>
<h1 id="rfc.section.5.1.5"><a href="#rfc.section.5.1.5">5.1.5.</a> <a href="#sealing-is-always-safe" id="sealing-is-always-safe">Sealing is Always Safe</a></h1>
<p id="rfc.section.5.1.5.p.1">The utility of an Authenticated Received Chain is limited to very specific cases.  Authenticated Received Chains are designed to provide additional information to an Internet Mail Handler when evaluating messages for delivery in the context of authentication failures. Specifically:</p>
<p/>

<ul>
  <li>Properly adding an ARC Set to a message does not damage or invalidate an existing Authenticated Received Chain.</li>
  <li>Sealing an Authenticated Received Chain when a message has not been modified does not negatively affect the chain.</li>
  <li>Validating a message exposes no new threat vectors (see <a href="#security-consider">Section 9</a>).</li>
  <li>An ADMD may choose to Seal all inbound messages whether or not a message has been modified or will be retransmitted.</li>
</ul>
<h1 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2.</a> <a href="#validate-actions" id="validate-actions">Validator Actions</a></h1>
<p id="rfc.section.5.2.p.1">A validator performs the following steps, in sequence, to process an Authenticated Received Chain. Canonicalization, hash functions, and signature validation methods are imported from <a href="#RFC6376">[RFC6376]</a> section 5.</p>
<p/>

<ol>
  <li>Collect all ARC Sets currently attached to the message.  <ul><li>If there are none, the Chain Validation Status is &#8220;none&#8221; and the algorithm stops here.</li><li>The maximum number of ARC Sets that can be attached to a message is 50. If more than the maximum number exist the Chain Validation Status is &#8220;fail&#8221; and the algorithm stops here.</li><li>In the following algorithm, the maximum discovered ARC instance value is referred to as &#8220;N&#8221;.</li></ul></li>
  <li>If the Chain Validation Status of the highest instance value ARC Set is &#8220;fail&#8221;, then the Chain Validation status is &#8220;fail&#8221; and the algorithm stops here.</li>
  <li>Validate the structure of the Authenticated Received Chain. A valid ARC has the following conditions:  <ol><li>Each ARC Set MUST contain exactly one each of the three ARC header fields (AAR, AMS, and AS).</li><li>The instance values of the ARC Sets MUST form a continuous sequence from 1..N with no gaps or repetition.</li><li>The &#8220;cv&#8221; value for all ARC-Seal header fields MUST NOT be &#8220;fail&#8221;. For ARC Sets with instance values &gt; 1, the values MUST be &#8220;pass&#8221;. For the ARC Set with instance value = 1, the value MUST be &#8220;none&#8221;.</li></ol><p> </p><ul><li>If any of these conditions are not met, the Chain Validation Status is &#8220;fail&#8221; and the algorithm stops here.</li></ul></li>
  <li>Validate the AMS with the greatest instance value (most recent). If validation fails, then the Chain Validation Status is &#8220;fail&#8221; and the algorithm stops here.</li>
  <li><em>OPTIONAL:</em> Determine the &#8220;oldest-pass&#8221; value from the ARC Set by validating each prior AMS beginning with the N-1 and proceeding in decreasing order to the AMS with the instance value of 1:  <ol><li>If an AMS fails to validate (for instance value &#8220;M&#8221;), then set the oldest-pass value to the lowest AMS instance value which passed (M+1) and go to the next step (there is no need to check any other (older) AMS header fields). This does not affect the validity of the Authenticated Received Chain.</li><li>If all AMS header fields verify, set the oldest-pass value to zero (0).</li></ol></li>
  <li>Validate each AS beginning with the greatest instance value and proceeding in decreasing order to the AS with the instance value of 1. If any AS fails to validate, the Chain Validation Status is &#8220;fail&#8221; and the algorithm stops here.</li>
  <li>If the algorithm reaches this step, then the Chain Validation Status is &#8220;pass&#8221;, and the algorithm is complete.</li>
</ol>
<p id="rfc.section.5.2.p.3">The end result of this Validation algorithm SHOULD be included within the Authentication-Results header field for the ADMD.</p>
<p id="rfc.section.5.2.p.4">As with a DKIM signature (<a href="#RFC6376">[RFC6376]</a> section 6.3) which fails verification, a message with an Authenticated Received Chain with a Chain Validation status of &#8220;fail&#8221; MUST be treated the same as a message with no Authenticated Received Chain.</p>
<p><em>INFORMATIONAL</em>: Recipients of an invalid or failing Authenticated Received Chain can use that information as part of a wider handling context. ARC adoption cannot be assumed by intermediaries; many intermediaries will continue to modify messages without adding ARC Seals.</p>
<h1 id="rfc.section.5.2.1"><a href="#rfc.section.5.2.1">5.2.1.</a> <a href="#all-failures-are-permanent" id="all-failures-are-permanent">All Failures Are Permanent</a></h1>
<p id="rfc.section.5.2.1.p.1">Authenticated Received Chains represent the traversal of messages through one or more intermediaries. All errors, including DNS failures, become unrecoverable and are considered permanent.</p>
<p id="rfc.section.5.2.1.p.2">Any error validating an Authenticated Received Chain results in a Chain Validation Status of &#8220;fail&#8221;. For further discussion of this topic and the design restriction which prevents chain continuation or re-establishment, see <a href="#ARC-USAGE">[ARC-USAGE]</a>.</p>
<h1 id="rfc.section.5.2.2"><a href="#rfc.section.5.2.2">5.2.2.</a> <a href="#responding-to-arc-validation-failures-during-the-smtp-transaction" id="responding-to-arc-validation-failures-during-the-smtp-transaction">Responding to ARC Validation Failures During the SMTP Transaction</a></h1>
<p id="rfc.section.5.2.2.p.1">If an ARC Validator determines that the incoming message fails authentication checks (potentially including ARC validation), the Validator MAY signal the breakage through the extended SMTP response code 5.7.29 &#8220;ARC validation failure&#8221; and corresponding SMTP basic response code. Validators MAY use the more general 5.7.28 &#8220;Multiple authentication checks failed&#8221; instead.</p>
<h1 id="rfc.section.6"><a href="#rfc.section.6">6.</a> <a href="#communication-of-validation-results" id="communication-of-validation-results">Communication of Validation Results</a></h1>
<p id="rfc.section.6.p.1">Chain Validation Status (described in <a href="#cv-defn">Section 4.4</a>) is communicated via Authentication-Results (and AAR) header fields using the auth method &#8220;arc&#8221;.  This auth method is described in <a href="#iana-auth">Section 10.1</a>.</p>
<p id="rfc.section.6.p.2">If necessary data is available, the ptypes and properties defined in <a href="#iana-ptypes">Section 10.2</a> SHOULD be recorded in an Authentication-Results header field:</p>
<p/>

<ul>
  <li>smtp.remote-ip - The address of the connection-initiating SMTP server, from which the message is being relayed.</li>
  <li>header.oldest-pass - The instance number of the oldest AMS that still validates, or 0 if all pass.</li>
</ul>
<h1 id="rfc.section.7"><a href="#rfc.section.7">7.</a> <a href="#use-cases" id="use-cases">Use Cases</a></h1>
<p id="rfc.section.7.p.1">This section explores several messaging handling use cases that are addressed by ARC.</p>
<h1 id="rfc.section.7.1"><a href="#rfc.section.7.1">7.1.</a> <a href="#trust-boundaries" id="trust-boundaries">Communicate Authentication Assessment Across Trust Boundaries</a></h1>
<p id="rfc.section.7.1.p.1">When an intermediary ADMD adds an ARC Set to a message&#8217;s Authenticated Received Chain (or creates the initial ARC Set), the ADMD communicates its authentication assessment to the next ARC-participating ADMD in the message handling path.</p>
<p id="rfc.section.7.1.p.2">If ARC-enabled ADMDs are trusted, Authenticated Received Chains can be used to bridge administrative boundaries.</p>
<h1 id="rfc.section.7.1.1"><a href="#rfc.section.7.1.1">7.1.1.</a> <a href="#message-scanning-services" id="message-scanning-services">Message Scanning Services</a></h1>
<p id="rfc.section.7.1.1.p.1">Message services are available to perform anti-spam, anti-malware, and anti-phishing scanning. Such services typically remove malicious content, replace HTTP links in messages with sanitized links, and/or attach footers to messages advertising the abilities of the message scanning service. These modifications almost always break signature-based authentication (such as DKIM).</p>
<p id="rfc.section.7.1.1.p.2">Scanning services typically require clients to point MX records of an Internet domain to the scanning service. Messages destined for the Internet domain are initially delivered to the scanning service. Once scanning is performed, messages are then routed to the client&#8217;s own mail handling infrastructure.  Re-routing messages in this way almost always breaks path-based authentication (such as SPF).</p>
<p id="rfc.section.7.1.1.p.3">Message scanning services can attach Authenticated Received Chains to messages to communicate authentication assessment into client ADMDs. Clients can then benefit from the message scanning service while processing messages as if the client&#8217;s infrastructure were the original destination of the Internet domain&#8217;s MX record.</p>
<h1 id="rfc.section.7.1.2"><a href="#rfc.section.7.1.2">7.1.2.</a> <a href="#multi-tier-mta-processing" id="multi-tier-mta-processing">Multi-tier MTA Processing</a></h1>
<p id="rfc.section.7.1.2.p.1">Large message processing infrastructure is often divided into several processing tiers that can break authentication information between tiers. For example, a large site may maintain a cluster of MTAs dedicated to connection handling and enforcement of IP-based reputation filtering. A secondary cluster of MTAs may be dedicated and optimized for content-based processing of messages.</p>
<p id="rfc.section.7.1.2.p.2">Authenticated Received Chains can be used to communicate authentication assessment between processing tiers.</p>
<h1 id="rfc.section.7.1.3"><a href="#rfc.section.7.1.3">7.1.3.</a> <a href="#mailing-lists" id="mailing-lists">Mailing Lists</a></h1>
<p id="rfc.section.7.1.3.p.1">Mailing lists take delivery of messages and re-post them to subscribers. A full description of authentication-related mailing list issues can be found in <a href="#RFC7960">[RFC7960]</a> Section 3.2.3.</p>
<p id="rfc.section.7.1.3.p.2">Mailing list services can implement ARC to convey the authentication assessment of posted messages sent to the list&#8217;s subscriber base. The ADMDs of the mailing list subscribers can then use the Authenticated Received Chain to determine the authentication assessment of the original message before mailing list handling.</p>
<h1 id="rfc.section.7.2"><a href="#rfc.section.7.2">7.2.</a> <a href="#inform-message-disposition-decisions" id="inform-message-disposition-decisions">Inform Message Disposition Decisions</a></h1>
<p id="rfc.section.7.2.p.1">Intermediaries often break authentication through content modification, interfere with path-based authentication (such as SPF), and strip authentication results (if an MTA removes Authentication-Results header fields).</p>
<p id="rfc.section.7.2.p.2">Authenticated Received Chains allow ARC Validators to:</p>
<p/>

<ol>
  <li>identify ARC-enabled ADMDs that break authentication while processing messages;</li>
  <li>gain extended visibility into the authentication-preserving abilities of ADMDs that relay messages into ARC-enabled ADMDs.</li>
</ol>
<p id="rfc.section.7.2.p.4">Through the collection of ARC-related data, an ADMD can identify handling paths that have broken authentication.</p>
<p id="rfc.section.7.2.p.5">An Authenticated Received Chain allows an Internet Mail Handler to potentially base decisions of message disposition on authentication assessments provided by different ADMDs.</p>
<h1 id="rfc.section.7.2.1"><a href="#rfc.section.7.2.1">7.2.1.</a> <a href="#dmarc-local-policy-overrides" id="dmarc-local-policy-overrides">DMARC Local Policy Overrides</a></h1>
<p id="rfc.section.7.2.1.p.1">DMARC introduces a policy model where Domain Owners can request email receivers to reject or quarantine messages that fail DMARC alignment. Interoperability issues between DMARC and indirect email flows are documented in <a href="#RFC7960">[RFC7960]</a>.</p>
<p id="rfc.section.7.2.1.p.2">Authenticated Received Chains allow DMARC processors to consider authentication assessments provided by other ADMDs. As a matter of local policy, a DMARC processor MAY choose to accept the authentication assessments provided by an Authenticated Received Chain when determining if a message is DMARC compliant.</p>
<p id="rfc.section.7.2.1.p.3">When an Authenticated Received Chain is used to determine message disposition, the DMARC processor can communicate this local policy decision to Domain Owners as described in <a href="#dmarc-rpt">Section 7.2.2</a>.</p>
<h1 id="rfc.section.7.2.2"><a href="#rfc.section.7.2.2">7.2.2.</a> <a href="#dmarc-rpt" id="dmarc-rpt">DMARC Reporting</a></h1>
<p id="rfc.section.7.2.2.p.1">DMARC-enabled receivers indicate when ARC Validation influences DMARC-related local policy decisions. When an ARC-enabled handler generates a DMARC report, it MAY indicate the influence of ARC on their local policy decision(s) by adding a reason of &#8220;local_policy&#8221; with a comment string (per <a href="#RFC7489">[RFC7489]</a> Appendix C) containing a list of data discovered during ARC Validation, which at a minimum includes:</p>
<p/>

<ul>
  <li>the Chain Validation Status,</li>
  <li>the domain and selector for each AS,</li>
  <li>the originating IP address from the first ARC Set:</li>
</ul>
<pre>
EXAMPLE:

&lt;policy_evaluated&gt;
  &lt;disposition&gt;none&lt;/disposition&gt;
  &lt;dkim&gt;fail&lt;/dkim&gt;
  &lt;spf&gt;fail&lt;/spf&gt;
  &lt;reason&gt;
   &lt;type&gt;local_policy&lt;/type&gt;
   &lt;comment&gt;arc=pass as[2].d=d2.example as[2].s=s2 
     as[1].d=d1.example as[1].s=s3 
     remote-ip[1]=10.10.10.13&lt;/comment&gt;
  &lt;/reason&gt;
&lt;/policy_evaluated&gt;
</pre>
<p id="rfc.section.7.2.2.p.3">In the above example DMARC XML reporting fragment, data relating to specific validated ARC Sets are enumerated using array syntax (eg, &#8220;as[2]&#8221; means AS header field with instance value of 2). d2.example is the Sealing domain for ARC Set #2 (i=2) and d1.example is the Sealing domain for ARC Set #1 (i=1).</p>
<p id="rfc.section.7.2.2.p.4">Depending on the reporting practices of intermediate message handlers, Domain Owners may receive multiple DMARC reports for a single message. Receivers of DMARC reports should be aware of this behaviour and make the necessary accommodations.</p>
<h1 id="rfc.section.8"><a href="#rfc.section.8">8.</a> <a href="#privacy-consider" id="privacy-consider">Privacy Considerations</a></h1>
<p id="rfc.section.8.p.1">The Authenticated Received Chain provides a verifiable record of the handlers for a message. This record may include Personally Identifiable Information such as IP address(es) and domain names. Such information is also included in existing non-ARC related header fields such as the &#8220;Received&#8221; header fields.</p>
<h1 id="rfc.section.9"><a href="#rfc.section.9">9.</a> <a href="#security-consider" id="security-consider">Security Considerations</a></h1>
<p id="rfc.section.9.p.1">The Security Considerations of <a href="#RFC6376">[RFC6376]</a> and <a href="#I-D-7601bis">[I-D-7601bis]</a> apply directly to this specification.</p>
<p id="rfc.section.9.p.2">As with other domain authentication technologies (such as SPF, DKIM, and DMARC), ARC makes no claims about the semantic content of messages.</p>
<h1 id="rfc.section.9.1"><a href="#rfc.section.9.1">9.1.</a> <a href="#big-hf-risk" id="big-hf-risk">Increased Header Field Size</a></h1>
<p id="rfc.section.9.1.p.1">Inclusion of Authenticated Received Chains into messages may cause issues for older or constrained MTAs due to increased total header field size. Large header field blocks, in general, may cause failures to deliver or other outage scenarios for such MTAs. ARC itself would not cause problems.</p>
<h1 id="rfc.section.9.2"><a href="#rfc.section.9.2">9.2.</a> <a href="#dns-impact" id="dns-impact">DNS Operations</a></h1>
<p id="rfc.section.9.2.p.1">The validation of an Authenticated Received Chain composed of N ARC Sets can require up to 2*N DNS queries (not including any DNS redirection mechanisms which can increase the total number of queries). This leads to two considerations:</p>
<p/>

<ol>
  <li>An attacker can send a message to an ARC participant with a concocted sequence of ARC Sets bearing the domains of intended victims, and all of them will be queried by the participant until a failure is discovered. DNS caching and the difficulty of forging the signature values should limit the extent of this load to domains under control of the attacker. Query traffic pattern analysis may expose information about downstream validating ADMD infrastructure.</li>
  <li>DKIM only performs one DNS query per signature, while ARC can introduce many (per chain). Absent caching, slow DNS responses can cause SMTP timeouts; and backlogged delivery queues on Validating systems. This could be exploited as a DoS attack.</li>
</ol>
<h1 id="rfc.section.9.3"><a href="#rfc.section.9.3">9.3.</a> <a href="#message-content-suspicion" id="message-content-suspicion">Message Content Suspicion</a></h1>
<p id="rfc.section.9.3.p.1">Recipients are cautioned to treat messages bearing Authenticated Received Chains with the same suspicion applied to all other messages. This includes appropriate content scanning and other checks for potentially malicious content.</p>
<p id="rfc.section.9.3.p.2">ARC authenticates the identity of some email handling actors.  It does not make any assessment of their trustworthiness.</p>
<p id="rfc.section.9.3.p.3">Just as passing message authentication is not an indication of message safety, forwarding that information through the mechanism of ARC is also not an indication of message safety.  Even if all ARC-enabled ADMDs are trusted, ADMDs may have become compromised, may miss unsafe content, or may not properly authenticate messages.</p>
<h1 id="rfc.section.9.4"><a href="#rfc.section.9.4">9.4.</a> <a href="#message-sealer-suspicion" id="message-sealer-suspicion">Message Sealer Suspicion</a></h1>
<p id="rfc.section.9.4.p.1">Recipients are cautioned to treat every Sealer of the ARC Chain with suspicion.  Just as with a validated DKIM signature, responsibility for message handling is attributed to the Sealing domain, but whether or not that Sealer is a malicious actor is out of scope of the authentication mechanism.  Since ARC aids message delivery in the event of an authentication failure, ARC Sealers should be treated with suspicion, so that a malicious actor cannot Seal spam or other fraudulent messages to aid their delivery, too.</p>
<h1 id="rfc.section.9.5"><a href="#rfc.section.9.5">9.5.</a> <a href="#replay-attacks" id="replay-attacks">Replay Attacks</a></h1>
<p id="rfc.section.9.5.p.1">Since ARC inherits heavily from DKIM, it has similar attack vectors. In particular, the Replay Attack described in <a href="#RFC6376">[RFC6376]</a> section 8.6 is potentially amplified by ARC&#8217;s chained statuses. In an ARC replay attack, a malicious actor would take an intact and passing ARC Chain, and then resend it to many recipients without making any modifications that invalidate the latest AMS or AS. The impact to a receiver would be more DNS lookups and signature evaluations. This scope of this attack can be limited by caching DNS queries and following the same signing scope guidance from <a href="#RFC6376">[RFC6376]</a> section 5.4.1.</p>
<h1 id="rfc.section.10"><a href="#rfc.section.10">10.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a></h1>
<p id="rfc.section.10.p.1">[[ <strong>Note to the RFC Editors:</strong> &#8220;dkim - header - s&#8221; is defined in <a href="#I-D-7601bis">[I-D-7601bis]</a>. Please adjust the list below as appropriate. ]]</p>
<p id="rfc.section.10.p.2">This draft introduces three new headers fields and updates the Email Authentication Parameters registry with one new authentication method and several status codes.</p>
<h1 id="rfc.section.10.1"><a href="#rfc.section.10.1">10.1.</a> <a href="#iana-auth" id="iana-auth">Email Authentication Results Names Registry Update</a></h1>
<p id="rfc.section.10.1.p.1">This draft adds one Auth Method with three Codes to the IANA &#8220;Email Authentication Result Names&#8221; registry:</p>
<p/>

<ul>
  <li>Auth Method : arc<br/> Code: &#8220;none&#8221;, &#8220;pass&#8221;, &#8220;fail&#8221;<br/> Specification: this document 2.2<br/> Status: active</li>
</ul>
<h1 id="rfc.section.10.2"><a href="#rfc.section.10.2">10.2.</a> <a href="#iana-ptypes" id="iana-ptypes">Email Authentication Methods Registry Update</a></h1>
<p id="rfc.section.10.2.p.1">This draft adds several new items to the Email Authentication Methods registry, most recently defined in <a href="#I-D-7601bis">[I-D-7601bis]</a>:</p>
<p/>

<ul>
  <li>Method: arc<br/> Definition: this document<br/> ptype: smtp<br/> Property: remote-ip<br/> Value: IP address of originating SMTP connection<br/> Status: active<br/> Version: 1</li>
  <li>Method: arc<br/> Definition: this document<br/> ptype: header<br/> Property: oldest-pass<br/> Value: The instance id of the oldest validating AMS, or 0 if they all pass (see <a href="#validate-actions">Section 5.2</a>)<br/> Status: active<br/> Version: 1</li>
  <li>Method: dkim<br/> Definition: <a href="#I-D-7601bis">[I-D-7601bis]</a><br/> ptype: header<br/> Property: s<br/> Value: value of signature &#8220;s&#8221; tag<br/> Status: active<br/> Version: 1</li>
</ul>
<h1 id="rfc.section.10.3"><a href="#rfc.section.10.3">10.3.</a> <a href="#iana-headers" id="iana-headers">Definitions of the ARC header fields</a></h1>
<p id="rfc.section.10.3.p.1">This specification adds three new header fields to the &#8220;Permanent Message Header Field Registry&#8221;, as follows:</p>
<p/>

<ul>
  <li>Header field name: ARC-Seal<br/> Applicable protocol: mail<br/> Status: draft<br/> Author/Change controller: IETF<br/> Specification document(s): this document<br/> Related information: <a href="#RFC6376">[RFC6376]</a></li>
  <li>Header field name: ARC-Message-Signature<br/> Applicable protocol: mail<br/> Status: draft<br/> Author/Change controller: IETF<br/> Specification document(s): this document<br/> Related information: <a href="#RFC6376">[RFC6376]</a></li>
  <li>Header field name: ARC-Authentication-Results<br/> Applicable protocol: mail<br/> Status: standard<br/> Author/Change controller: IETF<br/> Specification document(s): this document<br/> Related information: <a href="#I-D-7601bis">[I-D-7601bis]</a></li>
</ul>
<h1 id="rfc.section.10.4"><a href="#rfc.section.10.4">10.4.</a> <a href="#new-enhanced-status-code-arc-validation" id="new-enhanced-status-code-arc-validation">New Enhanced Status Code - ARC Validation</a></h1>
<p id="rfc.section.10.4.p.1">The following value should be added to the <a href="#ENHANCED-STATUS">[ENHANCED-STATUS]</a> registry, as follows:</p>
<p/>

<ul>
  <li>Code: X.7.29<br/> Sample Text: ARC validation failure<br/> Associated basic status code: 550<br/> Description: This status code may be returned when a message fails multiple authentication checks, including ARC validation<br/> Reference: this document<br/> Submitter: K. Andersen<br/> Change controller: IESG</li>
</ul>
<h1 id="rfc.section.11"><a href="#rfc.section.11">11.</a> <a href="#exp-consider" id="exp-consider">Experimental Considerations</a></h1>
<p id="rfc.section.11.p.1">The ARC protocol is designed to address common interoperability issues introduced by intermediate message handlers. Interoperability issues are described in <a href="#RFC6377">[RFC6377]</a> and <a href="#RFC7960">[RFC7960]</a>.</p>
<p id="rfc.section.11.p.2">As the ARC protocol is implemented by Internet Mail Handlers over time, the following should be evaluated in order to determine the success of the protocol in accomplishing the intended benefits.</p>
<h1 id="rfc.section.11.1"><a href="#rfc.section.11.1">11.1.</a> <a href="#success-consideration" id="success-consideration">Success Consideration</a></h1>
<p id="rfc.section.11.1.p.1">In an attempt to deliver legitimate messages that users desire, many receivers use heuristic-based methods to identify messages that arrive via indirect delivery paths.</p>
<p id="rfc.section.11.1.p.2">ARC will be a success if the presence of Authenticated Received Chains allows for improved decision making when processing legitimate messages, specifically resulting in equal or better delivery rates than achieve through the use of heuristic approaches.</p>
<h1 id="rfc.section.11.2"><a href="#rfc.section.11.2">11.2.</a> <a href="#failure-considerations" id="failure-considerations">Failure Considerations</a></h1>
<p id="rfc.section.11.2.p.1">ARC should function without introducing significant new vectors for abuse (see <a href="#security-consider">Section 9</a>). If unforeseen vectors are enabled by ARC, then this protocol will be a failure. Note that weaknesses inherent in the mail protocols ARC is built upon (such as DKIM replay attacks and other known issues) are not new vectors which can be attributed to this specification.</p>
<h1 id="rfc.section.11.3"><a href="#rfc.section.11.3">11.3.</a> <a href="#open-questions" id="open-questions">Open Questions</a></h1>
<p id="rfc.section.11.3.p.1">The following open questions are academic and have no clear answer at the time of the development of the protocol. However, additional deployments should be able to gather the necessary data to answer some or all of them.</p>
<h1 id="rfc.section.11.3.1"><a href="#rfc.section.11.3.1">11.3.1.</a> <a href="#value-of-the-arc-seal-as-header-field" id="value-of-the-arc-seal-as-header-field">Value of the ARC-Seal (AS) Header Field</a></h1>
<p id="rfc.section.11.3.1.p.1">Data should be collected to show if the ARC-Seal (AS) provides value beyond the ARC Message Signature (AMS) for either making delivery decisions or catching malicious actors trying to craft or replay malicious chains.</p>
<h1 id="rfc.section.11.3.2"><a href="#rfc.section.11.3.2">11.3.2.</a> <a href="#usage-andor-signals-from-multiple-selectors-andor-domains-in-arc-sets" id="usage-andor-signals-from-multiple-selectors-andor-domains-in-arc-sets">Usage and/or signals from multiple selectors and/or domains in ARC sets</a></h1>
<p id="rfc.section.11.3.2.p.1">Any selectors and/or (sub)domains (under the control of the sealing ADMD) may be used for ARC header field signatures.</p>
<p id="rfc.section.11.3.2.p.2">While implementers may choose to use various selectors and/or domains for ARC set header fields, no compelling argument for or against such usage has been made within the working group. As such we have chosen to allow maximum freedom for the experimental definition of this protocol.</p>
<p id="rfc.section.11.3.2.p.3">Wider deployment experience and higher volumes of traffic may show whether this is useful.</p>
<h1 id="rfc.section.11.3.3"><a href="#rfc.section.11.3.3">11.3.3.</a> <a href="#dns-overhead" id="dns-overhead">DNS Overhead</a></h1>
<p id="rfc.section.11.3.3.p.1">Longer Authenticated Received Chains will require more queries to retrieve the keys for validating the chain. While this is not believed to be a security issue (see <a href="#dns-impact">Section 9.2</a>), it is unclear how much overhead will truly be added.  This is similar to some of the initial processing and query load concerns which were debated at the time of the DKIM specification development.</p>
<p id="rfc.section.11.3.3.p.2">Data should be collected to better understand usable length and distribution of lengths found in valid Authenticated Received Chains along with the DNS impact of processing Authenticated Received Chains.</p>
<p id="rfc.section.11.3.3.p.3">An effective operational maximum will have to be developed through deployment experience in the field.</p>
<h1 id="rfc.section.11.3.4"><a href="#rfc.section.11.3.4">11.3.4.</a> <a href="#what-trace-information-is-valuable" id="what-trace-information-is-valuable">What Trace Information is Valuable</a></h1>
<p id="rfc.section.11.3.4.p.1">There are several edge cases where the information in the AAR can make the difference between message delivery or rejection. For example, if there is a well known mailing list that seals with ARC but doesn&#8217;t do its own initial DMARC enforcement, an Internet Mail Handler with this knowledge could make a delivery decision based upon the authentication information it sees in the corresponding AAR header field.</p>
<p id="rfc.section.11.3.4.p.2">Certain trace information in the AAR is useful/necessary in the construction of DMARC reports.</p>
<p id="rfc.section.11.3.4.p.3">Further, certain receivers believe the entire set of trace information would be valuable to feed into machine learning systems to identify fraud and/or provide other signals related to message delivery.</p>
<p id="rfc.section.11.3.4.p.4">At this point, however, it is unclear what trace information will be valuable for all receivers, regardless of size.</p>
<p id="rfc.section.11.3.4.p.5">Data should be collected on what trace information receivers are using that provides useful signals that affect deliverability, and what portions of the trace data are left untouched or provide no useful information.</p>
<p id="rfc.section.11.3.4.p.6">Since many such systems are intentionally proprietary or confidential to prevent gaming by abusers, it may not be viable to reliably answer this particular question. The evolving nature of attacks can also shift the landscape of &#8220;useful&#8221; information over time.</p>
<h1 id="rfc.section.12"><a href="#rfc.section.12">12.</a> <a href="#implstat" id="implstat">Implementation Status</a></h1>
<p id="rfc.section.12.p.1">[[ Note to the RFC Editor: Please remove this section before publication along with the reference to <a href="#RFC7942">[RFC7942]</a>. ]]</p>
<p id="rfc.section.12.p.2">This section records the status of known implementations of the protocol defined by this specification at the time of posting of this Internet-Draft, and is based on a proposal described in <a href="#RFC7942">[RFC7942]</a>.  The description of implementations in this section is intended to assist the IETF in its decision processes in progressing drafts to RFCs.  Please note that the listing of any individual implementation here does not imply endorsement by the IETF.  Furthermore, no effort has been spent to verify the information presented here that was supplied by IETF contributors.  This is not intended as, and must not be construed to be, a catalog of available implementations or their features.  Readers are advised to note that other implementations may exist.</p>
<p id="rfc.section.12.p.3">This information is known to be correct as of the eighth interoperability test event which was held on 2018-03-17 at IETF101.</p>
<p id="rfc.section.12.p.4">For a few of the implementations, later status information was available as of August 2018.</p>
<h1 id="rfc.section.12.1"><a href="#rfc.section.12.1">12.1.</a> <a href="#gmail-test-reflector-and-incoming-validation" id="gmail-test-reflector-and-incoming-validation">GMail test reflector and incoming validation</a></h1>
<p id="rfc.section.12.1.p.1">Organization: Google<br/> Description: Internal production implementation with both debug analysis and validating + sealing pass-through function<br/> Status of Operation: Production - Incoming Validation<br/> Coverage: Full spec implemented as of <a href="#ARC-DRAFT-14">[ARC-DRAFT-14]</a><br/> Licensing: Proprietary - Internal only<br/> Implementation Notes:</p>
<p/>

<ul>
  <li>Full functionality was demonstrated during the interop testing on 2018-03-17.</li>
</ul>
<p id="rfc.section.12.1.p.3">Contact Info: <a href="mailto:arc-discuss@dmarc.org">arc-discuss@dmarc.org</a></p>
<h1 id="rfc.section.12.2"><a href="#rfc.section.12.2">12.2.</a> <a href="#aol-test-reflector-and-internal-tagging" id="aol-test-reflector-and-internal-tagging">AOL test reflector and internal tagging</a></h1>
<p id="rfc.section.12.2.p.1">Organization: AOL<br/> Description: Internal prototype implementation with both debug analysis and validating + sealing pass-through function<br/> Status of Operation: Beta<br/> Coverage: ARC Chain validity status checking is operational, but only applied to email addresses enrolled in the test program.  This system conforms to <a href="#ARC-DRAFT-05">[ARC-DRAFT-05]</a><br/> Licensing: Proprietary - Internal only<br/> Implementation Notes:</p>
<p/>

<ul>
  <li>2017-07-15: Full functionality verified during the interop testing.</li>
  <li>2018-06: Partially retired but still accessible by special request due to the in process evolution of the AOL mail infrastructure to the integrated OATH environment. The implementation was based on the Apache James DKIM code base and may be contributed back to that project in the future.</li>
</ul>
<p id="rfc.section.12.2.p.3">Contact Info: <a href="mailto:arc-discuss@dmarc.org">arc-discuss@dmarc.org</a></p>
<h1 id="rfc.section.12.3"><a href="#rfc.section.12.3">12.3.</a> <a href="#dkimpy" id="dkimpy">dkimpy</a></h1>
<p id="rfc.section.12.3.p.1">Organization: dkimpy developers/Scott Kitterman<br/> Description: Python DKIM package<br/> Status of Operation: Production<br/> Coverage:</p>
<p/>

<ul>
  <li>2017-07-15: The internal test suite is incomplete, but the command line developmental version of validator was demonstrated to interoperate with the Google and AOL implementations during the interop on 2017-07-15 and the released version passes the tests in <a href="#ARC-TEST">[ARC-TEST]</a> <a href="https://github.com/Valimail/arc_test_suite">arc_test_suite</a> with both python and python3.</li>
</ul>
<p id="rfc.section.12.3.p.3">Licensing: Open/Other (same as dkimpy package = BCD version 2)<br/> Contact Info: https://launchpad.net/dkimpy</p>
<h1 id="rfc.section.12.4"><a href="#rfc.section.12.4">12.4.</a> <a href="#openarc" id="openarc">OpenARC</a></h1>
<p id="rfc.section.12.4.p.1">Organization: TDP/Murray Kucherawy<br/> Description: Implementation of milter functionality related to the OpenDKIM and OpenDMARC packages<br/> Status of Operation: Beta<br/> Coverage: Built to support <a href="#ARC-DRAFT-14">[ARC-DRAFT-14]</a><br/> Licensing: Open/Other (same as OpenDKIM and OpenDMARC packages)<br/> Implementation Notes:</p>
<p/>

<ul>
  <li>Known issues have been resolved with release X</li>
</ul>
<p id="rfc.section.12.4.p.3">Contact Info: <a href="mailto:arc-discuss@dmarc.org">arc-discuss@dmarc.org</a>, <a href="mailto:openarc-users@openarc.org">openarc-users@openarc.org</a></p>
<h1 id="rfc.section.12.5"><a href="#rfc.section.12.5">12.5.</a> <a href="#mailman-3x-patch" id="mailman-3x-patch">Mailman 3.x patch</a></h1>
<p id="rfc.section.12.5.p.1">Organization: Mailman development team<br/> Description: Integrated ARC capabilities within the Mailman 3.2 package<br/> Status of Operation: Patch submitted<br/> Coverage: Based on OpenARC<br/> Licensing: Same as mailman package - GPL<br/> Implementation Notes:</p>
<p/>

<ul>
  <li>Appears to work properly in at least one beta deployment, but waiting on acceptance of the pull request into the mainline of mailman development</li>
</ul>
<p id="rfc.section.12.5.p.3">Contact Info: https://www.gnu.org/software/mailman/contact.html</p>
<h1 id="rfc.section.12.6"><a href="#rfc.section.12.6">12.6.</a> <a href="#copernicamailerq-web-based-validation" id="copernicamailerq-web-based-validation">Copernica/MailerQ web-based validation</a></h1>
<p id="rfc.section.12.6.p.1">Organization: Copernica<br/> Description: Web-based validation of ARC-signed messages<br/> Status of Operation: Beta<br/> Coverage: Built to support <a href="#ARC-DRAFT-05">[ARC-DRAFT-05]</a><br/> Licensing: On-line usage only<br/> Implementation Notes:</p>
<p/>

<ul>
  <li>Released 2016-10-24</li>
  <li>Requires full message content to be pasted into a web form found at http://arc.mailerq.com/ (warning - https is not supported).</li>
  <li>An additional instance of an ARC signature can be added if one is willing to paste a private key into an unsecured web form.</li>
  <li>2017-07-15: Testing shows that results match the other implementations listed in this section.</li>
</ul>
<p id="rfc.section.12.6.p.3">Contact Info: https://www.copernica.com/</p>
<h1 id="rfc.section.12.7"><a href="#rfc.section.12.7">12.7.</a> <a href="#rspamd" id="rspamd">Rspamd</a></h1>
<p id="rfc.section.12.7.p.1">Organization: Rspamd community<br/> Description: ARC signing and verification module<br/> Status of Operation: Production, though deployment usage is unknown<br/> Coverage: Built to support <a href="#ARC-DRAFT-14">[ARC-DRAFT-14]</a><br/> Licensing: Open source<br/> Implementation Notes:</p>
<p/>

<ul>
  <li>2017-06-12: Released with version 1.6.0</li>
  <li>2017-07-15: Testing during the interop showed that the validation functionality interoperated with the Google, AOL, dkimpy and MailerQ implementations</li>
</ul>
<p id="rfc.section.12.7.p.3">Contact Info: https://rspamd.com/doc/modules/arc.html and https://github.com/vstakhov/rspamd</p>
<h1 id="rfc.section.12.8"><a href="#rfc.section.12.8">12.8.</a> <a href="#perl-maildkim-module" id="perl-maildkim-module">PERL MAIL::DKIM module</a></h1>
<p id="rfc.section.12.8.p.1">Organization: FastMail<br/> Description: Email domain authentication (sign and/or verify) module, previously included SPF / DKIM / DMARC, now has ARC added<br/> Status of Operation: Production, deployment usage unknown<br/> Coverage: Built to support <a href="#ARC-DRAFT-10">[ARC-DRAFT-10]</a><br/> Licensing: Open Source<br/> Implementation Notes:</p>
<p/>

<ul>
  <li>2017-12-15: v0.50 released with full test set passing for ARC</li>
</ul>
<p id="rfc.section.12.8.p.3">Contact Info: http://search.cpan.org/~mbradshaw/Mail-DKIM-0.50/</p>
<h1 id="rfc.section.12.9"><a href="#rfc.section.12.9">12.9.</a> <a href="#perl-mailmilterauthentication-module" id="perl-mailmilterauthentication-module">PERL Mail::Milter::Authentication module</a></h1>
<p id="rfc.section.12.9.p.1">Organization: FastMail<br/> Description: Email domain authentication milter, uses MAIL::DKIM (see above)<br/> Status of Operation: Initial validation completed during IETF99 hackathon with some follow-on work during the week<br/> Coverage: Built to support <a href="#ARC-DRAFT-14">[ARC-DRAFT-14]</a><br/> Licensing: Open Source<br/> Implementation Notes:</p>
<p/>

<ul>
  <li>2017-07-15: Validation functionality which interoperates with Gmail, AOL, dkimpy was demonstrated; later in the week of IETF99, the signing functionality was reported to be working</li>
  <li>2017-07-20: ARC functionality has not yet been pushed back to the github repo but should be showing up soon</li>
</ul>
<p id="rfc.section.12.9.p.3">Contact Info: https://github.com/fastmail/authentication_milter</p>
<h1 id="rfc.section.12.10"><a href="#rfc.section.12.10">12.10.</a> <a href="#sympa-list-manager" id="sympa-list-manager">Sympa List Manager</a></h1>
<p id="rfc.section.12.10.p.1">Organization: Sympa Dev Community<br/> Description: Work in progress<br/> Status of Operation: Work in progress<br/> Coverage: unknown<br/> Licensing: open source<br/> Implementation Notes:</p>
<p/>

<ul>
  <li>2018-01-05: Tracked as https://github.com/sympa-community/sympa/issues/153</li>
</ul>
<p id="rfc.section.12.10.p.3">Contact Info: https://github.com/sympa-community</p>
<h1 id="rfc.section.12.11"><a href="#rfc.section.12.11">12.11.</a> <a href="#oracle-messaging-server" id="oracle-messaging-server">Oracle Messaging Server</a></h1>
<p id="rfc.section.12.11.p.1">Organization: Oracle<br/> Description:<br/> Status of Operation: Initial development work during IETF99 hackathon. Framework code is complete, crypto functionality requires integration with libsodium<br/> Coverage: Work in progress<br/> Licensing: Unknown<br/> Implementation Notes:</p>
<p/>

<ul>
  <li>2018-03: Protocol handling components are completed, but crypto is not yet functional.</li>
</ul>
<p id="rfc.section.12.11.p.3">Contact Info: Chris Newman, Oracle</p>
<h1 id="rfc.section.12.12"><a href="#rfc.section.12.12">12.12.</a> <a href="#messagesystems-momentum-and-powermta-platforms" id="messagesystems-momentum-and-powermta-platforms">MessageSystems Momentum and PowerMTA platforms</a></h1>
<p id="rfc.section.12.12.p.1">Organization: MessageSystems/SparkPost<br/> Description: OpenARC integration into the LUA-enabled Momentum processing space<br/> Status of Operation: Beta<br/> Coverage: Same as OpenARC<br/> Licensing: Unknown<br/> Implementation Notes:</p>
<p/>

<ul>
  <li>Initial deployments for validation expected in mid-2018.</li>
</ul>
<p id="rfc.section.12.12.p.3">Contact Info: TBD </p>
<h1 id="rfc.section.12.13"><a href="#rfc.section.12.13">12.13.</a> <a href="#exim" id="exim">Exim</a></h1>
<p id="rfc.section.12.13.p.1">Organization: Exim developers<br/> Status of Operation: Operational; requires specific enabling for compile.<br/> Coverage: Full spec implemented as of <a href="#ARC-DRAFT-13">[ARC-DRAFT-13]</a><br/> Licensing: GPL<br/> Contact Info: exim-users@exim.org<br/> Implementation notes:</p>
<p/>

<ul>
  <li>Implemented as of Exim 4.91</li>
</ul>
<h1 id="rfc.section.12.14"><a href="#rfc.section.12.14">12.14.</a> <a href="#halon-mta" id="halon-mta">Halon MTA</a></h1>
<p id="rfc.section.12.14.p.1">Organization: Halon<br/> Status of Operation: Operational as of May 2018<br/> Coverage: Full spec implemented as of <a href="#ARC-DRAFT-14">[ARC-DRAFT-14]</a><br/> Licensing: Commercial, trial version available for download<br/> Contact Info: https://halon.io<br/> Implementation notes:</p>
<p/>

<ul>
  <li>GPL&#8217;d library with ARC capabilities: https://github.com/halon/libdkimpp</li>
</ul>
<h1 id="rfc.section.12.15"><a href="#rfc.section.12.15">12.15.</a> <a href="#iij" id="iij">IIJ</a></h1>
<p id="rfc.section.12.15.p.1">Organization: Internet Initiative Japan (IIJ) Status of Operation: Operational as of October 2018<br/> Coverage: Full spec implemented as of this document<br/> Licensing: Internal<br/> Contact Info: https://www.iij.ad.jp/en/<br/> Implementation notes:</p>
<p/>

<ul>
  <li>Internal MTA implementation validated during the ARC interop exercise in mid-October 2018</li>
</ul>
<h1 id="rfc.references"><a href="#rfc.references">13.</a> References</h1>
<h1 id="rfc.references.1"><a href="#rfc.references.1">13.1.</a> Normative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="draft-levine-eaiauth">[draft-levine-eaiauth]</b>
      </td>
      <td class="top"><a>Levine, J.</a>, "<a href="https://tools.ietf.org/html/draft-levine-appsarea-eaiauth-03">E-mail Authentication for Internationalized Mail</a>", August 2018.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="I-D-7601bis">[I-D-7601bis]</b>
      </td>
      <td class="top"><a>Kucherawy, M.</a>, "<a href="https://datatracker.ietf.org/doc/draft-ietf-dmarc-rfc7601bis/">Message Header Field for Indicating Message Authentication Status</a>", February 2018.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC2119">[RFC2119]</b>
      </td>
      <td class="top"><a>Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5234">[RFC5234]</b>
      </td>
      <td class="top"><a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, DOI 10.17487/RFC5234, January 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5322">[RFC5322]</b>
      </td>
      <td class="top"><a>Resnick, P.</a>, "<a href="http://tools.ietf.org/html/rfc5322">Internet Message Format</a>", RFC 5322, DOI 10.17487/RFC5322, October 2008.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC5598">[RFC5598]</b>
      </td>
      <td class="top"><a>Crocker, D.</a>, "<a href="http://tools.ietf.org/html/rfc5598">Internet Mail Architecture</a>", RFC 5598, DOI 10.17487/RFC5598, July 2009.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6376">[RFC6376]</b>
      </td>
      <td class="top"><a>Crocker, D.</a>, <a>Hansen, T.</a> and <a>M. Kucherawy</a>, "<a href="http://tools.ietf.org/html/rfc6376">DomainKeys Identified Mail (DKIM) Signatures</a>", STD 76, RFC 6376, DOI 10.17487/RFC6376, September 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6377">[RFC6377]</b>
      </td>
      <td class="top"><a>Kucherawy, M.</a>, "<a href="http://tools.ietf.org/html/rfc6377">DomainKeys Identified Mail (DKIM) and Mailing Lists</a>", BCP 167, RFC 6377, DOI 10.17487/RFC6377, September 2011.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC6532">[RFC6532]</b>
      </td>
      <td class="top"><a>Yang, A.</a>, <a>Steele, S.</a> and <a>N. Freed</a>, "<a href="http://tools.ietf.org/html/rfc6532">Internationalized Email Headers</a>", RFC 6532, DOI 10.17487/RFC6532, February 2012.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7208">[RFC7208]</b>
      </td>
      <td class="top"><a>Kitterman, S.</a>, "<a href="http://tools.ietf.org/html/rfc7208">Sender Policy Framework (SPF) for Authorizing Use of Domains in Email, Version 1</a>", RFC 7208, DOI 10.17487/RFC7208, April 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7405">[RFC7405]</b>
      </td>
      <td class="top"><a>Kyzivat, P.</a>, "<a href="http://tools.ietf.org/html/rfc7405">Case-Sensitive String Support in ABNF</a>", RFC 7405, DOI 10.17487/RFC7405, December 2014.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC8174">[RFC8174]</b>
      </td>
      <td class="top"><a>Leiba, B.</a>, "<a href="http://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.references.2"><a href="#rfc.references.2">13.2.</a> Informative References</h1>
<table>
  <tbody>
    <tr>
      <td class="reference">
        <b id="ARC-DRAFT-05">[ARC-DRAFT-05]</b>
      </td>
      <td class="top"><a>Andersen, K.</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dmarc-arc-protocol-05">Authenticated Received Chain (ARC) Protocol (I-D-05)</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="ARC-DRAFT-10">[ARC-DRAFT-10]</b>
      </td>
      <td class="top"><a>Andersen, K.</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dmarc-arc-protocol-10">Authenticated Received Chain (ARC) Protocol (I-D-10)</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="ARC-DRAFT-13">[ARC-DRAFT-13]</b>
      </td>
      <td class="top"><a>Andersen, K.</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dmarc-arc-protocol-13">Authenticated Received Chain (ARC) Protocol (I-D-13)</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="ARC-DRAFT-14">[ARC-DRAFT-14]</b>
      </td>
      <td class="top"><a>Andersen, K.</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dmarc-arc-protocol-14">Authenticated Received Chain (ARC) Protocol (I-D-14)</a>", n.d..</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="ARC-MULTI">[ARC-MULTI]</b>
      </td>
      <td class="top"><a>Andersen, K.</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dmarc-arc-multi-02">Using Multiple Signing Algorithms with ARC</a>", June 2018.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="ARC-TEST">[ARC-TEST]</b>
      </td>
      <td class="top"><a>Blank, S.</a>, "<a href="https://github.com/Valimail/arc_test_suite">ARC Test Suite</a>", January 2017.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="ARC-USAGE">[ARC-USAGE]</b>
      </td>
      <td class="top"><a>Jones, S.</a>, <a>Adams, T.</a>, <a>Rae-Grant, J.</a> and <a>K. Andersen</a>, "<a href="https://tools.ietf.org/html/draft-ietf-dmarc-arc-usage-05">Recommended Usage of the ARC Headers</a>", April 2018.</td>
    </tr>
    <tr><td class="reference"><b id="ENHANCED-STATUS">[ENHANCED-STATUS]</b></td><td class="top"><a href="http://www.iana.org/assignments/smtp-enhanced-status-codes/smtp-enhanced-status-codes.xhtml">IANA SMTP Enhanced Status Codes</a>", n.d..</td>, "</tr>
    <tr>
      <td class="reference">
        <b id="RFC7489">[RFC7489]</b>
      </td>
      <td class="top"><a>Kucherawy, M.</a> and <a>E. Zwicky</a>, "<a href="http://tools.ietf.org/html/rfc7489">Domain-based Message Authentication, Reporting, and Conformance (DMARC)</a>", RFC 7489, DOI 10.17487/RFC7489, March 2015.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7942">[RFC7942]</b>
      </td>
      <td class="top"><a>Sheffer, Y.</a> and <a>A. Farrel</a>, "<a href="http://tools.ietf.org/html/rfc7942">Improving Awareness of Running Code: The Implementation Status Section</a>", BCP 205, RFC 7942, DOI 10.17487/RFC7942, July 2016.</td>
    </tr>
    <tr>
      <td class="reference">
        <b id="RFC7960">[RFC7960]</b>
      </td>
      <td class="top"><a>Martin, F.</a>, <a>Lear, E.</a>, <a>Draegen. Ed., T.</a>, <a>Zwicky, E.</a> and <a>K. Andersen</a>, <a href="http://tools.ietf.org/html/rfc7960">Interoperability Issues between Domain-based Message Authentication, Reporting, and Conformance (DMARC) and Indirect Email Flows</a>", RFC 7960, DOI 10.17487/RFC7960, September 2016.</td>
    </tr>
  </tbody>
</table>
<h1 id="rfc.appendix.A"><a href="#rfc.appendix.A">Appendix A.</a> <a href="#appendix-a-design-requirements" id="appendix-a-design-requirements">Appendix A - Design Requirements</a></h1>
<p id="rfc.section.A.p.1">The specification of the ARC framework is driven by the following high-level goals, security considerations, and practical operational requirements.</p>
<h1 id="rfc.appendix.A.1"><a href="#rfc.appendix.A.1">A.1.</a> <a href="#primary-design-criteria" id="primary-design-criteria">Primary Design Criteria</a></h1>
<p/>

<ul>
  <li>Provide a verifiable &#8220;chain of custody&#8221; for email messages;</li>
  <li>Not require changes for originators of email;</li>
  <li>Support the verification of the ARC header field set by each hop in the handling chain;</li>
  <li>Work at Internet scale; and</li>
  <li>Provide a trustable mechanism for the communication of Authentication-Results across trust boundaries.</li>
</ul>
<h1 id="rfc.appendix.A.2"><a href="#rfc.appendix.A.2">A.2.</a> <a href="#out-of-scope" id="out-of-scope">Out of Scope</a></h1>
<p id="rfc.section.A.2.p.1">ARC is not a trust framework. Users of the ARC header fields are cautioned against making unsubstantiated conclusions when encountering a &#8220;broken&#8221; ARC sequence.</p>
<h1 id="rfc.appendix.B"><a href="#rfc.appendix.B">Appendix B.</a> <a href="#appendix-b-example-usage" id="appendix-b-example-usage">Appendix B - Example Usage</a></h1>
<p id="rfc.section.B.p.1">The following message is an example of one which has passed through several intermediary handlers, some of which have modified the message and others which have not:</p>
<pre>
Return-Path: &lt;jqd@d1.example&gt;
Received: from example.org (example.org [208.69.40.157])
    by gmail.example with ESMTP id d200mr22663000ykb.93.1421363207
    for &lt;fmartin@example.com&gt;; Thu, 14 Jan 2015 15:02:40 -0800 (PST)
Received: from segv.d1.example (segv.d1.example [72.52.75.15])
    by lists.example.org (8.14.5/8.14.5) with ESMTP id t0EKaNU9010123
    for &lt;arc@example.org&gt;; Thu, 14 Jan 2015 15:01:30 -0800 (PST)
    (envelope-from jqd@d1.example)
Received: from [10.10.10.131] (w-x-y-z.dsl.static.isp.com [w.x.y.z])
    (authenticated bits=0)
    by segv.d1.example with ESMTP id t0FN4a8O084569;
    Thu, 14 Jan 2015 15:00:01 -0800 (PST)
    (envelope-from jqd@d1.example)
Received: from mail-ob0-f188.google.example (mail-ob0-f188.google.example
    [208.69.40.157]) by clochette.example.org with ESMTP id
    d200mr22663000ykb.93.1421363268
    for &lt;fmartin@example.org&gt;; Thu, 14 Jan 2015 15:03:15 -0800 (PST)
ARC-Seal: i=3; a=rsa-sha256; cv=pass; d=clochette.example.org; s=
        clochette; t=12345; b=CU87XzXlNlk5X/yW4l73UvPUcP9ivwYWxyBWcVrRs7
        +HPx3K05nJhny2fvymbReAmOA9GTH/y+k9kEc59hAKVg==
ARC-Message-Signature: i=3; a=rsa-sha256; c=relaxed/relaxed; d=
        clochette.example.org; h=message-id:date:from:to:subject; s=
        clochette; t=12345; bh=KWSe46TZKCcDbH4klJPo+tjk5LWJnVRlP5pvjXFZY
        LQ=; b=o71vwyLsK+Wm4cOSlirXoRwzEvi0vqIjd/2/GkYFYlSd/GGfKzkAgPqxf
        K7ccBMP7Zjb/mpeggswHjEMS8x5NQ==
ARC-Authentication-Results: i=3; clochette.example.org; spf=fail
    smtp.from=jqd@d1.example; dkim=fail (512-bit key)
    header.i=@d1.example; dmarc=fail; arc=pass (as.2.gmail.example=pass,
    ams.2.gmail.example=pass, as.1.lists.example.org=pass,
    ams.1.lists.example.org=fail (message has been altered))
Authentication-Results: clochette.example.org; spf=fail
    smtp.from=jqd@d1.example; dkim=fail (512-bit key)
    header.i=@d1.example; dmarc=fail; arc=pass (as.2.gmail.example=pass, 
    ams.2.gmail.example=pass, as.1.lists.example.org=pass, 
    ams.1.lists.example.org=fail (message has been altered))
ARC-Seal: i=2; a=rsa-sha256; cv=pass; d=gmail.example; s=20120806; t=
        12345; b=Zpukh/kJL4Q7Kv391FKwTepgS56dgHIcdhhJZjsalhqkFIQQAJ4T9BE
        8jjLXWpRNuh81yqnT1/jHn086RwezGw==
ARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=
        gmail.example; h=message-id:date:from:to:subject; s=20120806; t=
        12345; bh=KWSe46TZKCcDbH4klJPo+tjk5LWJnVRlP5pvjXFZYLQ=; b=CVoG44
        cVZvoSs2mMig2wwqPaJ4OZS5XGMCegWqQs1wvRZJS894tJM0xO1RJLgCPsBOxdA5
        9WSqI9s9DfyKDfWg==
ARC-Authentication-Results: i=2; gmail.example; spf=fail
    smtp.from=jqd@d1.example; dkim=fail (512-bit key)
    header.i=@example.org; dmarc=fail; arc=pass (as.1.lists.example.org=pass, 
    ams.1.lists.example.org=pass)
ARC-Seal: i=1; a=rsa-sha256; cv=none; d=lists.example.org; s=dk-lists;
         t=12345; b=TlCCKzgk3TrAa+G77gYYO8Fxk4q/Ml0biqduZJeOYh6+0zhwQ8u/
        lHxLi21pxu347isLSuNtvIagIvAQna9a5A==
ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=
        lists.example.org; h=message-id:date:from:to:subject; s=
        dk-lists; t=12345; bh=KWSe46TZKCcDbH4klJPo+tjk5LWJnVRlP5pvjXFZYL
        Q=; b=DsoD3n3hiwlrN1ma8IZQFgZx8EDO7Wah3hUjIEsYKuShRKYB4LwGUiKD5Y
        yHgcIwGHhSc/4+ewYqHMWDnuFxiQ==
ARC-Authentication-Results: i=1; lists.example.org; spf=pass smtp.mfrom=jqd@d1.example;
    dkim=pass (512-bit key) header.i=@d1.example;
    dmarc=pass
DKIM-Signature: v=1; a=rsa-sha1; c=relaxed/relaxed; d=d1.example; h=
        message-id:date:from:to:subject; s=origin2015; bh=bIxxaeIQvmOBdT
        AitYfSNFgzPP4=; b=qKjd5fYibKXWWIcMKCgRYuo1vJ2fD+IAQPjX+uamXIGY2Q
        0HjQ+Lq3/yHzG3JHJp6780/nKQPOWt2UDJQrJkEA==
Message-ID: &lt;54B84785.1060301@d1.example&gt;
Date: Thu, 14 Jan 2015 15:00:01 -0800
From: John Q Doe &lt;jqd@d1.example&gt;
To: arc@dmarc.example
Subject: [List 2] Example 1

Hey gang,
This is a test message.
--J.
</pre>
<h1 id="rfc.appendix.C"><a href="#rfc.appendix.C">Appendix C.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a></h1>
<p id="rfc.section.C.p.1">This draft originated with the work of OAR-Dev Group.</p>
<p id="rfc.section.C.p.2">The authors thank all of the OAR-Dev and the subsequent DMARC-WG group for the ongoing help and though-provoking discussions from all the participants, especially: Alex Brotman, Brandon Long, Dave Crocker, Elizabeth Zwicky, Franck Martin, Greg Colburn, J. Trent Adams, John Rae-Grant, Mike Hammer, Mike Jones, Steve Jones, Terry Zink, Tim Draegen, Gene Shuman, Scott Kitterman, Bron Gondwana.</p>
<p id="rfc.section.C.p.3">Grateful appreciation is extended to the people who provided feedback through the discuss mailing list.</p>
<h1 id="rfc.appendix.D"><a href="#rfc.appendix.D">Appendix D.</a> <a href="#comments-and-feedback" id="comments-and-feedback">Comments and Feedback</a></h1>
<p id="rfc.section.D.p.1">Please address all comments, discussions, and questions to <a href="mailto:dmarc@ietf.org">dmarc@ietf.org</a>.  Earlier discussions can be found at <a href="mailto:arc-discuss@dmarc.org">arc-discuss@dmarc.org</a>.  Interop discussions planning can be found at <a href="mailto:arc-interop@dmarc.org">arc-interop@dmarc.org</a>.</p>
<p id="rfc.section.D.p.2">Some introductory material for less technical people can be found at <a href="https://arc-spec.org">https://arc-spec.org</a>.</p>
<h1 id="rfc.authors">
  <a href="#rfc.authors">Authors' Addresses</a>
</h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Kurt Andersen</span> 
	  <span class="n hidden">
		<span class="family-name">Andersen</span>
	  </span>
	</span>
	<span class="org vcardline">LinkedIn</span>
	<span class="adr">
	  <span class="vcardline">1000 West Maude Ave</span>

	  <span class="vcardline">
		<span class="locality">Sunnyvale</span>,  
		<span class="region">California</span> 
		<span class="code">94085</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:kurta@linkedin.com">kurta@linkedin.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Brandon Long</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Long</span>
	  </span>
	</span>
	<span class="org vcardline">Google</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:blong@google.com">blong@google.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Seth Blank</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Blank</span>
	  </span>
	</span>
	<span class="org vcardline">Valimail</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:seth@valimail.com">seth@valimail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Murray Kucherawy</span> (editor)
	  <span class="n hidden">
		<span class="family-name">Kucherawy</span>
	  </span>
	</span>
	<span class="org vcardline">TDP</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:superuser@gmail.com">superuser@gmail.com</a></span>

  </address>
</div>

</body>
</html>
